<!doctype html><html><head lang=en><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>åœ¨ Ubuntu22.04 ä¸Šæ­å»º Discourse è®ºå› - Falasool</title><link rel=icon type=image/png href=static/img/favicon.png><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta property="og:image" content><meta property="og:title" content="åœ¨ Ubuntu22.04 ä¸Šæ­å»º Discourse è®ºå›"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="https://falasool.github.io/posts/build-discourse-site-on-ubuntu22/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-07-22T21:28:27+08:00"><meta property="article:modified_time" content="2023-07-22T21:28:27+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="åœ¨ Ubuntu22.04 ä¸Šæ­å»º Discourse è®ºå›"><meta name=twitter:description content><script src=https://falasool.github.io/js/feather.min.js></script>
<link href=https://falasool.github.io/css/fonts.4bacf4386d3f58fdc378d205a903311c80158bf414d25698589b658e0273156d.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://falasool.github.io/css/main.409b4163748cd4906669e4c6d5a0483433fd78fba4753a71f4d1748dbc962736.css><link id=darkModeStyle rel=stylesheet type=text/css href=https://falasool.github.io/css/dark.726cd11ca6eb7c4f7d48eb420354f814e5c1b94281aaf8fd0511c1319f7f78a4.css media="(prefers-color-scheme: dark)"></head><body><div class=content><header><div class=main><a href=https://falasool.github.io/>Falasool</a></div><nav><a href=/friends/></a>
<a href=/about>About</a>
<a href=/friends>Friends</a>
<a href=/tags>Tags</a></nav></header><main><article><div class=title><h1 class=title>åœ¨ Ubuntu22.04 ä¸Šæ­å»º Discourse è®ºå›</h1><div class=meta>Posted on Jul 22, 2023</div></div><section class=body><p>ä¹°æœåŠ¡å™¨ï¼Œç³»ç»Ÿä¸º Ubuntu 22.04 - x86_64</p><p>ä¹°åŸŸåï¼Œæ‰˜ç®¡åˆ° CloudFlareï¼ˆå¼€DNS onlyï¼‰ï¼ŒæŒ‡å‘æœåŠ¡å™¨IP</p><p>æ’æ’­ï¼šFlarumè®ºå›ä¹Ÿå¥½çœ‹ï¼Œè¿˜è½»é‡</p><h2 id=chore>Chore</h2><p>SSHç»ˆç«¯é¢œè‰²</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># è¿›å…¥ /etc/profile æ–‡ä»¶</span>
</span></span><span style=display:flex><span>vim /etc/profile
</span></span><span style=display:flex><span><span style=color:#75715e># å¢åŠ è¿™ä¸€è¡Œ</span>
</span></span><span style=display:flex><span>PS1<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;[\[\e[32m\]\u\[\e[0m\]\[\e[35m\]@\[\e[0m\]\[\e[33m\]\h\[\e[0m\]\[\e[36m\] \W\[\e[0m\]]\$ &#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># æ›´æ–°æ–‡ä»¶</span>
</span></span><span style=display:flex><span>source /etc/profile
</span></span></code></pre></div><p>å®‰è£…å¸¸ç”¨å·¥å…·</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>apt-get install curl wget screen tree git htop bash-completion fail2ban ufw -y
</span></span></code></pre></div><p>å¼€æ”¾ç«¯å£</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>ufw allow OpenSSH
</span></span><span style=display:flex><span>ufw enable
</span></span><span style=display:flex><span>ufw allow http
</span></span><span style=display:flex><span>ufw allow https
</span></span><span style=display:flex><span>ufw allow 80/tcp
</span></span><span style=display:flex><span>ufw allow 443/tcp
</span></span><span style=display:flex><span>ufw status
</span></span></code></pre></div><p>æ£€æŸ¥ 80 ç«¯å£æœ‰æ— è¢«å ç”¨</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>netstat -tuln | grep 80# è¿”å›ä¸ºç©ºè¯´æ˜æ²¡æœ‰
</span></span><span style=display:flex><span>service nginx stop <span style=color:#75715e># nginxå äº†ï¼Œåœæ­¢nginx</span>
</span></span></code></pre></div><p>SMTP é…ç½®</p><p>åˆšå¼€å§‹ç”¨çš„ Mailjetï¼Œä»€ä¹ˆéƒ½é…ç½®å¥½äº†ï¼ŒæœåŠ¡å·²ç»è·‘èµ·æ¥äº†ï¼Œå‘ä¸äº†é‚®ä»¶å¯¼è‡´è¿ç®¡ç†å‘˜ä¹Ÿæ³¨å†Œä¸äº† ğŸ˜… åŸæ¥æ˜¯è¦å‘å·¥å•äººå·¥å®¡æ ¸ï¼Œè¿˜è¢«æ‹’äº†ã€‚è½¬Mailgun</p><p>[æµ‹è¯•SMTPé…ç½®]</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>./launcher enter app
</span></span><span style=display:flex><span>x86_64 arch detected.
</span></span><span style=display:flex><span>rake emails:test<span style=color:#f92672>[</span>your-email@gmail.com<span style=color:#f92672>]</span>
</span></span></code></pre></div><h2 id=æœ¬ä½“>æœ¬ä½“</h2><p>Docker</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>curl -fsSL https://get.docker.com -o get-docker.sh
</span></span><span style=display:flex><span>sh get-docker.sh
</span></span></code></pre></div><p>Discourse</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>git clone https://github.com/discourse/discourse_docker.git /var/discourse
</span></span><span style=display:flex><span>cd /var/discourse
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>700</span> containers
</span></span><span style=display:flex><span><span style=color:#75715e># å¯åŠ¨å®¹å™¨</span>
</span></span><span style=display:flex><span>./discourse-setup
</span></span></code></pre></div><p>#æŠ¥é”™ï¼šè¾“å…¥ <code>Hostname for your Discourse? [discourse.example.com]:</code> åï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>Checking your domain name . . .
</span></span><span style=display:flex><span>WARNING: Port <span style=color:#ae81ff>443</span> of computer does not appear to be accessible using hostname:  xxx.com.
</span></span><span style=display:flex><span>WARNING: Connection to http://xxx.com <span style=color:#f92672>(</span>port 80<span style=color:#f92672>)</span> also fails.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>This suggests that xxx.com resolves to some IP address that does not reach this
</span></span><span style=display:flex><span>machine where you are installing discourse.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>The first thing to <span style=color:#66d9ef>do</span> is confirm that xxx.com resolves to the IP address of this server.
</span></span><span style=display:flex><span>You usually <span style=color:#66d9ef>do</span> this at the same place you purchased the domain.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>If you are sure that the IP address resolves correctly, it could be a firewall issue.
</span></span><span style=display:flex><span>A web search <span style=color:#66d9ef>for</span> <span style=color:#e6db74>&#34;open ports YOUR CLOUD SERVICE&#34;</span> might help.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>This tool is designed only <span style=color:#66d9ef>for</span> the most standard installations. If you cannot resolve
</span></span><span style=display:flex><span>the issue above, you will need to edit containers/app.yml yourself and <span style=color:#66d9ef>then</span> type
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>./launcher rebuild app
</span></span></code></pre></div><p>è§£å†³ï¼šcloudflareé‡Œå¼€å¯ DNS only</p><p>æˆåŠŸå¯åŠ¨å®¹å™¨åè®¿é—®åŸŸåï¼Œæ³¨å†Œç®¡ç†å‘˜è´¦æˆ· ğŸ‰</p><h2 id=å‚è€ƒ--è‡´è°¢>å‚è€ƒ & è‡´è°¢</h2><p><a href=https://www.orgleaf.com/3098.html>è®©Discourseå’Œå…¶å®ƒç½‘ç«™è·‘åœ¨åŒä¸€å°ä¸»æœºä¸Š</a></p><p>å®‰è£…ä¾èµ–ï¼šphp_serializeã€miroã€mysql2</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>apt-get install build-essential ruby-dev libmysqlclient-dev
</span></span><span style=display:flex><span>apt-get install rubygems
</span></span><span style=display:flex><span>gem install php_serialize
</span></span><span style=display:flex><span>gem install miro
</span></span><span style=display:flex><span>gem install mysql2
</span></span></code></pre></div></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=/tags/tutorial>tutorial</a></li><li><a href=/tags/discourse>Discourse</a></li></ul></nav></div></article></main><footer><div style=display:flex><a class=soc href=https://github.com/falasool/ rel=me title=GitHub><i data-feather=github></i></a><a class=soc href=https://gitlab.com/athul/ rel=me title=GitLab><i data-feather=gitlab></i></a></div><div class=footer-info>2025 Â© Falaool<br>Built with <a href=https://gohugo.io>Hugo</a> & Theme <a href=https://github.com/athul/archie>Archie</a> design by Athul</div></footer><script>feather.replace()</script></div></body></html>
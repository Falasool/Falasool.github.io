<!doctype html><html><head lang=en><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>无障碍化 Accessibility - Falasool</title><link rel=icon type=image/png href=static/img/favicon.png><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="什么是 Accessibility？ 以任何方式访问网络的用户（移动端、电视、手表&mldr;），无论听觉、视觉、身体和认知能力如何（视障、"><meta property="og:image" content><meta property="og:title" content="无障碍化 Accessibility"><meta property="og:description" content="什么是 Accessibility？ 以任何方式访问网络的用户（移动端、电视、手表&mldr;），无论听觉、视觉、身体和认知能力如何（视障、"><meta property="og:type" content="article"><meta property="og:url" content="https://falasool.github.io/posts/a11y/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-21T20:28:27+08:00"><meta property="article:modified_time" content="2024-03-21T20:28:27+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="无障碍化 Accessibility"><meta name=twitter:description content="什么是 Accessibility？ 以任何方式访问网络的用户（移动端、电视、手表&mldr;），无论听觉、视觉、身体和认知能力如何（视障、"><script src=https://falasool.github.io/js/feather.min.js></script>
<link href=https://falasool.github.io/css/fonts.4bacf4386d3f58fdc378d205a903311c80158bf414d25698589b658e0273156d.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://falasool.github.io/css/main.42ea0af34aee3ba499cf9fa3204f9c629e4d0c0434c099da10346cf97e22e0c6.css><link id=darkModeStyle rel=stylesheet type=text/css href=https://falasool.github.io/css/dark.726cd11ca6eb7c4f7d48eb420354f814e5c1b94281aaf8fd0511c1319f7f78a4.css media="(prefers-color-scheme: dark)"></head><body><div class=content><header><div class=main><a href=https://falasool.github.io/>Falasool</a></div><nav><a href=/friends/></a>
<a href=/about>About</a>
<a href=/friends>Friends</a>
<a href=/tags>Tags</a></nav></header><main><article><div class=title><h1 class=title>无障碍化 Accessibility</h1><div class=meta>Posted on Mar 21, 2024</div></div><section class=body><p>什么是 Accessibility？</p><ul><li>以任何方式访问网络的用户（移动端、电视、手表&mldr;），无论听觉、视觉、身体和认知能力如何（视障、听障、运动功能障碍&mldr;），应用程序都是可以理解和使用的</li><li>网站不应该造成伤害（诱发光敏性癫痫等）</li></ul><p>可以从什么方面作出努力？</p><h2 id=html>HTML</h2><p>语义化结构</p><ol><li><code>&lt;button> vs &lt;div></code></li></ol><p>提供了默认样式、提供了键盘的无障碍（tab 键更换按钮、enter 键点击按钮）</p><ol start=2><li><code>&lt;h1> &lt;h2> &lt;p> vs &lt;font> &lt;br> &lt;hr> &lt;i></code></li></ol><p>便于屏幕阅读器识别标题和段落结构 🆚 没有任何可定位的标记的一大坨</p><ol start=3><li>替代文本</li></ol><ul><li><p><code>alt=""</code> 属性，包含对图像的描述，向无法看到/听到某些内容的用户传达其含义和内容。如果 alt 为空，表示该图像只用于装饰（或 <code>role =“presentation”</code> 阻止辅助设备读出替代文本）</p></li><li><p><code>title</code> 属性，屏幕阅读器也会读出 title 的内容</p></li><li><p><code>&lt;track></code> 元素向视频/音频添加文本轨道</p></li></ul><ol start=4><li>提供元素之间的联系和上下文，例如 <code>&lt;label for="">&lt;input></code></li></ol><h3 id=wai-aria-属性>WAI-ARIA 属性</h3><p>当原生 HTML 元素无法满足需求时，考虑 ARIA（Accessible Rich Internet Applications）属性，帮助解读网页结构和交互方式</p><ul><li>aria-hidden：表示是否对辅助技术隐藏该元素</li><li>role：制定元素的角色</li><li>aria-labelledby：父节点设置，会链接到对应 id 的元素，方便把分散在多个 DOM，逻辑上属于一个整体的内容打包阅读</li></ul><h2 id=css>CSS</h2><p>要确保无 css 的情况下，内容可读，顺序有意义</p><h3 id=颜色及对比度>颜色及对比度</h3><p>WebAIM 的 <a href=https://webaim.org/resources/contrastchecker/>Color Contrast Checker</a> 之类的工具来检查方案是否有足够对比度</p><h3 id=隐藏的内容>隐藏的内容</h3><p><code>position: absolute</code> 好于 <code>visibility: hidden; display: none;</code> ，前者不阻止屏幕阅读器读取被隐藏的内容</p><h2 id=javascript>JavaScript</h2><p>结构交给 HTML，尽量不使用 JS 配合 <code>&lt;div></code> 伪造功能（unobtrusive 原则）</p><h3 id=焦点管理>焦点管理</h3><p>相比较<code>&lt;button>&lt;a></code> 这样自带语义的元素，<code>&lt;div></code> 不能用<code>.foucs()</code> ，需要配合<code>tabindex="-1"</code> 属性，和<code>.pop:focus-visible {outline: 0}</code></p><ol><li>场景是现在很常见的单页面里，进行路由切换/ajax 更改内容时，进行焦点重置，让辅助阅读设备重头开始读，方便视障人士</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>&lt;nav&gt;
</span></span><span style=display:flex><span>  &lt;a href=&#34;/&#34;&gt;Home&lt;/a&gt;
</span></span><span style=display:flex><span>  &lt;a href=&#34;/goods&#34;&gt;goods&lt;/a&gt;
</span></span><span style=display:flex><span>  &lt;a href=&#34;/user&#34;&gt;user&lt;/a&gt;
</span></span><span style=display:flex><span>&lt;/nav&gt;
</span></span><span style=display:flex><span>&lt;main&gt;
</span></span><span style=display:flex><span><span style=color:#a6e22e>+   // tabindex=&#34;-1&#34;，元素可聚焦，不可通过键盘导航访问
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+	&lt;h2 tabindex=&#34;-1&#34;&gt;商城&lt;/h2&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>    &lt;Link /&gt;
</span></span><span style=display:flex><span>&lt;/main&gt;
</span></span><span style=display:flex><span><span style=color:#a6e22e>+ &lt;script&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    function routerChange() {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        const heading = document.querySelector(&#39;h2&#39;)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        heading.focus()
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        document.title = heading.textContent
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   }
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ &lt;/script&gt;
</span></span></span></code></pre></div><ol start=2><li>Dialog 配合 A11y</li></ol><p>需求：弹窗打开时聚焦于弹窗上，限制对页面其他元素的访问，退出弹窗时焦点退回到之前的位置</p><p>给弹窗增加 aria 属性</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>section</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;alert-dialog&#34;</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>role</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dialog&#34;</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>aria-modal</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;true&#34;</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>aria-label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;home-dialog&#34;</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>tanindex</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;-1&#34;</span>
</span></span><span style=display:flex><span>  &gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>h2</span>&gt;TITLE&lt;/<span style=color:#f92672>h2</span>&gt;
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>button</span>&gt;&lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>section</span>&gt;
</span></span></code></pre></div><p>转移焦点</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>showSelfAlert</span>() {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 获取目标元素
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>mask</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#39;.mask&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 显示弹窗
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>mask</span>.<span style=color:#a6e22e>style</span>.<span style=color:#a6e22e>display</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;block&#39;</span>; 
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 等待DOM更新，在下一个事件循环时
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>setTimeout</span>(<span style=color:#66d9ef>function</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 设置焦点到遮罩层或弹窗的元素上
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>dialog</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;aria-mask-dialog&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>dialog</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>dialog</span>.<span style=color:#a6e22e>focus</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }, <span style=color:#ae81ff>0</span>); 
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>section</span> <span style=color:#a6e22e>aria</span><span style=color:#f92672>-</span><span style=color:#a6e22e>live</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;polite&#34;</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#960050;background-color:#1e0010>/section&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// aria-live 默认属性为off，
</span></span></span><span style=display:flex><span><span style=color:#75715e>// polite 在系统空闲时朗读
</span></span></span><span style=display:flex><span><span style=color:#75715e>// assertive 立刻阅读
</span></span></span></code></pre></div><p>限制焦点</p><ul><li>使用 event capturing 监听 focus 事件，处理阶段：捕获-目标-冒泡</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>document.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;focus&#39;</span>, <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>event</span>){
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>dialog</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;dialog&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>dialogOpen</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>dialog</span>.<span style=color:#a6e22e>contains</span>(<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>target</span>)){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>stopPropagation</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>dialog</span>.<span style=color:#a6e22e>focus</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><p>打开弹窗前记录最后一个焦点元素，结束后把焦点挂回去</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// 获取当前聚焦的元素
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>lastFouceElement</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>activeElement</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>// close dialog
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>lastFouceElement</span>.<span style=color:#a6e22e>focus</span>()
</span></span></code></pre></div><h2 id=参考致谢>参考&致谢</h2><p><a href=https://developer.mozilla.org/zh-CN/docs/Learn/Accessibility>https://developer.mozilla.org/zh-CN/docs/Learn/Accessibility</a></p><p><a href=https://juejin.cn/post/7133617403748941861>Web如何适配无障碍？</a></p></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=/tags/a11y>A11y</a></li></ul></nav></div></article></main><footer><div style=display:flex><a class=soc href=https://github.com/falasool/ rel=me title=GitHub><i data-feather=github></i></a></div><div class=footer-info>2024 © Falaool | Built with <a href=https://gohugo.io>Hugo</a> & Theme <a href=https://github.com/athul/archie>Archie</a> design by Athul</div></footer><script>feather.replace()</script></div></body></html>
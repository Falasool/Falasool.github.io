<!doctype html><html lang dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><title>Misskey</title><link rel=canonical href=https://anodicseal.xyz/2022/11/19/misskey/><link rel=stylesheet href=/scss/style.min.18145888f21de6cb02d8cb0891be8240096206785da14eda35f6c23c239b966a.css><meta property="og:title" content="Misskey"><meta property="og:description" content><meta property="og:url" content="https://anodicseal.xyz/2022/11/19/misskey/"><meta property="og:site_name" content="Rubber Duck's Bizarre Adventure"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="tutorial"><meta property="article:tag" content="miskey"><meta property="article:published_time" content="2022-11-19T20:19:15+08:00"><meta property="article:modified_time" content="2022-11-19T20:19:15+08:00"><meta property="og:image" content="https://picsum.photos/800/600.webp?random=6ec56286"><meta name=twitter:title content="Misskey"><meta name=twitter:description content><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://picsum.photos/800/600.webp?random=6ec56286"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_huda2458f72ce188392d75c5d51cd8e24e_373_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>ğŸ¦·</span></figure><div class=site-meta><h1 class=site-name><a href=/>Rubber Duck's Bizarre Adventure</a></h1><h2 class=site-description>äººé–“è®ƒæ­Œã¯ã€Œå‹‡æ°—ã€ã®è®ƒæ­Œãƒƒï¼ï¼äººé–“ã®ã™ã°ã‚‰ã—ã•ã¯å‹‡æ°—ã®ã™ã°ã‚‰ã—ã•ï¼ï¼</h2></div></header><ol class=social-menu><li><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/2019/02/28/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About</span></a></li><li><a href=/2019/05/28/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/1/01/01/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/1/01/01/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><div class=menu-bottom-section><li id=i18n-switch><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><select name=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://anodicseal.xyz/ selected>English</option><option value=https://anodicseal.xyz/zh-cn/>ä¸­æ–‡</option></select></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/2022/11/19/misskey/><img src="https://picsum.photos/800/600.webp?random=6ec56286" loading=lazy alt="Featured image of post Misskey"></a></div><div class=article-details><header class=article-category><a href=/categories/tutorials/>Tutorials</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/2022/11/19/misskey/>Misskey</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Nov 19, 2022</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>10 minute read</time></div></footer></div></header><section class=article-content><p>ä¸åºŸè¯äº†ï¼Œç›´æ¥å†™æ­¥éª¤</p><h2 id=è´­ä¹°-vps>è´­ä¹° VPS</h2><p>âš ï¸ä¸è¦ä¹°æœºæˆ¿åœ¨å¤§é™†çš„æœåŠ¡å•† VPS âš ï¸</p><p>åœ¨å¤‡æ¡ˆé€šè¿‡ä¹‹å‰ 80 å’Œ 443 ç«¯å£æ˜¯å°ç¦çš„ -> æ— æ³•ç”³è¯· SSL è¯ä¹¦ -> Misskey éœ€è¦ SSL æ‰èƒ½è®¿é—®ï¼ŒGG</p><p>å³ä½¿æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œä¹°å¤§é™†èŠ‚ç‚¹çš„æœåŠ¡å»ºç«™ä¹Ÿæ˜¯ä¸€ç§è‡ªæ€è¡Œä¸º</p><p>æ³¨å†Œ Vultr è´¦å·ï¼Œå……å€¼</p><h3 id=åˆ›å»º-vps>åˆ›å»º VPS</h3><p>æœºæˆ¿ä½ç½®é€‰æ‹©æ—¥æœ¬ã€æ–°åŠ å¡ã€ç¾è¥¿éƒ½è¡Œï¼Œä¸€èˆ¬ä¸æ¨èæ¬§æ´²ï¼ˆå¯¹äºä¸­å›½å›½å†…ï¼‰</p><p>é€‰æ‹©æ“ä½œç³»ç»Ÿï¼šUbuntu 22.10 x64</p><p>é€‰æ‹© Sizeï¼š$5 çš„ 1C1G1TB å¥—é¤ï¼ˆè®°å¾—å‹¾é€‰ No Thanksï¼‰</p><p>å…³é—­è‡ªåŠ¨å¤‡ä»½ï¼Œçœ $1</p><p>Additional Featuresï¼šå‹¾é€‰ Enable IPv6</p><p>è¿™æ—¶åº•éƒ¨ä»˜æ¬¾æ åº”è¯¥æ˜¾ç¤º <code>$5.00/month</code> ï¼Œç‚¹å‡» <code>Deploy Now</code> ç¡®è®¤åˆ›å»ºæœåŠ¡å™¨ï¼Œç­‰å¾…ä¸€ä¼šï¼Œç­‰ Status å˜æˆ Running å°±å¥½äº†</p><p>ç‚¹å‡»åˆšåˆšåˆ›å»ºçš„ VPSï¼Œçœ‹åˆ°å¦‚ä¸‹ç•Œé¢ã€‚</p><p>å·¦ä¸‹è§’çš„ IP Addressã€Usernameã€Password æ˜¯å¾…ä¼šè¿æ¥æœåŠ¡å™¨çš„æ—¶å€™ï¼Œè¦ç”¨åˆ°çš„ SSH è¿æ¥ä¿¡æ¯</p><ol><li>ç™»å½• VNCï¼šæŸ¥çœ‹æ§åˆ¶å°ï¼Œç±»ä¼¼ Xshell ä½†æ˜¯åŠŸèƒ½æ²¡é‚£ä¹ˆä¸°å¯Œ</li><li>å…³æœºï¼šå°±å’Œå…³ç”µè„‘ä¸€æ ·ï¼ˆå…³æœºçš„æ—¶å€™ä»ç„¶åœ¨è®¡è´¹å“¦ï¼ï¼‰</li><li>é‡å¯ï¼šå°±å’Œé‡å¯ç”µè„‘ä¸€æ ·</li><li>é‡è£…ç³»ç»Ÿï¼šæŠŠæœåŠ¡å™¨é‡ç½®æˆåˆšåˆ›å»ºæ—¶çš„çŠ¶æ€</li><li>é”€æ¯/åˆ é™¤ï¼šé”€æ¯äº†æœåŠ¡å™¨å°±ä¸è®¡è´¹äº†ï¼Œæ•°æ®ä¸¢å¤±ï¼Œæ— æ³•æ‰¾å›</li></ol><p>Snapshotsï¼šå¿«ç…§ï¼ŒæŒ‡å°†å½“å‰ VPS çš„çŠ¶æ€ä¿å­˜ä¸‹æ¥ï¼Œå¯¹ VPS è¿›è¡Œå®Œæ•´å¤‡ä»½</p><p>æœåŠ¡å™¨åˆ›å»ºå®Œæˆ</p><h3 id=æ£€æŸ¥-ip>æ£€æŸ¥ IP</h3><p>Ping ä¸€ä¸‹ IP</p><p>ç”¨æ£€æŸ¥å·¥å…·æ¯”å¦‚ <a class=link href=https://ip112.cn/ target=_blank rel=noopener>https://ip112.cn/</a> æ£€æŸ¥ IPï¼Œæ­¤ IP å¯ç”¨</p><h2 id=åŸŸå>åŸŸå</h2><p>åœ¨åŸŸåå•† <a class=link href=https://www.dynadot.com/zh/ target=_blank rel=noopener>Dynadot</a> æ³¨å†Œè´¦å·ï¼Œä¹°ä¸€ä¸ªåŸŸå</p><h3 id=è§£æåŸŸå>è§£æåŸŸå</h3><p>ä¾æ¬¡ç‚¹å‡»</p><p>æš‚åœâ¸ï¸</p><p>å» <a class=link href=https://dash.cloudflare.com/ target=_blank rel=noopener>CloudFlare</a> æ³¨å†Œç™»å½•è´¦å·ï¼Œä¾æ¬¡æ“ä½œï¼š</p><p>æ·»åŠ æ–°ç«™ç‚¹</p><p>è¾“å…¥ä½ çš„åŸŸå</p><p>é€‰æ‹©å…è´¹æ–¹æ¡ˆ</p><p>æ·»åŠ  DNS è§£æè®°å½•</p><p>å¤åˆ¶ CloudFlare æä¾›çš„ä¸¤ä¸ªåç§°æœåŠ¡å™¨ï¼Œå¡«è¿› Dynadot çš„ DNS è®¾ç½®ï¼Œä¿å­˜</p><p>å›åˆ° CloudFlare ç‚¹å‡» <code>Done, check nameservers</code>ï¼Œç­‰ä¸€ä¼š</p><p>æµ‹è¯•ï¼Œping ä½ çš„åŸŸåï¼Œè¿”å›æœåŠ¡å™¨ IP è¯´æ˜è§£æç”Ÿæ•ˆ</p><p>âœ…åŸŸåè§£æå®Œæˆ</p><h2 id=é…ç½®-vps>é…ç½® VPS</h2><p><strong>å¯¹å“ªä¸€æ­¥ä¸è‡ªä¿¡ï¼Œå¯ä»¥åœ¨å¼€å§‹åšä¹‹å‰å…ˆå»æœåŠ¡å™¨ç®¡ç†é¢æ¿åˆ›å»ºä¸€ä¸ªå¿«ç…§ï¼ˆsnapshotsï¼‰ï¼Œå¿«ç…§å°±æ˜¯å­˜æ¡£ç‚¹</strong></p><h3 id=è¿œç¨‹è¿æ¥>è¿œç¨‹è¿æ¥</h3><p>Win ç”¨æˆ·æ¨èç”¨ Xshellï¼ŒMac ç”¨è‡ªå¸¦çš„ Terminal å°±å¯ä»¥</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ssh root@207.143.88.12 # æ¢æˆä½ çš„ipåœ°å€ï¼Œå›è½¦
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åæŠŠå¯†ç ä» vultr å¤åˆ¶è¿‡æ¥å›è½¦ï¼Œè¿æ¥æˆåŠŸåˆ™ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„æç¤ºï¼š</p><h3 id=å®‰å…¨è®¾ç½®>å®‰å…¨è®¾ç½®</h3><p>å› ä¸º root æƒé™å¤ªå¤ªå¤ªå¼ºå¤§ï¼Œä¸ºäº†é¿å…å©´å„¿ï¼ˆæˆ‘ï¼‰æ‹¿æ ¸æ­¦å™¨å‘å°„æŒ‰é’®çš„æƒ…å†µå‡ºç°ï¼Œåˆ›å»ºä¸€ä¸ªæ™®é€šç”¨æˆ·æ—¥å¸¸ä½¿ç”¨</p><h4 id=æ–°å»ºæ™®é€šç”¨æˆ·å¹¶è®¾å®šå¯†ç >æ–°å»ºæ™®é€šç”¨æˆ·å¹¶è®¾å®šå¯†ç </h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>adduser vpsadmin
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åè¾“å…¥å¯†ç -ç¡®è®¤å¯†ç ï¼ˆå¤ªç®€å•ä¼šè¢«æ‹’ç»==ï¼‰</p><h4 id=èµ‹äºˆ-vpsadmin-ä½¿ç”¨-sudo-æŒ‡ä»¤çš„æƒé™>èµ‹äºˆ ã€Œvpsadminã€ ä½¿ç”¨ sudo æŒ‡ä»¤çš„æƒé™</h4><p>ä»€ä¹ˆæ˜¯ su å’Œ sudo è¯·çœ‹ï¼š<a class=link href=https://blog.gtwang.org/linux/sudo-su-command-tutorial-examples/ target=_blank rel=noopener>Linux çš„ su èˆ‡ sudo æŒ‡ä»¤æ•™å­¸èˆ‡ç¯„ä¾‹</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo adduser vpsadmin sudo
</span></span></code></pre></td></tr></table></div></div><p>å¦å¤–å¼€ä¸€ä¸ªç»ˆç«¯çª—å£ï¼Œç™»å½• vpsadmin è´¦å·</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ssh vpsadmin@185.202.62.49 # æ¢æˆä½ çš„IPï¼Œå›è½¦ï¼Œç„¶åè¾“å…¥å¯†ç 
</span></span></code></pre></td></tr></table></div></div><p>éªŒè¯æ˜¯å¦è·å¾— sudo æƒé™</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo ls -al /root
</span></span></code></pre></td></tr></table></div></div><p>è¿”å›ç±»ä¼¼å†…å®¹ï¼ˆå±•ç¤º <code>/root</code> ç›®å½•ä¸‹çš„èµ„æ–™ï¼‰å°±è¡¨ç¤ºæˆåŠŸäº†</p><h4 id=ç¦æ­¢-root-ç™»å½•>ç¦æ­¢ root ç™»å½•</h4><p>ç™»å½• root è´¦æˆ·ï¼Œè¾“å…¥</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>nano /etc/ssh/sshd_config
</span></span></code></pre></td></tr></table></div></div><p>ä½¿ç”¨ <code>control + W</code> è¿›å…¥æœç´¢æ¨¡å¼ï¼Œè¾“å…¥ <code>PerimitRootLogin</code> å¹¶å›è½¦ï¼Œæ‰¾åˆ°æ‰€åœ¨è¡Œï¼Œæ”¹æˆï¼ˆè®°å¾—è¦å–æ‰æ³¨é‡Š <code>#</code>ï¼ï¼ï¼‰</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>PermitRootLogin: no
</span></span></code></pre></td></tr></table></div></div><p>*prohibit-password/without-password æ„ä¸ºç¦æ­¢å¯†ç ç™»å½•</p><p>ä½¿ç”¨ <code>control + O</code>ï¼Œä¿å­˜æ›´æ”¹ï¼Œ<code>control + X</code> é€€å‡º</p><p>é‡æ–°å¯åŠ¨ SSH æœåŠ¡</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo /etc/init.d/ssh restart
</span></span></code></pre></td></tr></table></div></div><p><strong>æ‰“å¼€ä¸€ä¸ªæ–°çª—å£</strong>ï¼Œå°è¯•ç”¨ root ç™»å½•</p><p>âœ…æˆåŠŸç¦æ­¢ root ç™»å½•</p><p>ä»ç°åœ¨å¼€å§‹ï¼Œç”¨ã€Œvpsadminã€è¿™ä¸ªè´¦æˆ·è¿œç¨‹è¿æ¥ VPS å§</p><h3 id=æ­å»ºç¯å¢ƒ>æ­å»ºç¯å¢ƒ</h3><h4 id=ä¿®æ”¹æœåŠ¡å™¨æ—¶é—´>ä¿®æ”¹æœåŠ¡å™¨æ—¶é—´</h4><p>æŸ¥çœ‹æ—¶é—´</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>timedatectl
</span></span></code></pre></td></tr></table></div></div><p>åˆ—å‡ºæ‰€æœ‰æ—¶åŒº</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>timedatectl list-timezones
</span></span></code></pre></td></tr></table></div></div><p>æ”¹æˆé¦™æ¸¯ğŸ‡­ğŸ‡°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo timedatectl set-timezone Asia/Hong_Kong
</span></span></code></pre></td></tr></table></div></div><h4 id=å®‰è£…å¸¸ç”¨å‘½ä»¤>å®‰è£…å¸¸ç”¨å‘½ä»¤</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo apt-get install curl wget screen tree -y
</span></span></code></pre></td></tr></table></div></div><p>*curlç”¨äºè¯·æ±‚ Web æœåŠ¡å™¨</p><p>*wgetç”¨æ¥ä¸‹è½½è½¯ä»¶åŒ…</p><p>*screenç”¨äºå‘½ä»¤è¡Œç»ˆç«¯çš„çª—å£åˆ‡æ¢</p><p>*treeç”¨äºæ˜¾ç¤ºå½“å‰æ–‡ä»¶å¤¹çš„ç›®å½•ç»“æ„</p><p>ï¼ˆå¦‚æœä½ æœ‰å…¶å®ƒè¦ç”¨çš„ä¹Ÿä¸€èµ·åŠ è¿›æ¥ï¼Œæˆ–è€…è¦ç”¨äº†å†ç”¨è¿™ä¸ªå‘½ä»¤å•ç‹¬å®‰è£…ä¹Ÿå¯ä»¥ï¼‰</p><h4 id=æ·»åŠ -swap>æ·»åŠ  SWAP</h4><p>swap æ˜¯ Linux ä¸­çš„è™šæ‹Ÿå†…å­˜ï¼Œç”¨äºåœ¨ç‰©ç†å†…å­˜ä¸è¶³çš„æƒ…å†µä¸‹å‚¨å­˜ä¸´æ—¶æ•°æ®ï¼Œå¯ä»¥æå‡å°å†…å­˜ VPS çš„è¿è¡Œæ•ˆç‡</p><p>ç¡®è®¤æ˜¯å¦å·²å­˜åœ¨ SWAP</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>free -m
</span></span></code></pre></td></tr></table></div></div><p>æœ‰ Swap é¡¹è€Œä¸” total åˆ—ä¸ä¸ºé›¶ï¼Œè¯´æ˜ Swap å·²å­˜åœ¨ï¼Œå¯ä»¥è‡ªè¡Œä¿®æ”¹åˆ†åŒºå®¹é‡ï¼Œå‚è€ƒï¼šä¸º <a class=link href=https://www.vvave.net/archives/add-swap-and-repartition-swap-for-linux.html target=_blank rel=noopener>Linux æ·»åŠ  swap åˆ†åŒºæˆ–ä¿®æ”¹ swap åˆ†åŒºå®¹é‡</a></p><h4 id=é…ç½®é˜²ç«å¢™>é…ç½®é˜²ç«å¢™</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo ufw allow OpenSSH
</span></span><span class=line><span class=cl>sudo ufw enable
</span></span></code></pre></td></tr></table></div></div><p>æ‰“å¼€é˜²ç«å¢™</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo ufw allow http
</span></span><span class=line><span class=cl>sudo ufw allow https
</span></span></code></pre></td></tr></table></div></div><p>æ‰“å¼€ 80ã€443 çš„ç«¯å£</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo ufw allow 80/tcp
</span></span><span class=line><span class=cl>sudo ufw allow 443/tcp
</span></span></code></pre></td></tr></table></div></div><p>ï¼ˆå…¶å®ƒæœåŠ¡éœ€è¦çš„ç«¯å£ä¹Ÿç”¨ <code>sudo ufw allow xx/tcp</code> å¼€å¯ï¼‰</p><p>éªŒè¯é˜²ç«å¢™æ˜¯å¦æ‰“å¼€ï¼Œç«¯å£æ˜¯å¦å¼€å¯</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo ufw status
</span></span></code></pre></td></tr></table></div></div><p>å’Œå…¶å®ƒæœåŠ¡å•†ä¸åŒï¼ŒVultr æ²¡æœ‰é»˜è®¤é˜²ç«å¢™è®¾ç½®ï¼Œæ‰€ä»¥è¦è‡ªå·±å¼€å¯</p><p>åœ¨ Vultr æ·»åŠ é˜²ç«å¢™è§„åˆ™</p><h4 id=å®‰è£…-docker-å’Œ-docker-compose>å®‰è£… Docker å’Œ Docker Compose</h4><p>*Compose æ˜¯ Docker çš„ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œé€šè¿‡ yml æ–‡ä»¶å®šä¹‰ã€åˆ›å»ºã€ç®¡ç†å¤šå®¹å™¨çš„ Docker åº”ç”¨</p><p>è·Ÿç€ <a class=link href=https://www.51cto.com/article/715086.html target=_blank rel=noopener>å¦‚ä½•åœ¨ Ubuntu 22.04 LTS ä¸­å®‰è£… Docker å’Œ Docker Compose</a> ä¸æ»‘å®Œæˆå®‰è£…</p><p>æ¨èï¼š<a class=link href=https://ostechnix.com/getting-started-with-docker/ target=_blank rel=noopener>Docker Commands Tutorial | Getting Started With Docker In Linux</a></p><h5 id=ä¿®æ”¹-docker-é…ç½®>ä¿®æ”¹ Docker é…ç½®</h5><p>Docker çš„é…ç½®æ–‡ä»¶è·¯å¾„æ˜¯ <code>/etc/docker/daemon.json</code>ï¼Œéœ€è¦æ‰‹åŠ¨åˆ›å»ºï¼š</p><p>è¿›å…¥ <code>/etc</code> ç›®å½•</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cd /etc
</span></span></code></pre></td></tr></table></div></div><p>è¿›å…¥ <code>docker</code> ç›®å½•</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cd docker
</span></span></code></pre></td></tr></table></div></div><p>ç”¨ vim ç¼–è¾‘ <code>daemon.json</code> æ–‡ä»¶</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo vim daemon.json
</span></span></code></pre></td></tr></table></div></div><p>è¿›å…¥ vim åè¾“å…¥å¦‚ä¸‹å†…å®¹ï¼Œè¿™æ®µä»£ç ä¼šå¢åŠ ä¸€æ®µè‡ªå®šä¹‰å†…ç½‘ IPv6 åœ°å€ï¼Œå¼€å¯å®¹å™¨çš„ IPv6 åŠŸèƒ½ï¼Œé™åˆ¶æ—¥å¿—æ–‡ä»¶çš„å¤§å°ï¼ˆ20Mï¼‰ï¼Œé™åˆ¶æ—¥å¿—æ–‡ä»¶æ•°é‡ï¼Œé˜²æ­¢ Docker æ—¥å¿—è¿‡å¤šå ç”¨ç¡¬ç›˜</p><p>ï¼ˆä»£ç æ¥è‡ª<a class=link href=https://u.sb/debian-install-docker/ target=_blank rel=noopener>çƒ§é¥¼åšå®¢</a>ï¼‰</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;log-driver&#34;</span><span class=p>:</span> <span class=s2>&#34;json-file&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;log-opts&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;max-size&#34;</span><span class=p>:</span> <span class=s2>&#34;20m&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;max-file&#34;</span><span class=p>:</span> <span class=s2>&#34;3&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;ipv6&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;fixed-cidr-v6&#34;</span><span class=p>:</span> <span class=s2>&#34;fd00:dead:beef:c0::/80&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;experimental&#34;</span><span class=p>:</span><span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;ip6tables&#34;</span><span class=p>:</span><span class=kc>true</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>âš ï¸ vim å’Œæ™®é€šé”®å…¥ç•¥æœ‰ä¸ç”¨</p><ul><li><p>é¦–å…ˆ <code>I</code> è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œè¾“å…¥å†…å®¹ï¼ˆæ³¨æ„æ ¼å¼ï¼šå¤§æ‹¬å· <code>{}</code> é‡Œçš„å†…å®¹é™¤äº†æœ€åä¸€è¡Œï¼Œéƒ½å¿…é¡»ç”¨è‹±æ–‡é€—å· <code>,</code> ç»“å°¾ï¼‰</p></li><li><p>å®Œæˆè¾“å…¥åï¼ŒæŒ‰ <code>esc</code> å›åˆ°ä¸€èˆ¬æ¨¡å¼</p></li><li><p>è¾“å…¥ <code>:wq</code> ï¼Œå›è½¦ï¼ˆæ„ä¸ºä¿å­˜-ç¦»å¼€ï¼‰</p></li><li><p>ä¸æ”¾å¿ƒå¯ä»¥å†æ¬¡è¿›å…¥ daemon.json æ£€æŸ¥æ˜¯å¦æˆåŠŸå†™å…¥ï¼Œæ•ˆæœç±»ä¼¼ï¼š</p></li></ul><p>äº†è§£ï¼š<a class=link href=https://www.runoob.com/linux/linux-vim.html target=_blank rel=noopener>Linux vi/vim æ˜¯ä»€ä¹ˆï¼Œæ€ä¹ˆä½¿ç”¨</a></p><p>é‡å¯ Docker æœåŠ¡</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo systemctl daemon-reload
</span></span><span class=line><span class=cl>sudo systemctl restart docker
</span></span></code></pre></td></tr></table></div></div><h5 id=æ£€æŸ¥-docker-æ˜¯å¦æ­£åœ¨è¿è¡Œ>æ£€æŸ¥ Docker æ˜¯å¦æ­£åœ¨è¿è¡Œ</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo systemctl status docker
</span></span></code></pre></td></tr></table></div></div><p>æ¢ä¸ªæ–¹å¼ï¼Œå†æµ‹è¯•ä¸€ä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo docker run hello-world
</span></span></code></pre></td></tr></table></div></div><p>ç»ˆäºæˆåŠŸäº† ğŸ˜­</p><h5 id=æ–‡ä»¶ç®¡ç†>æ–‡ä»¶ç®¡ç†</h5><p>ç»™ Docker çš„æ•°æ®å’Œé…ç½®æ–‡ä»¶æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>mkdir -p data/docker_data
</span></span></code></pre></td></tr></table></div></div><h2 id=misskey>Misskey</h2><h3 id=åˆ›å»ºå®‰è£…ç›®å½•>åˆ›å»ºå®‰è£…ç›®å½•</h3><p>ä¹‹å‰ç»™ Docker çš„æ•°æ®å’Œé…ç½®æ–‡ä»¶æ–°å»ºä¸€ä¸ªç›®å½• <code>docker_data</code>ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹å°±æ˜¯åŒ…ä½æ•´ä¸ª Misskey çš„ç›’å­</p><p>è¿›å…¥ç›®å½•</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cd data/docker_data
</span></span></code></pre></td></tr></table></div></div><p>åˆ›å»º misskey æ–‡ä»¶å¤¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo mkdir misskey
</span></span></code></pre></td></tr></table></div></div><h3 id=é…ç½®å®‰è£…æ–‡ä»¶>é…ç½®å®‰è£…æ–‡ä»¶</h3><p>è¿›å…¥ misskey æ–‡ä»¶å¤¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cd misskey
</span></span></code></pre></td></tr></table></div></div><p>åˆ›å»ºå¹¶ç¼–è¾‘ yml æ–‡ä»¶ï¼Œè®©å®ƒå»éƒ¨ç½²</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo vim docker-compose.yml
</span></span></code></pre></td></tr></table></div></div><p>æŠŠä»¥ä¸‹å†…å®¹ç²˜è´´è¿›å»</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=c># Misskey minimal deploy config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;3&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>web</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>unless-stopped</span><span class=w> </span><span class=c># alwaysæ„å‘³ç€è‡ªåŠ¨é‡å¯ï¼Œè¯·æ³¨æ„å¦‚æœæ‚¨å¯¹æ‚¨çš„é…ç½®æ²¡æœ‰ä¿¡å¿ƒï¼Œè¯·ä¸è¦å¼€å¯è¿™ä¸ªé€‰é¡¹ï¼Œä»¥é¿å…è¿›ç¨‹å´©æºƒåå¤é‡å¯è€—è´¹å¤§é‡èµ„æºï¼</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>misskey/misskey:latest</span><span class=w> </span><span class=c># è¿™é‡Œä½¿ç”¨äº†å®˜æ–¹é•œåƒï¼Œä»¥é¿å…æœ¬åœ°æ„å»ºæ—¶èµ„æºä¸è¶³çš„é—®é¢˜</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>misskey_web</span><span class=w> </span><span class=c># å®¹å™¨åï¼Œæ–¹ä¾¿ç®¡ç†ï¼Œæ‚¨å¯ä»¥è‡ªè¡Œä¿®æ”¹ä¸ºæ‚¨è§‰å¾—åˆé€‚çš„å†…å®¹</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>links</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>db</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>redis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;3001:3001&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>networks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>internal_network</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>external_network</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>./config:/misskey/.config:ro</span><span class=w> </span><span class=c># ç”¨äºæ˜ å°„é…ç½®æ–‡ä»¶ï¼Œè¯·æ ¹æ®æ‚¨çš„å®é™…é…ç½®æ¥å†³å®šæ–‡ä»¶å¤¹åç§°ï¼Œè®¾å®šä¸ºåªè¯»å³å¯ï¼›</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>./files:/misskey/files</span><span class=w> </span><span class=c># ç”¨æˆ·ä¸Šä¼ åˆ°æœ¬åœ°çš„æ–‡ä»¶ï¼Œå¦‚æœæ‚¨ä¸€å¼€å§‹å°±æ¥å…¥å¤–éƒ¨å­˜å‚¨ï¼ˆå¦‚wasabiæˆ–æ˜¯AWS S3ï¼‰æ‚¨å¯ä»¥å¿½ç•¥è¿™å—é…ç½®</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>redis</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>unless-stopped</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>redis:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>misskey_redis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>networks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>internal_network</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>./redis:/data</span><span class=w> </span><span class=c># redisæ•°æ®åº“çš„æ•°æ®æ–‡ä»¶å¤¹æ˜ å°„ï¼Œåˆ›å»ºåé»˜è®¤åœ¨ ./redis æ–‡ä»¶å¤¹ä¸­</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>db</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>unless-stopped</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>postgres:12.2-alpine</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>misskey_db</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>networks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>internal_network</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>env_file</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>./config/docker.env</span><span class=w> </span><span class=c># éœ€è¦ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„ Docker ç¯å¢ƒå˜é‡</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>./db:/var/lib/postgresql/data</span><span class=w> </span><span class=c># ä¸»æ•°æ®åº“çš„æ•°æ®æ–‡ä»¶å¤¹æ˜ å°„ï¼Œåˆ›å»ºåé»˜è®¤åœ¨ ./db æ–‡ä»¶å¤¹ä¸­</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>networks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>internal_network</span><span class=p>:</span><span class=w> </span><span class=c># å†…éƒ¨ç½‘ç»œ</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>internal</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>external_network</span><span class=p>:</span><span class=w> </span><span class=c># å¤–éƒ¨ç½‘</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>æŒ‰ <code>esc</code> ï¼ŒæŒ‰ <code>:wq</code> ï¼Œå›è½¦ï¼ˆä¿å­˜-é€€å‡ºï¼‰</p><p>åˆ›å»º <code>config/default.yml</code> ç›®å½•å¹¶è¿›å…¥ yml æ–‡ä»¶ä¸­</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo mkdir config
</span></span><span class=line><span class=cl>cd config
</span></span><span class=line><span class=cl>sudo vim default.yml
</span></span></code></pre></td></tr></table></div></div><p>å¡«å…¥ä»¥ä¸‹å†…å®¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=c>#â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Misskey configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   â”Œâ”€â”€â”€â”€â”€â”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#â”€â”€â”€â”˜ URL â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Final accessible URL seen by a user.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>https://ponderduck.cc/      </span><span class=w> </span><span class=c># æ³¨æ„æ”¹æˆè‡ªå·±æœ€ååå‘ä»£ç†æƒ³è¦çš„ç½‘å€</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># ONCE YOU HAVE STARTED THE INSTANCE, DO NOT CHANGE THE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># URL SETTINGS AFTER THAT!</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#â”€â”€â”€â”˜ Port and TLS settings â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Misskey requires a reverse proxy to support HTTPS connections.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#                 +----- https://example.tld/ ------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   +------+      |+-------------+      +----------------+|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   | User | ---&gt; || Proxy (443) | ---&gt; | Misskey (3000) ||</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   +------+      |+-------------+      +----------------+|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#                 +---------------------------------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   You need to set up a reverse proxy. (e.g. nginx)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   An encrypted connection with HTTPS is highly recommended</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   because tokens may be transferred in GET requests.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># The port that your Misskey server should listen on.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>3001</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#â”€â”€â”€â”˜ PostgreSQL configuration â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>db</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=l>db</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>5432</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Database name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>db</span><span class=p>:</span><span class=w> </span><span class=l>misskey</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Auth</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>user</span><span class=p>:</span><span class=w> </span><span class=l>example-misskey-user</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pass</span><span class=p>:</span><span class=w> </span><span class=l>example-misskey-pass</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Whether disable Caching queries</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#disableCache: true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Extra Connection options</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#extra:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#  ssl: true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#â”€â”€â”€â”˜ Redis configuration â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>redis</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=l>redis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>6379</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#family: 0  # 0=Both, 4=IPv4, 6=IPv6</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#pass: example-pass</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#prefix: example-prefix</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#db: 1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#â”€â”€â”€â”˜ Elasticsearch configuration â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#elasticsearch:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  host: localhost</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  port: 9200</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  ssl: false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  user: </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  pass: </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#â”€â”€â”€â”˜ ID generation â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># You can select the ID generation method.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># You don&#39;t usually need to change this setting, but you can</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># change it according to your preferences.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Available methods:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># aid ... Short, Millisecond accuracy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># meid ... Similar to ObjectID, Millisecond accuracy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># ulid ... Millisecond accuracy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># objectid ... This is left for backward compatibility</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># ONCE YOU HAVE STARTED THE INSTANCE, DO NOT CHANGE THE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># ID SETTINGS AFTER THAT!</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;aid&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#â”€â”€â”€â”˜ Other configuration â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Whether disable HSTS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#disableHsts: true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Number of worker processes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#clusterLimit: 1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Job concurrency per worker</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># deliverJobConcurrency: 128</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># inboxJobConcurrency: 16</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Job rate limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># deliverJobPerSec: 128</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># inboxJobPerSec: 16</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Job attempts</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># deliverJobMaxAttempts: 12</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># inboxJobMaxAttempts: 8</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># IP address family used for outgoing request (ipv4, ipv6 or dual)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#outgoingAddressFamily: ipv4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Syslog option</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#syslog:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  host: localhost</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  port: 514</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Proxy for HTTP/HTTPS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#proxy: http://127.0.0.1:3128</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#proxyBypassHosts: [</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  &#39;example.com&#39;,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  &#39;192.0.2.8&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Proxy for SMTP/SMTPS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#proxySmtp: http://127.0.0.1:3128   # use HTTP/1.1 CONNECT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#proxySmtp: socks4://127.0.0.1:1080 # use SOCKS4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#proxySmtp: socks5://127.0.0.1:1080 # use SOCKS5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Media Proxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#mediaProxy: https://example.com/proxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Proxy remote files (default: false)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#proxyRemoteFiles: true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Sign to ActivityPub GET request (default: false)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#signToActivityPubGet: true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#allowedPrivateNetworks: [</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  &#39;127.0.0.1/32&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Upload or download file size limits (bytes)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#maxFileSize: 262144000</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>æŒ‰ <code>esc</code> ï¼ŒæŒ‰ <code>:wq</code> ï¼Œå›è½¦ï¼ˆä¿å­˜-é€€å‡ºï¼‰</p><p>è¿›å…¥ env æ–‡ä»¶</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo vim docker.env
</span></span></code></pre></td></tr></table></div></div><p>å¡«å†™å¦‚ä¸‹å†…å®¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># db settings</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>POSTGRES_PASSWORD=example-misskey-pass</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>POSTGRES_USER=example-misskey-user</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>POSTGRES_DB=misskey</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=éƒ¨ç½²>éƒ¨ç½²</h3><p>è¿˜è®°å¾—æˆ‘è¯´ã€Œåˆ›å»ºå¹¶ç¼–è¾‘ yml æ–‡ä»¶ï¼Œè®©å®ƒå»éƒ¨ç½²ã€å—ï¼Ÿ</p><p>ç°åœ¨æ–‡ä»¶å·²ç»é…ç½®å®Œæ¯•äº†ï¼Œæ˜¯æ—¶å€™è®©å®ƒè·‘èµ·æ¥äº†ï¼</p><p>åŒæ‰‹åˆåğŸ™</p><p>åˆ‡æ¢åˆ°ä¸Šä¸€çº§ç›®å½•</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cd ..
</span></span></code></pre></td></tr></table></div></div><p>å±ä½å‘¼å¸</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo docker-compose run --rm web yarn run init # åˆå§‹åŒ–æ•°æ®åº“
</span></span><span class=line><span class=cl>sudo docker-compose up -d # åå°å¯åŠ¨é¡¹ç›®å®¹å™¨
</span></span></code></pre></td></tr></table></div></div><p>è·‘äº†è·‘äº†ï¼Œå¥½äº†å¥½äº†</p><h3 id=è®¿é—®ç«™ç‚¹>è®¿é—®ç«™ç‚¹</h3><p>æŸ¥çœ‹ç«¯å£çŠ¶æ€</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo lsof -i:&lt;port&gt;
</span></span></code></pre></td></tr></table></div></div><p>å‡å¦‚è¿™ä¸ªç«¯å£ä¸èƒ½ç”¨ï¼Œé‚£å°±æ¢ä¸€ä¸ªã€‚</p><p>æ–°ç«¯å£è¦åœ¨æœåŠ¡å•†é˜²ç«å¢™ã€ufw å‘½ä»¤ã€<code>default.yml</code> å’Œ <code>docker-compose.yml</code> é‡Œéƒ½å¼€å¯ã€æ”¹è¿‡æ¥</p><p>ç„¶åé‡å¯ Docker</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo docker-compose restart [æŒ‡å®šæœåŠ¡çš„å®¹å™¨]
</span></span></code></pre></td></tr></table></div></div><p>å®Œæˆè¿™ä¸€æ­¥ä¹‹åï¼Œå°è¯•ç”¨ IP è®¿é—®ç«™ç‚¹å§</p><p>åœ¨æµè§ˆå™¨è¾“å…¥ <code>http://&lt;ip>:&lt;port></code>ï¼ˆIP å¯ä»¥ç”¨ <code>curl ip.sb</code> è¿”å›ï¼‰</p><p><img src=https://raw.githubusercontent.com/Falasool/blog-pic-bed/main/blog/image-20221118220253976.png loading=lazy alt=image-20221118220253976></p><p>æˆåŠŸäº†å£ç‰™ï¼</p><p>æµå‡ºå¤§æ²³æ³ª</p><p>Misskey è¦æ±‚ SSL è®¿é—®ï¼Œå¦å¤–ç«™ç‚¹è¿˜éœ€è¦è®¾ç½®åå‘ä»£ç†ï¼Œè¿™ä¸¤ä»¶äº‹è®©â¬‡ï¸ NPM ä¸€èµ·å¹²äº†</p><h3 id=nginxproxymanagernpm>NginxProxyManagerï¼ˆNPMï¼‰</h3><p>æ˜¯ä¸€ä¸ªå¸¦å‰ç«¯ç®¡ç†ç•Œé¢çš„ Nginx æœåŠ¡å™¨ï¼Œé€šè¿‡Letâ€™s encrypt æ¥è‡ªåŠ¨ç”³è¯· SSL è¯ä¹¦å¹¶è‡ªåŠ¨éƒ¨ç½²ï¼Œåå‘ä»£ç†ä½ æ‰€éœ€è¦çš„å®¹å™¨</p><p>å¯ä»¥æ‹¿æ¥å®ç°äºŒçº§åŸŸååˆ†åˆ«è®¿é—®æŒ‡å®šç«¯å£çš„å®¹å™¨ + ä¸€é”®éƒ¨ç½² SSL</p><h4 id=åˆ›å»ºå¹¶é…ç½®-docker-composeyml-æ–‡ä»¶>åˆ›å»ºå¹¶é…ç½® docker-compose.yml æ–‡ä»¶</h4><p>åˆ›å»ºå¹¶è¿›å…¥ yml æ–‡ä»¶</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cd /home
</span></span><span class=line><span class=cl>sudo mkdir myapp
</span></span><span class=line><span class=cl>cd myapp
</span></span><span class=line><span class=cl>sudo vim docker-compose.yml
</span></span></code></pre></td></tr></table></div></div><p>æŠŠä»¥ä¸‹é…ç½®ç²˜è´´è¿›å»ï¼Œä¿å­˜é€€å‡º</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;3&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>app</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;jc21/nginx-proxy-manager:latest&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>unless-stopped</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># These ports are in format &lt;host-port&gt;:&lt;container-port&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s1>&#39;80:80&#39;</span><span class=w> </span><span class=c># Public HTTP Port</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s1>&#39;443:443&#39;</span><span class=w> </span><span class=c># Public HTTPS Port</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s1>&#39;81:81&#39;</span><span class=w> </span><span class=c># Admin Web Port</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Add any other Stream port you want to expose</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># - &#39;21:21&#39; # FTP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>DB_MYSQL_HOST</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;db&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>DB_MYSQL_PORT</span><span class=p>:</span><span class=w> </span><span class=m>3306</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>DB_MYSQL_USER</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;npm&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>DB_MYSQL_PASSWORD</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;npm&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>DB_MYSQL_NAME</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;npm&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Uncomment this if IPv6 is not enabled on your host</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># DISABLE_IPV6: &#39;true&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>./data:/data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>./letsencrypt:/etc/letsencrypt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>depends_on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>db</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>db</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;jc21/mariadb-aria:latest&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>unless-stopped</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>MYSQL_ROOT_PASSWORD</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;npm&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>MYSQL_DATABASE</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;npm&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>MYSQL_USER</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;npm&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>MYSQL_PASSWORD</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;npm&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>./data/mysql:/var/lib/mysql</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>åå°å¯åŠ¨é¡¹ç›®å®¹å™¨</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo docker-compose up -d
</span></span></code></pre></td></tr></table></div></div><p>é‡åˆ°æŠ¥é”™ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Error starting userland proxy: listen tcp 0.0.0.0:80: bind: address already in use
</span></span></code></pre></td></tr></table></div></div><p>æ‰§è¡Œ <code>netstat -pna | grep 80</code> ï¼ˆæŸ¥è¯¢ç«¯å£ 80 æ˜¯å¦å¼€æ”¾/è¢«å ç”¨ï¼‰ï¼Œè¿”å›ï¼š</p><p><img src=https://raw.githubusercontent.com/Falasool/blog-pic-bed/main/blog/image-20221118003045589.png loading=lazy alt=image-20221118003045589></p><p>Listen è¡¨ç¤ºè¢«å ç”¨ï¼Œ80 ç«¯å£è¢« nginx å ç”¨</p><p>*netstatï¼šæ§åˆ¶å°å‘½ä»¤ï¼Œç”¨äºç›‘æ§ TCP/IP ç½‘ç»œ</p><p>*grepï¼šæŸ¥æ‰¾æ–‡ä»¶å†…å®¹</p><p>ğŸ”ªæ€æ‰è¿™ä¸ªè¿›ç¨‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo kill 19306
</span></span></code></pre></td></tr></table></div></div><p>å†æ¬¡éƒ¨ç½²ï¼ŒæŸ¥çœ‹å®¹å™¨çš„è¿è¡Œæƒ…å†µ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>docker container ls
</span></span></code></pre></td></tr></table></div></div><p>ğŸ†è§£å†³æŠ¥é”™</p><p>âœ…å®Œæˆ yml æ–‡ä»¶çš„é…ç½®</p><h4 id=è®¾ç½®åä»£>è®¾ç½®åä»£</h4><p>æ‰“å¼€æœåŠ¡å™¨çš„ <code>81</code> ç«¯å£</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo ufw allow 81/tcp
</span></span></code></pre></td></tr></table></div></div><p>åœ¨æµè§ˆå™¨è¾“å…¥ <code>&lt;ip>:81</code> ï¼Œç”¨é»˜è®¤è´¦å·å¯†ç ç™»å½• NPM</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>admin@example.com
</span></span><span class=line><span class=cl>changeme
</span></span></code></pre></td></tr></table></div></div><p>ä¿®æ”¹è´¦å·å¯†ç ï¼ŒNPM åˆå§‹åŒ–å®Œæˆï¼Œå¼€å§‹é…ç½®</p><p>Forward Hostname / IP å¡«çš„æ˜¯å®¹å™¨æ‰€åœ¨ Docker ç½‘æ¡¥çš„è™šæ‹Ÿ IPï¼Œé€šè¿‡å‘½ä»¤æŸ¥åˆ°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo docker network inspect bridge
</span></span></code></pre></td></tr></table></div></div><p>æ‰¾åˆ° <code>IPAM - Config - Gateway</code> èŠ‚ç‚¹ï¼Œåé¢çš„ IP å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„</p><p>*å¦‚æœä½ åœ¨ docker-compose.yml ä¸­è‡ªå®šä¹‰äº†ç½‘æ¡¥ï¼Œé‚£ä¹ˆè‡ªå®šä¹‰ç½‘æ¡¥åç§°æ›¿æ¢æ‰ä¸Šé¢çš„ <code>bridge</code> å‚æ•°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[
</span></span><span class=line><span class=cl>    {
</span></span><span class=line><span class=cl>        &#34;IPAM&#34;: {
</span></span><span class=line><span class=cl>            &#34;Config&#34;: [
</span></span><span class=line><span class=cl>                {
</span></span><span class=line><span class=cl>                    &#34;Gateway&#34;: &#34;xxxx:xxxx:xxxx:xx::x&#34;
</span></span><span class=line><span class=cl>                }
</span></span><span class=line><span class=cl>            ]
</span></span><span class=line><span class=cl>        },
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>]
</span></span></code></pre></td></tr></table></div></div><h4 id=ç”³è¯·-ssl-è¯ä¹¦>ç”³è¯· SSL è¯ä¹¦</h4><p>å» CloudFlare</p><p><img src=https://raw.githubusercontent.com/Falasool/blog-pic-bed/main/blog/image-20221118224811252.png loading=lazy alt=image-20221118224811252></p><p><img src=https://raw.githubusercontent.com/Falasool/blog-pic-bed/main/blog/image-20221118225559842.png loading=lazy alt=image-20221118225559842></p><p>è®¾ç½®ç®¡ç†å‘˜</p><h2 id=å…¶å®ƒå‚è€ƒ>å…¶å®ƒå‚è€ƒ</h2><p><a class=link href=https://weirenxue.github.io/2021/06/17/user_linux_sudo/ target=_blank rel=noopener>[User] Linux æ–°å¢ä½¿ç”¨è€…ä¸¦è³¦äºˆå…¶ä½¿ç”¨ sudo çš„æ¬Šé™</a></p><p><a class=link href=https://blog.laoda.de/archives/how-to-secure-a-linux-server target=_blank rel=noopener>ä¿æŠ¤å¥½ä½ çš„å°é¸¡ï¼ä¿å§†çº§æœåŠ¡å™¨å®‰å…¨æ•™ç¨‹ï¼</a></p><p><a class=link href=https://blog.laoda.de/archives/getting-started-with-linux target=_blank rel=noopener>mjjç‰ˆçš„linuxå…¥é—¨æ•™ç¨‹</a></p><p><a class=link href=https://blog.wardzhou.art/2021/02/27/NginXProxyManager target=_blank rel=noopener>Nginx Proxy Managerâ€”â€”å°è€Œç¾çš„å¤šå®¹å™¨è½¬å‘æ–¹æ¡ˆ</a></p></section><footer class=article-footer><section class=article-tags><a href=/tags/tutorial/>tutorial</a>
<a href=/tags/miskey/>miskey</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/2022/10/22/domain/><div class=article-image><img src="https://picsum.photos/800/600.webp?random=7bb02909" loading=lazy data-key=Domain data-hash="https://picsum.photos/800/600.webp?random=7bb02909"></div><div class=article-details><h2 class=article-title>åšå®¢åŸŸåè®¾ç½®</h2></div></a></article><article class=has-image><a href=/2022/10/21/picture-bed/><div class=article-image><img src="https://picsum.photos/800/600.webp?random=fa517d08" loading=lazy data-key="Picture Bed" data-hash="https://picsum.photos/800/600.webp?random=fa517d08"></div><div class=article-details><h2 class=article-title>å€ŸåŠ© PicGo å’Œ GitHub å®ç°æ’å…¥å›¾ç‰‡</h2></div></a></article><article class=has-image><a href=/2022/10/21/build-hugo-site-on-macos/><div class=article-image><img src="https://picsum.photos/800/600.webp?random=6e5ecc50" loading=lazy data-key="Build Hugo Site on macOS" data-hash="https://picsum.photos/800/600.webp?random=6e5ecc50"></div><div class=article-details><h2 class=article-title>Hugoï½œGithub Pagesï½œStackä¸»é¢˜ï½œæ­å»ºè®°å½•</h2></div></a></article><article class=has-image><a href=/2022/10/14/hugo-comment-system-disqusjs/><div class=article-image><img src="https://picsum.photos/800/600.webp?random=275db47b" loading=lazy data-key="Hugo Comment System Disqusjs" data-hash="https://picsum.photos/800/600.webp?random=275db47b"></div><div class=article-details><h2 class=article-title>ç»™åšå®¢æ·»åŠ è¯„è®ºç³»ç»Ÿï½œDisqus</h2></div></a></article><article class=has-image><a href=/2022/10/12/hugo-front-matter/><div class=article-image><img src="https://picsum.photos/800/600.webp?random=5fe4fd89" loading=lazy data-key="Hugo Front Matter" data-hash="https://picsum.photos/800/600.webp?random=5fe4fd89"></div><div class=article-details><h2 class=article-title>Hugo | Front Matter</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//bizarreadventure.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2021 -
2022 Rubber Duck's Bizarre Adventure</section><section class=powerby>æœªç»å…è®¸ä¸å¾—éšæ„è½¬è½½<br>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.14.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#è´­ä¹°-vps>è´­ä¹° VPS</a><ol><li><a href=#åˆ›å»º-vps>åˆ›å»º VPS</a></li><li><a href=#æ£€æŸ¥-ip>æ£€æŸ¥ IP</a></li></ol></li><li><a href=#åŸŸå>åŸŸå</a><ol><li><a href=#è§£æåŸŸå>è§£æåŸŸå</a></li></ol></li><li><a href=#é…ç½®-vps>é…ç½® VPS</a><ol><li><a href=#è¿œç¨‹è¿æ¥>è¿œç¨‹è¿æ¥</a></li><li><a href=#å®‰å…¨è®¾ç½®>å®‰å…¨è®¾ç½®</a><ol><li><a href=#æ–°å»ºæ™®é€šç”¨æˆ·å¹¶è®¾å®šå¯†ç >æ–°å»ºæ™®é€šç”¨æˆ·å¹¶è®¾å®šå¯†ç </a></li><li><a href=#èµ‹äºˆ-vpsadmin-ä½¿ç”¨-sudo-æŒ‡ä»¤çš„æƒé™>èµ‹äºˆ ã€Œvpsadminã€ ä½¿ç”¨ sudo æŒ‡ä»¤çš„æƒé™</a></li><li><a href=#ç¦æ­¢-root-ç™»å½•>ç¦æ­¢ root ç™»å½•</a></li></ol></li><li><a href=#æ­å»ºç¯å¢ƒ>æ­å»ºç¯å¢ƒ</a><ol><li><a href=#ä¿®æ”¹æœåŠ¡å™¨æ—¶é—´>ä¿®æ”¹æœåŠ¡å™¨æ—¶é—´</a></li><li><a href=#å®‰è£…å¸¸ç”¨å‘½ä»¤>å®‰è£…å¸¸ç”¨å‘½ä»¤</a></li><li><a href=#æ·»åŠ -swap>æ·»åŠ  SWAP</a></li><li><a href=#é…ç½®é˜²ç«å¢™>é…ç½®é˜²ç«å¢™</a></li><li><a href=#å®‰è£…-docker-å’Œ-docker-compose>å®‰è£… Docker å’Œ Docker Compose</a></li></ol></li></ol></li><li><a href=#misskey>Misskey</a><ol><li><a href=#åˆ›å»ºå®‰è£…ç›®å½•>åˆ›å»ºå®‰è£…ç›®å½•</a></li><li><a href=#é…ç½®å®‰è£…æ–‡ä»¶>é…ç½®å®‰è£…æ–‡ä»¶</a></li><li><a href=#éƒ¨ç½²>éƒ¨ç½²</a></li><li><a href=#è®¿é—®ç«™ç‚¹>è®¿é—®ç«™ç‚¹</a></li><li><a href=#nginxproxymanagernpm>NginxProxyManagerï¼ˆNPMï¼‰</a><ol><li><a href=#åˆ›å»ºå¹¶é…ç½®-docker-composeyml-æ–‡ä»¶>åˆ›å»ºå¹¶é…ç½® docker-compose.yml æ–‡ä»¶</a></li><li><a href=#è®¾ç½®åä»£>è®¾ç½®åä»£</a></li><li><a href=#ç”³è¯·-ssl-è¯ä¹¦>ç”³è¯· SSL è¯ä¹¦</a></li></ol></li></ol></li><li><a href=#å…¶å®ƒå‚è€ƒ>å…¶å®ƒå‚è€ƒ</a></li></ol></nav></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>
<!doctype html><html lang dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><title>Misskey</title><link rel=canonical href=https://falasool.github.io/2022/misskey/><link rel=stylesheet href=/scss/style.min.404c857d6b39ded4a65e25cd388b671a161b5fde50710c44b10fa37553ef0a5d.css><meta property="og:title" content="Misskey"><meta property="og:description" content><meta property="og:url" content="https://falasool.github.io/2022/misskey/"><meta property="og:site_name" content="Rubber Duck's Bizarre Adventure"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="tutorial"><meta property="article:tag" content="miskey"><meta property="article:published_time" content="2022-11-19T20:19:15+08:00"><meta property="article:modified_time" content="2022-11-19T20:19:15+08:00"><meta name=twitter:title content="Misskey"><meta name=twitter:description content><link rel="shortcut icon" href=/img/favicon.ico><script async src="https://www.googletagmanager.com/gtag/js?id=G-SSG1Q6LM3K"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SSG1Q6LM3K",{anonymize_ip:!1})}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu268ba2ccfeb36e3648936a87aa48bcbd_263179_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>ğŸ¦·</span></figure><div class=site-meta><h1 class=site-name><a href=/>Rubber Duck's Bizarre Adventure</a></h1><h2 class=site-description>äººé–“è®ƒæ­Œã¯ã€Œå‹‡æ°—ã€ã®è®ƒæ­Œãƒƒï¼ï¼äººé–“ã®ã™ã°ã‚‰ã—ã•ã¯å‹‡æ°—ã®ã™ã°ã‚‰ã—ã•ï¼ï¼</h2></div></header><ol class=social-menu><li><a href=https://github.com/Falasool/ target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paw" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14.7 13.5c-1.1-2-1.441-2.5-2.7-2.5-1.259.0-1.736.755-2.836 2.747-.942 1.703-2.846 1.845-3.321 3.291-.097.265-.145.677-.143.962.0 1.176.787 2 1.8 2 1.259.0 3-1 4.5-1s3.241 1 4.5 1c1.013.0 1.8-.823 1.8-2 0-.285-.049-.697-.146-.962-.475-1.451-2.512-1.835-3.454-3.538z"/><path d="M20.188 8.082A1.039 1.039.0 0019.782 8h-.015c-.735.012-1.56.75-1.993 1.866-.519 1.335-.28 2.7.538 3.052.129.055.267.082.406.082.739.0 1.575-.742 2.011-1.866.516-1.335.273-2.7-.54-3.052z"/><path d="M9.474 9c.055.0.109.0.163-.011.944-.128 1.533-1.346 1.32-2.722C10.754 4.97 9.91 4 9.025 4c-.055.0-.109.0-.163.011-.944.128-1.533 1.346-1.32 2.722C7.746 8.026 8.59 9 9.475 9z"/><path d="M16.456 6.733c.214-1.376-.375-2.594-1.32-2.722A1.164 1.164.0 0014.974 4c-.885.0-1.728.97-1.93 2.267-.214 1.376.375 2.594 1.32 2.722.054.007.108.011.162.011.885.0 1.73-.974 1.93-2.267z"/><path d="M5.69 12.918c.816-.352 1.054-1.719.536-3.052C5.79 8.742 4.955 8 4.217 8c-.14.0-.277.027-.407.082-.816.352-1.054 1.719-.536 3.052C3.71 12.258 4.545 13 5.283 13c.14.0.277-.027.407-.082z"/></svg><span>About</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/projects/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-app-window" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 5m0 2a2 2 0 012-2h14a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><path d="M6 8h.01"/><path d="M9 8h.01"/></svg><span>Projects</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/friends/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Friends</span></a></li><div class=menu-bottom-section><li id=i18n-switch><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><select name=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://falasool.github.io/ selected>English</option><option value=https://falasool.github.io/zh-cn/>ä¸­æ–‡</option></select></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/misskey/>Misskey</a>
<a href=/categories/fediverse/>Fediverse</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/2022/misskey/>Misskey</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Nov 19, 2022</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>14 minute read</time></div></footer></div></header><section class=article-content><p>æœ¬æ¬¡æ­å»ºä½¿ç”¨ Ubuntu 22.10 ç³»ç»Ÿ</p><p>è¶…çº§å•°å—¦é¢„è­¦</p><h2 id=è´­ä¹°-vps>è´­ä¹° VPS</h2><p>âš ï¸ä¸è¦ä¹°æœºæˆ¿åœ¨å¤§é™†çš„æœåŠ¡å•† VPS âš ï¸</p><p>åœ¨å¤‡æ¡ˆé€šè¿‡ä¹‹å‰ 80 å’Œ 443 ç«¯å£æ˜¯å°ç¦çš„ -> æ— æ³•ç”³è¯· SSL è¯ä¹¦ -> Misskey éœ€è¦ SSL æ‰èƒ½è®¿é—®ï¼ŒGG</p><p>ï¼ˆå³ä½¿æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œä¹°å¤§é™†èŠ‚ç‚¹çš„æœåŠ¡å»ºç«™ä¹Ÿæ˜¯ä¸€ç§è‡ªæ€è¡Œä¸ºï¼‰</p><h3 id=æ³¨å†Œ>æ³¨å†Œ</h3><p>æ³¨å†ŒVultr è´¦å·ï¼Œå……å€¼</p><p><img src=https://raw.githubusercontent.com/Falasool/blog-pic-bed/main/blog/misskey1.png loading=lazy alt=image-20221120012614543></p><h3 id=åˆ›å»º-vps>åˆ›å»º VPS</h3><p><img src=https://raw.githubusercontent.com/Falasool/blog-pic-bed/main/blog/image-20221120012203832.png loading=lazy alt=image-20221120012203832></p><ul><li><p>é€‰ Cloud Computer</p></li><li><p>CPU é€‰ AMD å’Œ Intel éƒ½è¡Œ</p></li><li><p>æœºæˆ¿ä½ç½®é€‰æ‹©æ—¥æœ¬ã€æ–°åŠ å¡ã€ç¾è¥¿éƒ½è¡Œï¼Œä¸€èˆ¬ä¸æ¨èæ¬§æ´²ï¼ˆå¯¹äºä¸­å›½å›½å†…ï¼‰</p></li><li><p>é€‰æ‹©æ“ä½œç³»ç»Ÿï¼šUbuntu 22.10 x64</p></li><li><p>é€‰æ‹© Sizeï¼š$5 çš„ 1C1G1TB å¥—é¤ï¼ˆè®°å¾—å‹¾é€‰ No Thanksï¼‰</p></li><li><p>å…³é—­è‡ªåŠ¨å¤‡ä»½ï¼Œçœ $1</p></li><li><p>Additional Featuresï¼šå‹¾é€‰ Enable IPv6</p></li><li><p>æ·»åŠ  SSH Keys</p></li></ul><p>æ‰“å¼€å‘½ä»¤è¡Œï¼Œè¾“å…¥</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh-keygen -t rsa -b <span class=m>4096</span> -C <span class=s2>&#34;Example comment&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>åœ¨è¿™è¡Œæç¤ºåé¢è¾“å…¥ä½ æƒ³è¦ä¿å­˜å¯†é’¥çš„è·¯å¾„</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Generating public/private rsa key pair.
</span></span><span class=line><span class=cl>Enter file in which to save the key (/home/example_user/.ssh/id_rsa):
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘è¾“å…¥ï¼ˆuuæ˜¯æˆ‘çš„ç”µè„‘ç”¨æˆ·åï¼‰</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/home/uu/.ssh/id_rsa_vultr
</span></span></code></pre></td></tr></table></div></div><p>æ‰€ä»¥åœ¨ <code>/.ssh</code> ç›®å½•ä¸‹å¯ä»¥æ‰¾åˆ° <code>id_rsa_vultr</code> å’Œ <code>id_rsa_vultr.pub</code> æ–‡ä»¶ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ç§é’¥å’Œå…¬é’¥</p><p>æ¥ä¸‹æ¥è¦æŠŠå…¬é’¥å†…å®¹æ·»åŠ åˆ° vultr å»</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># è¿›å…¥.ssh ç›®å½•</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> .ssh
</span></span><span class=line><span class=cl><span class=c1># æ‰“å°æ–‡ä»¶å†…å®¹</span>
</span></span><span class=line><span class=cl>cat id_rsa_vultr.pub
</span></span></code></pre></td></tr></table></div></div><ul><li>è¿™æ—¶åº•éƒ¨ä»˜æ¬¾æ åº”è¯¥æ˜¾ç¤º <code>$5.00/month</code> ï¼Œç‚¹å‡» <code>Deploy Now</code> ç¡®è®¤åˆ›å»ºæœåŠ¡å™¨ï¼Œç­‰å¾…ä¸€ä¼šï¼Œç­‰ Status å˜æˆ Running å°±å¥½äº†</li></ul><p><img src=https://raw.githubusercontent.com/Falasool/blog-pic-bed/main/blog/misskey2-1.png loading=lazy alt=image-20221120012909994></p><p>ç‚¹å‡»åˆšåˆšåˆ›å»ºçš„ VPSï¼Œçœ‹åˆ°å¦‚ä¸‹ç•Œé¢ã€‚</p><p>å·¦ä¸‹è§’çš„ IP Addressã€Usernameã€Password æ˜¯å¾…ä¼šè¿æ¥æœåŠ¡å™¨çš„æ—¶å€™ï¼Œè¦ç”¨åˆ°çš„ SSH è¿æ¥ä¿¡æ¯</p><p><img src=https://raw.githubusercontent.com/Falasool/blog-pic-bed/main/blog/misskey3.png loading=lazy alt=image-20221120013010174></p><ol><li>ç™»å½• VNCï¼šæŸ¥çœ‹æ§åˆ¶å°</li><li>å…³æœºï¼šå°±å’Œå…³ç”µè„‘ä¸€æ ·ï¼ˆå…³æœºçš„æ—¶å€™ä»ç„¶åœ¨è®¡è´¹å“¦ï¼ï¼‰</li><li>é‡å¯ï¼šå°±å’Œé‡å¯ç”µè„‘ä¸€æ ·</li><li>é‡è£…ç³»ç»Ÿï¼šæŠŠæœåŠ¡å™¨é‡ç½®æˆåˆšåˆ›å»ºæ—¶çš„çŠ¶æ€</li><li>é”€æ¯/åˆ é™¤ï¼šé”€æ¯äº†æœåŠ¡å™¨å°±ä¸è®¡è´¹äº†ï¼Œæ•°æ®ä¸¢å¤±ï¼Œæ— æ³•æ‰¾å›</li></ol><p>Snapshotsï¼šå¿«ç…§ï¼ŒæŒ‡å°†å½“å‰ VPS çš„çŠ¶æ€ä¿å­˜ä¸‹æ¥ï¼Œå¯¹ VPS è¿›è¡Œå®Œæ•´å¤‡ä»½</p><p>æœåŠ¡å™¨åˆ›å»ºå®Œæˆ</p><h3 id=æ£€æŸ¥-ip>æ£€æŸ¥ IP</h3><p>Ping ä¸€ä¸‹ IP</p><p><img src=https://raw.githubusercontent.com/Falasool/blog-pic-bed/main/blog/misskey4.png loading=lazy alt=image-20221120013147886></p><p>ç”¨æ£€æŸ¥å·¥å…·æ¯”å¦‚ <a class=link href=https://ip112.cn/ target=_blank rel=noopener>https://ip112.cn/</a> æ£€æŸ¥ IPï¼Œæ­¤ IP å¯ç”¨</p><p><img src=https://raw.githubusercontent.com/Falasool/blog-pic-bed/main/blog/misskey5.png loading=lazy alt=image-20221120013305544></p><p>å…¶å®ƒæµ‹è¯•å·¥å…·</p><ul><li><a class=link href=http://ping.pe/ target=_blank rel=noopener>http://ping.pe/</a> â€” å…¨çƒèŠ‚ç‚¹ Pingï¼ŒåŒ…æ‹¬ä¸­å›½çš„ä¸‰å¤§è¿è¥å•†</li><li><a class=link href=http://ping.chinaz.com/ target=_blank rel=noopener>http://ping.chinaz.com/</a> â€” Ping æ£€æµ‹ä¸­å›½å¤§é™†çš„è®¿é—®æƒ…å†µ</li></ul><h2 id=åŸŸå>åŸŸå</h2><p>åœ¨åŸŸåå•† <a class=link href=https://www.dynadot.com/zh/ target=_blank rel=noopener>Dynadot</a> æ³¨å†Œè´¦å·ï¼Œä¹°ä¸€ä¸ªåŸŸå</p><h3 id=è§£æåŸŸå>è§£æåŸŸå</h3><p>ä¾æ¬¡ç‚¹å‡»</p><p><img src=https://raw.githubusercontent.com/Falasool/blog-pic-bed/main/blog/misskey6.png loading=lazy alt=image-20221120013439245></p><p>æš‚åœâ¸ï¸</p><p>å» <a class=link href=https://dash.cloudflare.com/ target=_blank rel=noopener>CloudFlare</a> æ³¨å†Œç™»å½•è´¦å·ï¼Œä¾æ¬¡æ“ä½œï¼š</p><p>æ·»åŠ æ–°ç«™ç‚¹</p><p><img src=https://raw.githubusercontent.com/Falasool/blog-pic-bed/main/blog/misskey7.png loading=lazy alt=image-20221120013614146></p><p>è¾“å…¥ä½ çš„åŸŸå</p><p><img src=https://raw.githubusercontent.com/Falasool/blog-pic-bed/main/blog/misskey8.png loading=lazy alt=image-20221120013635155></p><p>é€‰æ‹©å…è´¹æ–¹æ¡ˆ</p><p>æ·»åŠ  DNS è§£æè®°å½•</p><ul><li><p><code>*</code> æ˜¯é€šé…ç¬¦ï¼Œæ„æ€æ˜¯æˆ‘çš„äºŒçº§åŸŸåï¼Œxxx.ponderduck.cc çš„ DNS è§£æä¹Ÿä¸€èµ·è¢«æ¥ç®¡äº†ã€‚ä¸ç”¨æˆ‘ä¸€ä¸ªä¸€ä¸ªè®¾ç½®</p></li><li><p>ç¬¬äºŒè¡Œæ˜¯åŸŸåæœ¬ä½“</p></li><li><p><code>www</code> è®©è¾“å…¥ <a class=link href=https://www.ponderduck.cc target=_blank rel=noopener>www.ponderduck.cc</a> ä¹Ÿèƒ½è®¿é—®</p></li></ul><p>å¤åˆ¶ CloudFlare æä¾›çš„ä¸¤ä¸ªåç§°æœåŠ¡å™¨ï¼Œå¡«è¿› Dynadot çš„ DNS è®¾ç½®ï¼Œä¿å­˜</p><p>å›åˆ° CloudFlare ç‚¹å‡» <code>Done, check nameservers</code>ï¼Œç­‰ä¸€ä¼š</p><p><del>æµ‹è¯•ï¼Œping ä½ çš„åŸŸåï¼Œè¿”å›æœåŠ¡å™¨ IP è¯´æ˜è§£æç”Ÿæ•ˆ</del></p><p>å¼€å¯å®Œå…¨ SSLï¼Œå¦åˆ™è®¿é—®ç«™ç‚¹ä¼šæŠ¥ã€Œé‡å®šå‘æ¬¡æ•°è¿‡å¤šã€çš„é”™è¯¯</p><p><img src=/Library/Application%20Support/typora-user-images/image-20221121185003309.png loading=lazy alt=image-20221121185003309></p><p>âœ…åŸŸåè§£æå®Œæˆ</p><h2 id=æœåŠ¡å™¨åŸºç¡€é…ç½®>æœåŠ¡å™¨åŸºç¡€é…ç½®</h2><p><strong>å¯¹å“ªä¸€æ­¥ä¸è‡ªä¿¡ï¼Œå¯ä»¥åœ¨å¼€å§‹åšä¹‹å‰å…ˆå»æœåŠ¡å™¨ç®¡ç†é¢æ¿åˆ›å»ºä¸€ä¸ªå¿«ç…§ï¼ˆsnapshotsï¼‰ï¼Œå¿«ç…§å°±æ˜¯å­˜æ¡£ç‚¹</strong></p><h3 id=è¿œç¨‹è¿æ¥>è¿œç¨‹è¿æ¥</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh root@101.113.22.42 <span class=c1># æ¢æˆä½ çš„ipåœ°å€ï¼Œå›è½¦</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åæŠŠå¯†ç ä» vultr å¤åˆ¶è¿‡æ¥å›è½¦ï¼Œä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„æç¤ºå°±è¡¨ç¤ºè¿æ¥æœåŠ¡å™¨æˆåŠŸ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Welcome to Ubuntu 22.10 <span class=o>(</span>GNU/Linux 5.19.0-23-generic x86_64<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> * Documentation:  https://help.ubuntu.com
</span></span><span class=line><span class=cl> * Management:     https://landscape.canonical.com
</span></span><span class=line><span class=cl> * Support:        https://ubuntu.com/advantage
</span></span><span class=line><span class=cl> ...çœç•¥ä¸€éƒ¨åˆ†å†…å®¹...
</span></span><span class=line><span class=cl>root@vultr:~# 
</span></span></code></pre></td></tr></table></div></div><h3 id=å®‰å…¨è®¾ç½®>å®‰å…¨è®¾ç½®</h3><p>å› ä¸º root æƒé™å¤ªå¤ªå¤ªå¼ºå¤§ï¼Œä¸ºäº†é¿å…å©´å„¿ï¼ˆæˆ‘ï¼‰æ‹¿æ ¸æ­¦å™¨å‘å°„æŒ‰é’®çš„æƒ…å†µå‡ºç°ï¼Œåˆ›å»ºä¸€ä¸ªæ™®é€šç”¨æˆ·æ—¥å¸¸ä½¿ç”¨</p><h4 id=æ–°å»ºæ™®é€šç”¨æˆ·å¹¶è®¾å®šå¯†ç >æ–°å»ºæ™®é€šç”¨æˆ·å¹¶è®¾å®šå¯†ç </h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>adduser vpsadmin <span class=c1># vpsadminæ˜¯ç”¨æˆ·å</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åè¾“å…¥å¯†ç  - ç¡®è®¤å¯†ç ï¼ˆå¤ªç®€å•ä¼šè¢«æ‹’ç»==ï¼‰</p><h4 id=èµ‹äºˆ-vpsadmin-ä½¿ç”¨-sudo-æŒ‡ä»¤çš„æƒé™>èµ‹äºˆ ã€Œvpsadminã€ ä½¿ç”¨ sudo æŒ‡ä»¤çš„æƒé™</h4><p>ä»€ä¹ˆæ˜¯ su å’Œ sudo è¯·çœ‹ï¼š<a class=link href=https://blog.gtwang.org/linux/sudo-su-command-tutorial-examples/ target=_blank rel=noopener>Linux çš„ su èˆ‡ sudo æŒ‡ä»¤æ•™å­¸èˆ‡ç¯„ä¾‹</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo adduser vpsadmin sudo
</span></span></code></pre></td></tr></table></div></div><p>å¦å¤–å¼€ä¸€ä¸ªç»ˆç«¯çª—å£ï¼Œç™»å½• vpsadmin è´¦å·</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh vpsadmin@185.202.62.49 <span class=c1># æ¢æˆä½ çš„IPï¼Œå›è½¦ï¼Œç„¶åè¾“å…¥å¯†ç </span>
</span></span></code></pre></td></tr></table></div></div><p>éªŒè¯æ˜¯å¦è·å¾— sudo æƒé™</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ls -al /root
</span></span></code></pre></td></tr></table></div></div><p>è¿”å›ç±»ä¼¼å†…å®¹ï¼ˆå±•ç¤º <code>/root</code> ç›®å½•ä¸‹çš„èµ„æ–™ï¼‰å°±è¡¨ç¤ºæˆåŠŸäº†</p><h4 id=å¯é€‰sshå…å¯†ç™»å½•>[å¯é€‰]SSHå…å¯†ç™»å½•</h4><p>æ¯æ¬¡ç™»å½• vpsadmin éƒ½è¦æ‰‹åŠ¨è¾“å¯†ç å¾ˆéº»çƒ¦ï¼Œè®¾ç½®ä¸€ä¸‹å…å¯†ç™»å½•</p><p>åœ¨ Tabby è®¾ç½® - Profiles & connections - <code>+ New profile</code> - SSH connection</p><h4 id=ç¦æ­¢-root-ç™»å½•>ç¦æ­¢ root ç™»å½•</h4><p>ï¼ˆç¦ç”¨æ ¸æŒ‰é’®ï¼‰</p><p>ç™»å½• root è´¦æˆ·ï¼Œè¾“å…¥</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nano /etc/ssh/sshd_config
</span></span></code></pre></td></tr></table></div></div><p>ä½¿ç”¨ <code>control + W</code> è¿›å…¥æœç´¢æ¨¡å¼ï¼Œè¾“å…¥ <code>PerimitRootLogin</code> å¹¶å›è½¦ï¼Œæ‰¾åˆ°æ‰€åœ¨è¡Œï¼Œæ”¹æˆï¼ˆè®°å¾—è¦å–æ‰æ³¨é‡Š <code>#</code>ï¼ï¼ï¼‰</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>PermitRootLogin: no
</span></span></code></pre></td></tr></table></div></div><p>*prohibit-password/without-password æ„ä¸ºç¦æ­¢å¯†ç ç™»å½•</p><p>ä½¿ç”¨ <code>control + O</code>ï¼Œä¿å­˜æ›´æ”¹ï¼Œ<code>control + X</code> é€€å‡º</p><p>é‡æ–°å¯åŠ¨ SSH æœåŠ¡</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo /etc/init.d/ssh restart
</span></span></code></pre></td></tr></table></div></div><p><strong>æ‰“å¼€ä¸€ä¸ªæ–°çª—å£</strong>ï¼Œå°è¯•ç”¨ root ç™»å½•ï¼Œè¿”å› Permission denied&mldr;</p><p>âœ…æˆåŠŸç¦æ­¢ root ç™»å½•</p><p>ä»ç°åœ¨å¼€å§‹ï¼Œç”¨ã€Œvpsadminã€è¿™ä¸ªè´¦æˆ·è¿œç¨‹è¿æ¥ VPS å§</p><h3 id=æ­å»ºç¯å¢ƒ>æ­å»ºç¯å¢ƒ</h3><h4 id=ä¿®æ”¹æœåŠ¡å™¨æ—¶é—´>ä¿®æ”¹æœåŠ¡å™¨æ—¶é—´</h4><p>æŸ¥çœ‹æ—¶é—´</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>timedatectl
</span></span></code></pre></td></tr></table></div></div><p>åˆ—å‡ºæ‰€æœ‰æ—¶åŒº</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>timedatectl list-timezones
</span></span></code></pre></td></tr></table></div></div><p>æ”¹æˆé¦™æ¸¯ğŸ‡­ğŸ‡°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo timedatectl set-timezone Asia/Hong_Kong
</span></span></code></pre></td></tr></table></div></div><h4 id=å®‰è£…å¸¸ç”¨å‘½ä»¤>å®‰è£…å¸¸ç”¨å‘½ä»¤</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get install curl wget screen tree -y
</span></span></code></pre></td></tr></table></div></div><p>*curlç”¨äºè¯·æ±‚ Web æœåŠ¡å™¨</p><p>*wgetç”¨æ¥ä¸‹è½½è½¯ä»¶åŒ…</p><p>*screenç”¨äºå‘½ä»¤è¡Œç»ˆç«¯çš„çª—å£åˆ‡æ¢</p><p>*treeç”¨äºæ˜¾ç¤ºå½“å‰æ–‡ä»¶å¤¹çš„ç›®å½•ç»“æ„</p><p>ï¼ˆå¦‚æœä½ æœ‰å…¶å®ƒè¦ç”¨çš„ä¹Ÿä¸€èµ·åŠ è¿›æ¥ï¼Œæˆ–è€…è¦ç”¨äº†å†ç”¨è¿™ä¸ªå‘½ä»¤å•ç‹¬å®‰è£…ä¹Ÿå¯ä»¥ï¼‰</p><h4 id=æ·»åŠ -swap>æ·»åŠ  SWAP</h4><p>swap æ˜¯ Linux ä¸­çš„è™šæ‹Ÿå†…å­˜ï¼Œç”¨äºåœ¨ç‰©ç†å†…å­˜ä¸è¶³çš„æƒ…å†µä¸‹å‚¨å­˜ä¸´æ—¶æ•°æ®ï¼Œå¯ä»¥æå‡å°å†…å­˜ VPS çš„è¿è¡Œæ•ˆç‡</p><p>ç¡®è®¤æ˜¯å¦å·²å­˜åœ¨ SWAP</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>free -m
</span></span></code></pre></td></tr></table></div></div><p>æœ‰ Swap é¡¹è€Œä¸” total åˆ—ä¸ä¸ºé›¶ï¼Œè¯´æ˜ Swap å·²å­˜åœ¨ï¼Œå¯ä»¥è‡ªè¡Œä¿®æ”¹åˆ†åŒºå®¹é‡ï¼Œå‚è€ƒï¼šä¸º <a class=link href=https://www.vvave.net/archives/add-swap-and-repartition-swap-for-linux.html target=_blank rel=noopener>Linux æ·»åŠ  swap åˆ†åŒºæˆ–ä¿®æ”¹ swap åˆ†åŒºå®¹é‡</a></p><h4 id=é…ç½®é˜²ç«å¢™>é…ç½®é˜²ç«å¢™</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ufw allow OpenSSH
</span></span><span class=line><span class=cl>sudo ufw <span class=nb>enable</span>
</span></span></code></pre></td></tr></table></div></div><p>æ‰“å¼€é˜²ç«å¢™</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ufw allow http
</span></span><span class=line><span class=cl>sudo ufw allow https
</span></span></code></pre></td></tr></table></div></div><p>æ‰“å¼€ 80ã€443 çš„ç«¯å£</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ufw allow 80/tcp
</span></span><span class=line><span class=cl>sudo ufw allow 443/tcp
</span></span></code></pre></td></tr></table></div></div><p>ï¼ˆå…¶å®ƒæœåŠ¡éœ€è¦çš„ç«¯å£ä¹Ÿç”¨ <code>sudo ufw allow xx/tcp</code> å¼€å¯ï¼‰</p><p>éªŒè¯é˜²ç«å¢™æ˜¯å¦æ‰“å¼€ï¼Œç«¯å£æ˜¯å¦å¼€å¯</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ufw status
</span></span></code></pre></td></tr></table></div></div><p>å’Œå…¶å®ƒæœåŠ¡å•†ä¸åŒï¼ŒVultr æ²¡æœ‰é»˜è®¤é˜²ç«å¢™è®¾ç½®ï¼Œæ‰€ä»¥è¦è‡ªå·±å¼€å¯</p><p>åœ¨ Vultr æ·»åŠ é˜²ç«å¢™è§„åˆ™</p><h4 id=å®‰è£…-docker-å’Œ-docker-compose>å®‰è£… Docker å’Œ Docker Compose</h4><p>*Compose æ˜¯ Docker çš„ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œé€šè¿‡ yml æ–‡ä»¶å®šä¹‰ã€åˆ›å»ºã€ç®¡ç†å¤šå®¹å™¨çš„ Docker åº”ç”¨</p><p>è·Ÿç€ <a class=link href=https://www.51cto.com/article/715086.html target=_blank rel=noopener>å¦‚ä½•åœ¨ Ubuntu 22.04 LTS ä¸­å®‰è£… Docker å’Œ Docker Compose</a> ä¸æ»‘å®Œæˆå®‰è£…</p><p>æ¨èï¼š<a class=link href=https://ostechnix.com/getting-started-with-docker/ target=_blank rel=noopener>Docker Commands Tutorial | Getting Started With Docker In Linux</a></p><h5 id=ä¿®æ”¹-docker-é…ç½®>ä¿®æ”¹ Docker é…ç½®</h5><p>Docker çš„é…ç½®æ–‡ä»¶è·¯å¾„æ˜¯ <code>/etc/docker/daemon.json</code>ï¼Œéœ€è¦æ‰‹åŠ¨åˆ›å»ºï¼š</p><p>è¿›å…¥ <code>/etc/docker</code> ç›®å½•</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /etc/docker
</span></span></code></pre></td></tr></table></div></div><p>ç”¨ vim ç¼–è¾‘ <code>daemon.json</code> æ–‡ä»¶</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vim daemon.json
</span></span></code></pre></td></tr></table></div></div><p>è¿›å…¥ vim åè¾“å…¥å¦‚ä¸‹å†…å®¹ï¼Œè¿™æ®µä»£ç ä¼šå¢åŠ ä¸€æ®µè‡ªå®šä¹‰å†…ç½‘ IPv6 åœ°å€ï¼Œå¼€å¯å®¹å™¨çš„ IPv6 åŠŸèƒ½ï¼Œé™åˆ¶æ—¥å¿—æ–‡ä»¶çš„å¤§å°ï¼ˆ20Mï¼‰ï¼Œé™åˆ¶æ—¥å¿—æ–‡ä»¶æ•°é‡ï¼Œé˜²æ­¢ Docker æ—¥å¿—è¿‡å¤šå ç”¨ç¡¬ç›˜</p><p>ï¼ˆä»£ç æ¥è‡ª<a class=link href=https://u.sb/debian-install-docker/ target=_blank rel=noopener>çƒ§é¥¼åšå®¢</a>ï¼‰</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;log-driver&#34;</span><span class=p>:</span> <span class=s2>&#34;json-file&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;log-opts&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;max-size&#34;</span><span class=p>:</span> <span class=s2>&#34;20m&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;max-file&#34;</span><span class=p>:</span> <span class=s2>&#34;3&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;ipv6&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;fixed-cidr-v6&#34;</span><span class=p>:</span> <span class=s2>&#34;fd00:dead:beef:c0::/80&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;experimental&#34;</span><span class=p>:</span><span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;ip6tables&#34;</span><span class=p>:</span><span class=kc>true</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>âš ï¸ vim å’Œæ™®é€šé”®å…¥ç•¥æœ‰ä¸ç”¨</p><ul><li><p>é¦–å…ˆ <code>I</code> è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œè¾“å…¥å†…å®¹ï¼ˆæ³¨æ„æ ¼å¼ï¼šå¤§æ‹¬å· <code>{}</code> é‡Œçš„å†…å®¹é™¤äº†æœ€åä¸€è¡Œï¼Œéƒ½å¿…é¡»ç”¨è‹±æ–‡é€—å· <code>,</code> ç»“å°¾ï¼‰</p></li><li><p>å®Œæˆè¾“å…¥åï¼ŒæŒ‰ <code>esc</code> å›åˆ°ä¸€èˆ¬æ¨¡å¼</p></li><li><p>è¾“å…¥ <code>:wq</code> ï¼Œå›è½¦ï¼ˆæ„ä¸ºä¿å­˜-ç¦»å¼€ï¼‰</p></li><li><p>ä¸æ”¾å¿ƒå¯ä»¥å†æ¬¡è¿›å…¥ daemon.json æ£€æŸ¥æ˜¯å¦æˆåŠŸå†™å…¥ï¼Œæ•ˆæœç±»ä¼¼ï¼š</p></li></ul><p>äº†è§£ï¼š<a class=link href=https://www.runoob.com/linux/linux-vim.html target=_blank rel=noopener>Linux vi/vim æ˜¯ä»€ä¹ˆï¼Œæ€ä¹ˆä½¿ç”¨</a></p><p>é‡å¯ Docker æœåŠ¡</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl daemon-reload
</span></span><span class=line><span class=cl>sudo systemctl restart docker
</span></span></code></pre></td></tr></table></div></div><h5 id=æ£€æŸ¥-docker-æ˜¯å¦æ­£åœ¨è¿è¡Œ>æ£€æŸ¥ Docker æ˜¯å¦æ­£åœ¨è¿è¡Œ</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl status docker
</span></span></code></pre></td></tr></table></div></div><p>æ¢ä¸ªæ–¹å¼ï¼Œå†æµ‹è¯•ä¸€ä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo docker run hello-world
</span></span></code></pre></td></tr></table></div></div><p>ç»ˆäºæˆåŠŸäº† ğŸ˜­</p><h2 id=misskey>Misskey</h2><h3 id=åˆ›å»ºå®‰è£…ç›®å½•>åˆ›å»ºå®‰è£…ç›®å½•</h3><p>ä¹‹å‰ç»™ Docker çš„æ•°æ®å’Œé…ç½®æ–‡ä»¶æ–°å»ºä¸€ä¸ªç›®å½• <code>docker_data</code>ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹å°±æ˜¯åŒ…ä½æ•´ä¸ª Misskey çš„ç›’å­</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo mkdir -p data/docker_data
</span></span></code></pre></td></tr></table></div></div><p>è¿›å…¥ç›®å½•</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> data/docker_data
</span></span></code></pre></td></tr></table></div></div><p>åˆ›å»º misskey æ–‡ä»¶å¤¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo mkdir misskey
</span></span></code></pre></td></tr></table></div></div><h3 id=é…ç½®å®‰è£…æ–‡ä»¶>é…ç½®å®‰è£…æ–‡ä»¶</h3><p>è¿›å…¥ misskey æ–‡ä»¶å¤¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> misskey
</span></span></code></pre></td></tr></table></div></div><p>åˆ›å»ºå¹¶ç¼–è¾‘ yml æ–‡ä»¶ï¼Œè®©å®ƒå»éƒ¨ç½²</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vim docker-compose.yml
</span></span></code></pre></td></tr></table></div></div><p>æŒ‰ <code>I</code>ï¼Œåˆ‡æ¢åˆ°ç¼–è¾‘æ¨¡å¼ï¼ŒæŠŠä»¥ä¸‹å†…å®¹ç²˜è´´è¿›å»</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=c># Misskey minimal deploy config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;3&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>web</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>unless-stopped</span><span class=w> </span><span class=c># alwaysæ„å‘³ç€è‡ªåŠ¨é‡å¯ï¼Œè¯·æ³¨æ„å¦‚æœæ‚¨å¯¹æ‚¨çš„é…ç½®æ²¡æœ‰ä¿¡å¿ƒï¼Œè¯·ä¸è¦å¼€å¯è¿™ä¸ªé€‰é¡¹ï¼Œä»¥é¿å…è¿›ç¨‹å´©æºƒåå¤é‡å¯è€—è´¹å¤§é‡èµ„æºï¼</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>misskey/misskey:latest</span><span class=w> </span><span class=c># è¿™é‡Œä½¿ç”¨äº†å®˜æ–¹é•œåƒï¼Œä»¥é¿å…æœ¬åœ°æ„å»ºæ—¶èµ„æºä¸è¶³çš„é—®é¢˜</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>misskey_web</span><span class=w> </span><span class=c># å®¹å™¨åï¼Œæ–¹ä¾¿ç®¡ç†ï¼Œæ‚¨å¯ä»¥è‡ªè¡Œä¿®æ”¹ä¸ºæ‚¨è§‰å¾—åˆé€‚çš„å†…å®¹</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>links</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>db</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>redis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;3001:3001&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>networks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>internal_network</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>external_network</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>./config:/misskey/.config:ro</span><span class=w> </span><span class=c># ç”¨äºæ˜ å°„é…ç½®æ–‡ä»¶ï¼Œè¯·æ ¹æ®æ‚¨çš„å®é™…é…ç½®æ¥å†³å®šæ–‡ä»¶å¤¹åç§°ï¼Œè®¾å®šä¸ºåªè¯»å³å¯ï¼›</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>./files:/misskey/files</span><span class=w> </span><span class=c># ç”¨æˆ·ä¸Šä¼ åˆ°æœ¬åœ°çš„æ–‡ä»¶ï¼Œå¦‚æœæ‚¨ä¸€å¼€å§‹å°±æ¥å…¥å¤–éƒ¨å­˜å‚¨ï¼ˆå¦‚wasabiæˆ–æ˜¯AWS S3ï¼‰æ‚¨å¯ä»¥å¿½ç•¥è¿™å—é…ç½®</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>redis</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>unless-stopped</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>redis:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>misskey_redis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>networks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>internal_network</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>./redis:/data</span><span class=w> </span><span class=c># redisæ•°æ®åº“çš„æ•°æ®æ–‡ä»¶å¤¹æ˜ å°„ï¼Œåˆ›å»ºåé»˜è®¤åœ¨ ./redis æ–‡ä»¶å¤¹ä¸­</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>db</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>unless-stopped</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>postgres:12.2-alpine</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>misskey_db</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>networks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>internal_network</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>env_file</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>./config/docker.env</span><span class=w> </span><span class=c># éœ€è¦ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„ Docker ç¯å¢ƒå˜é‡</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>./db:/var/lib/postgresql/data</span><span class=w> </span><span class=c># ä¸»æ•°æ®åº“çš„æ•°æ®æ–‡ä»¶å¤¹æ˜ å°„ï¼Œåˆ›å»ºåé»˜è®¤åœ¨ ./db æ–‡ä»¶å¤¹ä¸­</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>networks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>internal_network</span><span class=p>:</span><span class=w> </span><span class=c># å†…éƒ¨ç½‘ç»œ</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>internal</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>external_network</span><span class=p>:</span><span class=w> </span><span class=c># å¤–éƒ¨ç½‘</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>æŒ‰ <code>esc</code> ï¼ŒæŒ‰ <code>:wq</code> ï¼Œå›è½¦ï¼ˆä¿å­˜-é€€å‡ºï¼‰</p><p>åˆ›å»º <code>config/default.yml</code> ç›®å½•å¹¶è¿›å…¥ yml æ–‡ä»¶ä¸­</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo mkdir config
</span></span><span class=line><span class=cl><span class=nb>cd</span> config
</span></span><span class=line><span class=cl>sudo vim default.yml
</span></span></code></pre></td></tr></table></div></div><p>æŒ‰ <code>I</code>ï¼Œåˆ‡æ¢åˆ°ç¼–è¾‘æ¨¡å¼ï¼Œå¡«å…¥ä»¥ä¸‹å†…å®¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=c>#â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Misskey configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   â”Œâ”€â”€â”€â”€â”€â”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#â”€â”€â”€â”˜ URL â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Final accessible URL seen by a user.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>https://ponderduck.cc/      </span><span class=w> </span><span class=c># æ³¨æ„æ”¹æˆè‡ªå·±æœ€ååå‘ä»£ç†æƒ³è¦çš„ç½‘å€</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># ONCE YOU HAVE STARTED THE INSTANCE, DO NOT CHANGE THE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># URL SETTINGS AFTER THAT!</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#â”€â”€â”€â”˜ Port and TLS settings â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Misskey requires a reverse proxy to support HTTPS connections.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#                 +----- https://example.tld/ ------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   +------+      |+-------------+      +----------------+|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   | User | ---&gt; || Proxy (443) | ---&gt; | Misskey (3000) ||</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   +------+      |+-------------+      +----------------+|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#                 +---------------------------------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   You need to set up a reverse proxy. (e.g. nginx)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   An encrypted connection with HTTPS is highly recommended</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   because tokens may be transferred in GET requests.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># The port that your Misskey server should listen on.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>3001</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#â”€â”€â”€â”˜ PostgreSQL configuration â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>db</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=l>db</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>5432</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Database name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>db</span><span class=p>:</span><span class=w> </span><span class=l>misskey</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Auth</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>user</span><span class=p>:</span><span class=w> </span><span class=l>example-misskey-user</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pass</span><span class=p>:</span><span class=w> </span><span class=l>example-misskey-pass</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Whether disable Caching queries</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#disableCache: true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Extra Connection options</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#extra:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#  ssl: true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#â”€â”€â”€â”˜ Redis configuration â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>redis</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=l>redis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>6379</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#family: 0  # 0=Both, 4=IPv4, 6=IPv6</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#pass: example-pass</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#prefix: example-prefix</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#db: 1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#â”€â”€â”€â”˜ Elasticsearch configuration â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#elasticsearch:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  host: localhost</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  port: 9200</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  ssl: false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  user: </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  pass: </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#â”€â”€â”€â”˜ ID generation â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># You can select the ID generation method.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># You don&#39;t usually need to change this setting, but you can</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># change it according to your preferences.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Available methods:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># aid ... Short, Millisecond accuracy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># meid ... Similar to ObjectID, Millisecond accuracy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># ulid ... Millisecond accuracy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># objectid ... This is left for backward compatibility</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># ONCE YOU HAVE STARTED THE INSTANCE, DO NOT CHANGE THE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># ID SETTINGS AFTER THAT!</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;aid&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#â”€â”€â”€â”˜ Other configuration â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Whether disable HSTS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#disableHsts: true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Number of worker processes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#clusterLimit: 1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Job concurrency per worker</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># deliverJobConcurrency: 128</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># inboxJobConcurrency: 16</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Job rate limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># deliverJobPerSec: 128</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># inboxJobPerSec: 16</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Job attempts</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># deliverJobMaxAttempts: 12</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># inboxJobMaxAttempts: 8</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># IP address family used for outgoing request (ipv4, ipv6 or dual)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#outgoingAddressFamily: ipv4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Syslog option</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#syslog:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  host: localhost</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  port: 514</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Proxy for HTTP/HTTPS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#proxy: http://127.0.0.1:3128</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#proxyBypassHosts: [</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  &#39;example.com&#39;,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  &#39;192.0.2.8&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Proxy for SMTP/SMTPS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#proxySmtp: http://127.0.0.1:3128   # use HTTP/1.1 CONNECT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#proxySmtp: socks4://127.0.0.1:1080 # use SOCKS4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#proxySmtp: socks5://127.0.0.1:1080 # use SOCKS5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Media Proxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#mediaProxy: https://example.com/proxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Proxy remote files (default: false)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#proxyRemoteFiles: true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Sign to ActivityPub GET request (default: false)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#signToActivityPubGet: true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#allowedPrivateNetworks: [</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#  &#39;127.0.0.1/32&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Upload or download file size limits (bytes)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#maxFileSize: 262144000</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>æŒ‰ <code>esc</code> ï¼ŒæŒ‰ <code>:wq</code> ï¼Œå›è½¦ï¼ˆä¿å­˜-é€€å‡ºï¼‰</p><p>è¿›å…¥ env æ–‡ä»¶</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vim docker.env
</span></span></code></pre></td></tr></table></div></div><p>æŒ‰ <code>I</code>ï¼Œåˆ‡æ¢åˆ°ç¼–è¾‘æ¨¡å¼ï¼Œå¡«å†™å¦‚ä¸‹å†…å®¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># db settings</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>POSTGRES_PASSWORD=example-misskey-pass</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>POSTGRES_USER=example-misskey-user</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>POSTGRES_DB=misskey</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=éƒ¨ç½²>éƒ¨ç½²</h3><p>è¿˜è®°å¾—æˆ‘è¯´ã€Œåˆ›å»ºå¹¶ç¼–è¾‘ yml æ–‡ä»¶ï¼Œè®©å®ƒå»éƒ¨ç½²ã€å—ï¼Ÿ</p><p>ç°åœ¨æ–‡ä»¶å·²ç»é…ç½®å®Œæ¯•äº†ï¼Œæ˜¯æ—¶å€™è®©å®ƒè·‘èµ·æ¥äº†ï¼</p><p>åŒæ‰‹åˆåğŸ™</p><p>åˆ‡æ¢åˆ°ä¸Šä¸€çº§ç›®å½•</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ..
</span></span></code></pre></td></tr></table></div></div><p>åˆå§‹åŒ–æ•°æ®åº“</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo docker-compose run --rm web yarn run init 
</span></span></code></pre></td></tr></table></div></div><p>åå°å¯åŠ¨é¡¹ç›®å®¹å™¨</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo docker-compose up -d 
</span></span></code></pre></td></tr></table></div></div><h3 id=è®¿é—®ç«™ç‚¹>è®¿é—®ç«™ç‚¹</h3><p>æŸ¥çœ‹ç«¯å£çŠ¶æ€</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo lsof -i:&lt;port&gt;
</span></span></code></pre></td></tr></table></div></div><p>å‡å¦‚è¿™ä¸ªç«¯å£ä¸èƒ½ç”¨ï¼Œé‚£å°±æ¢ä¸€ä¸ªã€‚</p><p>æ–°ç«¯å£è¦åœ¨æœåŠ¡å•†é˜²ç«å¢™ã€ufw å‘½ä»¤ã€<code>default.yml</code> å’Œ <code>docker-compose.yml</code> é‡Œéƒ½å¼€å¯ã€æ”¹è¿‡æ¥</p><p>ç„¶åé‡å¯ Docker</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo docker-compose restart <span class=o>[</span>æŒ‡å®šæœåŠ¡çš„å®¹å™¨<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p>å®Œæˆè¿™ä¸€æ­¥ä¹‹åï¼Œå°è¯•ç”¨ IP è®¿é—®ç«™ç‚¹å§</p><p>åœ¨æµè§ˆå™¨è¾“å…¥ <code>http://&lt;ip>:&lt;port></code>ï¼ˆIP å¯ä»¥ç”¨ <code>curl ip.sb</code> è¿”å›ï¼‰</p><p>ï¼ˆï¼›</p><p>è¿˜æœ‰ä¸¤ä¸ªä»»åŠ¡</p><ul><li>SSL è¯ä¹¦</li><li>åå‘ä»£ç†</li></ul><h3 id=nginx>Nginx</h3><h4 id=å®‰è£…-nginx>å®‰è£… Nginx</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt update
</span></span><span class=line><span class=cl>sudo apt install nginx
</span></span></code></pre></td></tr></table></div></div><p>è°ƒæ•´é˜²ç«å¢™ï¼Œå…è®¸ Nginx æœåŠ¡é€šè¿‡</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ufw allow <span class=s1>&#39;Nginx HTTP&#39;</span>
</span></span><span class=line><span class=cl>sudo ufw allow <span class=s1>&#39;Nginx HTTPS&#39;</span>
</span></span><span class=line><span class=cl>sudo ufw allow <span class=s1>&#39;Nginx FULL&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>æŸ¥çœ‹æ›´æ”¹ç»“æœ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ufw status
</span></span></code></pre></td></tr></table></div></div><p>æŸ¥çœ‹ Nginx çŠ¶æ€ï¼ˆæ˜¯ active å°±è¡Œï¼‰</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl status nginx
</span></span></code></pre></td></tr></table></div></div><p>åœ¨æµè§ˆå™¨è¾“å…¥ http://your_vps_ipï¼Œè¿”å› Nginx é»˜è®¤é¡µé¢</p><p>è®© Nginx åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> nginx
</span></span></code></pre></td></tr></table></div></div><h4 id=è®¾ç½®æœåŠ¡å™¨å—>è®¾ç½®æœåŠ¡å™¨å—</h4><p>åˆ›å»ºç«™ç‚¹å¯¹åº”ç›®å½•</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo mkdir -p /var/www/ponderduck.cc/html
</span></span></code></pre></td></tr></table></div></div><p>ä½¿ç”¨<code>$USER</code>ç¯å¢ƒå˜é‡åˆ†é…ç›®å½•çš„æ‰€æœ‰æƒ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo chown -R $USER:$USER /var/www/ponderduck.cc/html
</span></span></code></pre></td></tr></table></div></div><p>å¦‚æœæˆ‘ä»¬æ²¡æœ‰ä¿®æ”¹è‡ªå·±çš„<code>umask</code>å€¼ï¼Œé‚£ä¹ˆ Web æ ¹ç›®å½•çš„æƒé™åº”è¯¥æ­£ç¡®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¾“å…¥ä»¥ä¸‹å‘½ä»¤æ¥ç¡®è®¤ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo chmod -R <span class=m>755</span> /var/www/ponderduck.cc
</span></span></code></pre></td></tr></table></div></div><p>ç¼–è¾‘<code>index.html</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vim /var/www/ponderduck.cc/html/index.html
</span></span></code></pre></td></tr></table></div></div><p>æ·»åŠ ä»¥ä¸‹ç¤ºä¾‹HTML</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>Welcome to ponderduck.cc!<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>Success!  The ponderduck.cc server block is working!<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¸º Nginx åˆ›å»ºä¸€ä¸ªæœåŠ¡å™¨å—</p><p>åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vim /etc/nginx/sites-available/ponderduck.conf
</span></span></code></pre></td></tr></table></div></div><p>æ·»åŠ ä»¥ä¸‹å†…å®¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>server <span class=o>{</span>
</span></span><span class=line><span class=cl>        listen 80<span class=p>;</span>
</span></span><span class=line><span class=cl>        listen <span class=o>[</span>::<span class=o>]</span>:80<span class=p>;</span>
</span></span><span class=line><span class=cl>        root /var/www/ponderduck.cc/html<span class=p>;</span>
</span></span><span class=line><span class=cl>        index index.html index.htm index.nginx-debian.html<span class=p>;</span>
</span></span><span class=line><span class=cl>        server_name ponderduck.cc www.ponderduck.cc<span class=p>;</span>
</span></span><span class=line><span class=cl>        location / <span class=o>{</span>
</span></span><span class=line><span class=cl>                try_files <span class=nv>$uri</span> <span class=nv>$uri</span>/ <span class=o>=</span>404<span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>é€šè¿‡ ls å‘½ä»¤åœ¨<code>sites-enabled</code>ç›®å½•æ–°å»ºä¸€ä¸ªé“¾æ¥ï¼Œå¥½è®© Nginx åœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ä¼šè¯»å–è¿™ä¸ªç›®å½•ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ln -s /etc/nginx/sites-available/ponderduck.conf /etc/nginx/sites-enabled/
</span></span></code></pre></td></tr></table></div></div><p>æ‰“å¼€æ–‡ä»¶ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vim /etc/nginx/nginx.conf
</span></span></code></pre></td></tr></table></div></div><p>æ‰¾åˆ°<code>server_names_hash_bucket_size</code>æŒ‡ä»¤å¹¶åˆ é™¤<code>#</code>ç¬¦å·ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>http <span class=o>{</span>
</span></span><span class=line><span class=cl>    ...
</span></span><span class=line><span class=cl>    server_names_hash_bucket_size 64<span class=p>;</span>
</span></span><span class=line><span class=cl>    ...
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>...
</span></span></code></pre></td></tr></table></div></div><p>æ¥ä¸‹æ¥ï¼Œæµ‹è¯•ä»¥ç¡®ä¿æˆ‘ä»¬åœ¨ Nginx æ–‡ä»¶ä¸­çš„æ”¹åŠ¨ï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nginx -t
</span></span></code></pre></td></tr></table></div></div><p>å¦‚æœæ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·é‡æ–°å¯åŠ¨ Nginxï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl restart nginx
</span></span></code></pre></td></tr></table></div></div><p>ç°åœ¨é€šè¿‡ <a class=link href=http://ponderduck.cc target=_blank rel=noopener>http://ponderduck.cc</a> è®¿é—®æœåŠ¡å™¨çš„æ—¶å€™ï¼ŒNginx ä¼šæŒ‡å‘æˆ‘ä»¬åˆšåˆšæ·»åŠ çš„é‚£ä¸ª HTML é¡µé¢</p><h4 id=ssl>SSL</h4><h5 id=å®‰è£…-certbot>å®‰è£… Certbot</h5><p>æˆ‘ä»¬éœ€è¦è·å¾—è¢«ä¿¡ä»»çš„è¯ä¹¦æˆæƒä¸­å¿ƒï¼ˆ CA ï¼‰ç­¾å‘çš„å®‰å…¨è¯ä¹¦ã€‚Letâ€™s Encrypt æ˜¯ ISRG ï¼ˆ Internet Security Research Group ï¼Œäº’è”ç½‘å®‰å…¨ç ”ç©¶å°ç»„ï¼‰çš„ç»„ç»‡æ¨å‡ºçš„å…è´¹å®‰å…¨è¯ä¹¦è®¡åˆ’ã€‚</p><p>ISRG çš„å‘èµ·è€… EFF ï¼ˆç”µå­å‰å“¨åŸºé‡‘ä¼šï¼‰ä¸º Letâ€™s Encrypt é¡¹ç›®å‘å¸ƒäº†ä¸€ä¸ªå®˜æ–¹çš„å®¢æˆ·ç«¯ Certbot ï¼Œåˆ©ç”¨å®ƒå¯ä»¥å®Œå…¨è‡ªåŠ¨åŒ–çš„è·å–ã€éƒ¨ç½²å’Œæ›´æ–°å®‰å…¨è¯ä¹¦</p><p>å®‰è£… Certbot</p><p>å» <a class=link href=https://certbot.eff.org/ target=_blank rel=noopener>å®˜ç½‘</a> é€‰æ‹©æˆ‘æ­£åœ¨ä½¿ç”¨çš„ Web æœåŠ¡å™¨ï¼ˆNginxï¼‰å’Œæ“ä½œç³»ç»Ÿï¼ˆUbuntu 20ï¼‰ï¼Œæ“ä½œå¯¹åº”çš„å®‰è£…æ­¥éª¤</p><p>Ubuntu è‡ªå¸¦ Snapï¼Œç”¨ Snap å®‰è£… Certbot</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo snap install --classic certbot
</span></span></code></pre></td></tr></table></div></div><p>ç”¨ ln å‘½ä»¤åˆ›å»ºç¬¦å·è¿æ¥ï¼Œå°† Certbot åŠ å…¥ PATH ç¯å¢ƒå˜é‡ä¸­</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo ln -s /snap/bin/certbot /usr/bin/certbot
</span></span></code></pre></td></tr></table></div></div><h5 id=ç”Ÿæˆ-ssl-è¯ä¹¦>ç”Ÿæˆ SSL è¯ä¹¦</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo certbot --nginx -d www.ponderduck.cc
</span></span></code></pre></td></tr></table></div></div><p>è¾“å…¥é‚®ç®±åœ°å€ï¼Œç”¨äºæ¥æ”¶é‚®ä»¶</p><p>è¾“å…¥ <code>Y</code>ï¼ŒåŒæ„åè®®ï¼›è¯¢é—®æ˜¯å¦æ¥æ”¶å‰å“¨åŸºé‡‘ä¼šçš„é‚®ä»¶ï¼Œæ¥ä¸æ¥æ”¶éƒ½è¡Œ</p><p>è¿”å›ï¼ˆæ³¨æ„è¯ä¹¦å‚¨å­˜ä½ç½®ï¼‰</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Successfully received certificate.
</span></span><span class=line><span class=cl>Certificate is saved at: /etc/letsencrypt/live/www.ponderduck.cc/fullchain.pem
</span></span><span class=line><span class=cl>Key is saved at:         /etc/letsencrypt/live/www.ponderduck.cc/privkey.pem
</span></span><span class=line><span class=cl>This certificate expires on 2023-02-18.
</span></span><span class=line><span class=cl>These files will be updated when the certificate renews.
</span></span><span class=line><span class=cl>Certbot has set up a scheduled task to automatically renew this certificate in the background.
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s Encrypt çš„ SSL è¯ä¹¦ä¼šåœ¨ 90 å¤©åè¿‡æœŸï¼Œä½†æ˜¯ Certbot ä¼šè‡ªåŠ¨ç»­è®¢</p><p>æµ‹è¯•è¯ä¹¦è‡ªåŠ¨ç»­è®¢æ˜¯å¦ç”Ÿæ•ˆ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo certbot renew --dry-run
</span></span></code></pre></td></tr></table></div></div><p>è¿”å›â¬‡ï¸è¯´æ˜å·²ç”Ÿæ•ˆ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Simulating renewal of an existing certificate for www.ponderduck.cc
</span></span></code></pre></td></tr></table></div></div><p>æ‰¾åˆ°å­˜æ”¾ç«™ç‚¹è¯ä¹¦çš„ç›®å½•</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo ls /etc/letsencrypt/live
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘çš„æ˜¯<code>www.ponderduck.cc</code></p><p>æŸ¥è¯¢è¯ä¹¦</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo ls /etc/letsencrypt/live/www.ponderduck.cc
</span></span></code></pre></td></tr></table></div></div><p>è¿”å›æ–‡ä»¶å</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cert.pem  chain.pem  fullchain.pem  privkey.pem  
</span></span></code></pre></td></tr></table></div></div><p>åä¸¤ä¸ªè¦æ·»åŠ åˆ° Nginx é…ç½®æ–‡ä»¶ <code>.conf</code> é‡Œ</p><h4 id=åå‘ä»£ç†>åå‘ä»£ç†</h4><p>ä¿®æ”¹ç½‘ç«™é…ç½®æ–‡ä»¶</p><p>å‚è€ƒ <a class=link href=https://misskey-hub.net/en/docs/admin/nginx.html target=_blank rel=noopener>å®˜ç½‘æ–‡æ¡£</a>ï¼Œä»¥ä¸‹æ˜¯æˆ‘çš„å®Œæ•´æ–‡ä»¶å†…å®¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># For WebSocket
</span></span><span class=line><span class=cl>map $http_upgrade $connection_upgrade {
</span></span><span class=line><span class=cl>    default upgrade;
</span></span><span class=line><span class=cl>    &#39;&#39;      close;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>proxy_cache_path /tmp/nginx_cache levels=1:2 keys_zone=cache1:16m max_size=1g inactive=720m use_temp_path=off;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>server {
</span></span><span class=line><span class=cl>       listen 80;
</span></span><span class=line><span class=cl>       listen [::]:80;
</span></span><span class=line><span class=cl>       server_name www.ponderduck.cc ponderduck.cc;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       # For SSL domain validation
</span></span><span class=line><span class=cl>       root /var/www/html;
</span></span><span class=line><span class=cl>       location /.well-known/acme-challenge/ { allow all; }
</span></span><span class=line><span class=cl>       location /.well-known/pki-validation/ { allow all; }
</span></span><span class=line><span class=cl>       location / { return 301 https://$server_name$request_uri; }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>server {
</span></span><span class=line><span class=cl>        listen [::]:443 ssl http2;
</span></span><span class=line><span class=cl>        listen 443 ssl http2; 
</span></span><span class=line><span class=cl>        server_name ponderduck.cc www.ponderduck.cc;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        ssl_session_cache shared:ssl_session_cache:10m;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        # ssl
</span></span><span class=line><span class=cl>        ssl_certificate /etc/letsencrypt/live/www.ponderduck.cc/fullchain.pem;
</span></span><span class=line><span class=cl>        ssl_certificate_key /etc/letsencrypt/live/www.ponderduck.cc/privkey.pem; 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        include /etc/letsencrypt/options-ssl-nginx.conf;
</span></span><span class=line><span class=cl>        ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; 
</span></span><span class=line><span class=cl>        ssl_stapling on;
</span></span><span class=line><span class=cl>        ssl_stapling_verify on;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        # Change to your upload limit
</span></span><span class=line><span class=cl>        client_max_body_size 80m;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        # å¯¹&#34;/&#34;å¯ç”¨åå‘ä»£ç†
</span></span><span class=line><span class=cl>        location / {
</span></span><span class=line><span class=cl>                # æŒ‡å®šè½¬å‘åœ°å€
</span></span><span class=line><span class=cl>                proxy_pass http://127.0.0.1:3001;
</span></span><span class=line><span class=cl>                proxy_set_header Host $host;
</span></span><span class=line><span class=cl>                proxy_http_version 1.1;
</span></span><span class=line><span class=cl>                proxy_redirect off;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                proxy_set_header   Upgrade             $http_upgrade;
</span></span><span class=line><span class=cl>                proxy_set_header   Connection          $connection_upgrade;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                proxy_cache cache1;
</span></span><span class=line><span class=cl>                proxy_cache_lock on;
</span></span><span class=line><span class=cl>                proxy_cache_use_stale updating;
</span></span><span class=line><span class=cl>                add_header X-Cache $upstream_cache_status;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>æ¥ä¸‹æ¥ï¼Œæµ‹è¯•ä»¥ç¡®ä¿æˆ‘ä»¬åœ¨ Nginx æ–‡ä»¶ä¸­çš„æ”¹åŠ¨ï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nginx -t
</span></span></code></pre></td></tr></table></div></div><p>æœ‰é—®é¢˜çš„è¯æŒ‰ç…§æç¤ºä¿®æ”¹ï¼Œåšå®Œä¹‹åï¼Œé‡æ–°å¯åŠ¨ Nginxï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl restart nginx
</span></span></code></pre></td></tr></table></div></div><p>ç°åœ¨ SSL è¯ä¹¦å’Œåå‘ä»£ç†éƒ½ç”Ÿæ•ˆäº†ï¼Œå°è¯•ç”¨åŸŸåè®¿é—®ç«™ç‚¹</p><p>å®ŒæˆğŸ‰</p><p>æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œå›åˆ°å‘½ä»¤è¡Œå·¥å…·æŠŠå®ƒè®¾ç½®ä¸ºç®¡ç†å‘˜</p><h2 id=æ—¥å¸¸ç»´æŠ¤>æ—¥å¸¸ç»´æŠ¤</h2><h3 id=æ›´æ–°>æ›´æ–°</h3><p>Docker-compose éƒ¨ç½²</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> data/docker_data/misskey
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>docker-compose down 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cp -r /root/data/docker_data/misskey /root/data/docker_data/misskey.archive  <span class=c1># ä¸‡äº‹å…ˆå¤‡ä»½ï¼Œä»¥é˜²ä¸‡ä¸€ï¼Œå…¶å®è¿™è¾¹æ²¡å¿…è¦ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰æ˜ å°„åˆ°æœ¬åœ°æ–‡ä»¶å¤¹</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>docker-compose pull
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>docker-compose up -d    <span class=c1># è¯·ä¸è¦ä½¿ç”¨docker-compose stopæ¥åœæ­¢å®¹å™¨ï¼Œå› ä¸ºè¿™ä¹ˆåšéœ€è¦é¢å¤–çš„æ—¶é—´ç­‰å¾…å®¹å™¨åœæ­¢ï¼›docker-compose up -dç›´æ¥å‡çº§å®¹å™¨æ—¶ä¼šè‡ªåŠ¨åœæ­¢å¹¶ç«‹åˆ»é‡å»ºæ–°çš„å®¹å™¨ï¼Œå®Œå…¨æ²¡æœ‰å¿…è¦æµªè´¹é‚£äº›æ—¶é—´ã€‚</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>docker image prune  <span class=c1># prune å‘½ä»¤ç”¨æ¥åˆ é™¤ä¸å†ä½¿ç”¨çš„ docker å¯¹è±¡ã€‚åˆ é™¤æ‰€æœ‰æœªè¢« tag æ ‡è®°å’Œæœªè¢«å®¹å™¨ä½¿ç”¨çš„é•œåƒ</span>
</span></span></code></pre></td></tr></table></div></div><p>æç¤ºï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>WARNING! This will remove all dangling images.
</span></span><span class=line><span class=cl>Are you sure you want to continue? [y/N] 
</span></span></code></pre></td></tr></table></div></div><p>è¾“å…¥ <code>y</code></p><h3 id=å¸è½½>å¸è½½</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cd /root/data/docker_data/misskey
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>docker-compose down 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>rm -rf /root/data/docker_data/misskey  # å®Œå…¨åˆ é™¤æ˜ å°„åˆ°æœ¬åœ°çš„æ•°æ®
</span></span></code></pre></td></tr></table></div></div><h3 id=åˆ é™¤æ—§æ•°æ®>åˆ é™¤æ—§æ•°æ®</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>docker system prune
</span></span></code></pre></td></tr></table></div></div><h3 id=ç£ç›˜ç©ºé—´åˆ†æåŠæ¸…ç†>ç£ç›˜ç©ºé—´åˆ†æåŠæ¸…ç†</h3><p>å†…å®¹ä¸»è¦æ¥æºï¼šhttps://www.cnblogs.com/jing99/p/10487174.html</p><p>æœ‰æ—¶å€™è¦ç”¨ <code>sudo</code></p><h4 id=df-å‘½ä»¤>df å‘½ä»¤</h4><p>å¯ä»¥æŸ¥çœ‹ä¸€çº§æ–‡ä»¶å¤¹å¤§å°ã€ä½¿ç”¨æ¯”ä¾‹ã€æ¡£æ¡ˆç³»ç»Ÿå’ŒæŒ‚å…¥dian</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[root@oms ~]# df -Th
</span></span><span class=line><span class=cl>Filesystem     Type      Size  Used Avail Use% Mounted on
</span></span><span class=line><span class=cl>/dev/vda1      ext4       40G   35G  3.1G  92% /
</span></span><span class=line><span class=cl>devtmpfs       devtmpfs  1.9G     0  1.9G   0% /dev
</span></span><span class=line><span class=cl>tmpfs          tmpfs     1.9G     0  1.9G   0% /dev/shm
</span></span><span class=line><span class=cl>tmpfs          tmpfs     1.9G  191M  1.7G  11% /run
</span></span><span class=line><span class=cl>tmpfs          tmpfs     1.9G     0  1.9G   0% /sys/fs/cgroup
</span></span><span class=line><span class=cl>tmpfs          tmpfs     379M     0  379M   0% /run/user/0
</span></span></code></pre></td></tr></table></div></div><p>ä¸ƒä¸ªå­—æ®µåˆ†åˆ«ä¸ºæ¡£æ¡ˆç³»ç»Ÿã€ç±»å‹ã€è¯¥åˆ†å‰²åŒºçš„å®¹é‡ã€å·²ä½¿ç”¨çš„å¤§å°ã€å‰©ä¸‹çš„å¤§å°ã€ä½¿ç”¨çš„ç™¾åˆ†æ¯”å’ŒæŒ‚å…¥ç‚¹</p><h4 id=duå‘½ä»¤>duå‘½ä»¤</h4><p>ç”¨æ¥æŸ¥çœ‹ç›®å½•æˆ–æ–‡ä»¶æ‰€å ç”¨ç£ç›˜ç©ºé—´çš„å¤§å°ã€‚å¸¸ç”¨é€‰é¡¹ç»„åˆä¸ºï¼š<code>du -sh [ç›®å½•]</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>du -s ç›®å½• | sort -rn        #è¿™æ˜¯æŒ‰å­—èŠ‚æ’åº
</span></span><span class=line><span class=cl>du -sh ç›®å½• | sort -rn        #è¿™æ˜¯æŒ‰å…†ï¼ˆMï¼‰æ¥æ’åº
</span></span><span class=line><span class=cl>#ç”±äº-shå¤§å°æ˜¾ç¤ºçœ‹èµ·æ¥æ˜¯ä¹±çš„ï¼Œå› æ­¤å»ºè®®ä½¿ç”¨du -s|sort -nr
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>du -s ç›®å½• | sort -rn | head        #é€‰å‡ºæ’åœ¨å‰é¢çš„10ä¸ª
</span></span><span class=line><span class=cl>du -s ç›®å½• | sort -rn | tail        #é€‰å‡ºæ’åœ¨åé¢çš„10ä¸ª
</span></span></code></pre></td></tr></table></div></div><p>å¸¸ç”¨é€‰é¡¹</p><blockquote><p>-hï¼šä»¥äººç±»å¯è¯»çš„æ–¹å¼æ˜¾ç¤º</p><p>-aï¼šæ˜¾ç¤ºç›®å½•å ç”¨çš„ç£ç›˜ç©ºé—´å¤§å°ï¼Œè¿˜è¦æ˜¾ç¤ºå…¶ä¸‹ç›®å½•å’Œæ–‡ä»¶å ç”¨ç£ç›˜ç©ºé—´çš„å¤§å°</p><p>-sï¼šåªæ˜¾ç¤º<strong>ç›®å½•å ç”¨çš„ç£ç›˜ç©ºé—´</strong>å¤§å°ï¼Œä¸æ˜¾ç¤ºå…¶å­ç›®å½•å’Œæ–‡ä»¶å ç”¨çš„ç£ç›˜ç©ºé—´å¤§å°</p><p>-cï¼šæ˜¾ç¤ºå‡ ä¸ª<strong>ç›®å½•æˆ–æ–‡ä»¶å ç”¨çš„ç£ç›˜</strong>ç©ºé—´å¤§å°ï¼Œè¿˜è¦ç»Ÿè®¡å®ƒä»¬çš„æ€»å’Œ</p><p>&ndash;apparent-sizeï¼šæ˜¾ç¤ºç›®å½•æˆ–æ–‡ä»¶è‡ªèº«çš„å¤§å°(æ–‡ä»¶æˆ–ç›®å½•å ç”¨ç£ç›˜ç©ºé—´çš„å¤§å°ä¸å®ƒä»¬è‡ªèº«å¤§å°æœ‰æ—¶å€™å¹¶éå®Œå…¨ä¸€è‡´)</p><p>-l ï¼šç»Ÿè®¡ç¡¬é“¾æ¥å ç”¨ç£ç›˜ç©ºé—´çš„å¤§å°</p><p>-Lï¼šç»Ÿè®¡ç¬¦å·é“¾æ¥æ‰€æŒ‡å‘çš„æ–‡ä»¶å ç”¨çš„ç£ç›˜ç©ºé—´å¤§å°ã€‚</p></blockquote><h4 id=rm-å‘½ä»¤>rm å‘½ä»¤</h4><p>æ…ç”¨</p><p>ä»¥ä¸‹å¾…åšï¼š</p><p><a class=link href=https://fediverse.eu.org/discussion/15/%E7%BB%99%E6%96%B0%E7%AB%99%E9%95%BF-%E5%BB%BA%E7%AB%99%E5%90%8E%E5%8F%AF%E5%8F%82%E8%80%83%E7%9A%84%E8%BF%90%E7%BB%B4%E5%8F%8A%E8%A3%85%E4%BF%AE%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C#latest target=_blank rel=noopener>https://fediverse.eu.org/discussion/15/%E7%BB%99%E6%96%B0%E7%AB%99%E9%95%BF-%E5%BB%BA%E7%AB%99%E5%90%8E%E5%8F%AF%E5%8F%82%E8%80%83%E7%9A%84%E8%BF%90%E7%BB%B4%E5%8F%8A%E8%A3%85%E4%BF%AE%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C#latest</a></p><p><a class=link href=https://pullopen.github.io/tags/#Mastodon target=_blank rel=noopener>https://pullopen.github.io/tags/#Mastodon</a></p><ul><li>æ‰«æå‡ºä¸å±äºä»»ä½•åª’ä½“é™„ä»¶çš„æ–‡ä»¶å¹¶ç§»é™¤ä»–ä»¬</li><li>æ¸…é™¤ç¼“å­˜å­˜å‚¨</li><li>ä»æ•°æ®åº“ä¸­åˆ é™¤æœªè¢«å¼•ç”¨çš„å˜Ÿæ–‡ï¼Œä¾‹å¦‚æ¥è‡ªä¸­ç»§çš„æˆ–æ¥è‡ªæœ¬åœ°ç”¨æˆ·ä¸å†å…³æ³¨çš„ç”¨æˆ·çš„å˜Ÿæ–‡ï¼ŒåŒæ—¶æ²¡æœ‰è¢«å›å¤çš„æˆ–ä»¥å…¶ä»–æ–¹å¼ä¸ä¹‹äº’åŠ¨çš„</li></ul><h3 id=å¸¸ç”¨å‘½ä»¤>å¸¸ç”¨å‘½ä»¤</h3><p>æŸ¥çœ‹ docker å®¹å™¨çŠ¶æ€</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo docker container stats
</span></span></code></pre></td></tr></table></div></div><h2 id=å…¶å®ƒå‚è€ƒ>å…¶å®ƒå‚è€ƒ</h2><p><a class=link href=https://blog.laoda.de/archives/getting-started-with-linux target=_blank rel=noopener>mjjç‰ˆçš„linuxå…¥é—¨æ•™ç¨‹</a></p><p><a class=link href=https://weirenxue.github.io/2021/06/17/user_linux_sudo/ target=_blank rel=noopener>[User] Linux æ–°å¢ä½¿ç”¨è€…ä¸¦è³¦äºˆå…¶ä½¿ç”¨ sudo çš„æ¬Šé™</a></p><p><a class=link href=https://blog.laoda.de/archives/how-to-secure-a-linux-server target=_blank rel=noopener>ä¿æŠ¤å¥½ä½ çš„å°é¸¡ï¼ä¿å§†çº§æœåŠ¡å™¨å®‰å…¨æ•™ç¨‹ï¼</a></p><p><a class=link href=https://blog.laoda.de/archives/docker-compose-install-misskey#5.3-%E5%AE%89%E8%A3%85nginxproxymanager target=_blank rel=noopener>ã€å¥½ç©å„¿çš„Dockeré¡¹ç›®ã€‘10åˆ†é’Ÿæ­å»ºä¸€ä¸ªå»ä¸­å¿ƒåŒ–å¾®åšå¹³å°â€”â€”Misskey ï½œäºŒæ¬¡å…ƒé£æ ¼ã€è”é‚¦å®‡å®™</a></p><p><a class=link href=https://candinya.com/posts/minimal-misskey-docker-deploy/ target=_blank rel=noopener>ä½¿ç”¨Dockeræœ€å°åŒ–éƒ¨ç½²Misskey</a></p><p><a class=link href=https://eri.cx/build-your-own-decentralized-social-platform-misskey/ target=_blank rel=noopener>æ­å»ºå±äºè‡ªå·±çš„å»ä¸­å¿ƒåŒ–ç¤¾äº¤å¹³å° Misskey</a></p><p><a class=link href=https://kalacloud.com/blog/how-to-install-nginx-on-ubuntu-20-04/#%E7%AC%AC5%E6%AD%A5%E8%AE%BE%E7%BD%AE%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9D%97server-block target=_blank rel=noopener>å¦‚ä½•åœ¨ Ubuntu 20.04 ä¸­å®‰è£…å’Œé…ç½® Nginx</a></p><p><a class=link href=https://zxuqian.cn/install-nginx-on-ubuntu-20-04/ target=_blank rel=noopener>Nginx æ•™ç¨‹ï¼šå¦‚ä½•åœ¨ Ubuntu 20.04 ä¸‹å®‰è£…å¹¶é…ç½® Nginx</a></p><p><a class=link href=https://www.myfreax.com/secure-nginx-with-let-s-encrypt-on-ubuntu-20-04/ target=_blank rel=noopener>å¦‚ä½•åœ¨Ubuntu 20.04 Nginxé…ç½®Let&rsquo;s Encrypt SSLè¯ä¹¦</a></p></section><footer class=article-footer><section class=article-tags><a href=/tags/tutorial/>tutorial</a>
<a href=/tags/miskey/>miskey</a></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css integrity="sha256-J+iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js integrity="sha256-InsNdER1b2xUewP+pKCUJpkhiqwHgqiPXDlIk7GzBu4=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI=" crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/2023/operation-and-maintenance-pleroma/><div class=article-details><h2 class=article-title>Pleroma | ç»´æŠ¤æ—¥å¿—</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//bizarreadventure.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2021 -
2023 Rubber Duck's Bizarre Adventure</section><section class=powerby>CC BY-NC-SA 4.0<br>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.14.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#è´­ä¹°-vps>è´­ä¹° VPS</a><ol><li><a href=#æ³¨å†Œ>æ³¨å†Œ</a></li><li><a href=#åˆ›å»º-vps>åˆ›å»º VPS</a></li><li><a href=#æ£€æŸ¥-ip>æ£€æŸ¥ IP</a></li></ol></li><li><a href=#åŸŸå>åŸŸå</a><ol><li><a href=#è§£æåŸŸå>è§£æåŸŸå</a></li></ol></li><li><a href=#æœåŠ¡å™¨åŸºç¡€é…ç½®>æœåŠ¡å™¨åŸºç¡€é…ç½®</a><ol><li><a href=#è¿œç¨‹è¿æ¥>è¿œç¨‹è¿æ¥</a></li><li><a href=#å®‰å…¨è®¾ç½®>å®‰å…¨è®¾ç½®</a><ol><li><a href=#æ–°å»ºæ™®é€šç”¨æˆ·å¹¶è®¾å®šå¯†ç >æ–°å»ºæ™®é€šç”¨æˆ·å¹¶è®¾å®šå¯†ç </a></li><li><a href=#èµ‹äºˆ-vpsadmin-ä½¿ç”¨-sudo-æŒ‡ä»¤çš„æƒé™>èµ‹äºˆ ã€Œvpsadminã€ ä½¿ç”¨ sudo æŒ‡ä»¤çš„æƒé™</a></li><li><a href=#å¯é€‰sshå…å¯†ç™»å½•>[å¯é€‰]SSHå…å¯†ç™»å½•</a></li><li><a href=#ç¦æ­¢-root-ç™»å½•>ç¦æ­¢ root ç™»å½•</a></li></ol></li><li><a href=#æ­å»ºç¯å¢ƒ>æ­å»ºç¯å¢ƒ</a><ol><li><a href=#ä¿®æ”¹æœåŠ¡å™¨æ—¶é—´>ä¿®æ”¹æœåŠ¡å™¨æ—¶é—´</a></li><li><a href=#å®‰è£…å¸¸ç”¨å‘½ä»¤>å®‰è£…å¸¸ç”¨å‘½ä»¤</a></li><li><a href=#æ·»åŠ -swap>æ·»åŠ  SWAP</a></li><li><a href=#é…ç½®é˜²ç«å¢™>é…ç½®é˜²ç«å¢™</a></li><li><a href=#å®‰è£…-docker-å’Œ-docker-compose>å®‰è£… Docker å’Œ Docker Compose</a></li></ol></li></ol></li><li><a href=#misskey>Misskey</a><ol><li><a href=#åˆ›å»ºå®‰è£…ç›®å½•>åˆ›å»ºå®‰è£…ç›®å½•</a></li><li><a href=#é…ç½®å®‰è£…æ–‡ä»¶>é…ç½®å®‰è£…æ–‡ä»¶</a></li><li><a href=#éƒ¨ç½²>éƒ¨ç½²</a></li><li><a href=#è®¿é—®ç«™ç‚¹>è®¿é—®ç«™ç‚¹</a></li><li><a href=#nginx>Nginx</a><ol><li><a href=#å®‰è£…-nginx>å®‰è£… Nginx</a></li><li><a href=#è®¾ç½®æœåŠ¡å™¨å—>è®¾ç½®æœåŠ¡å™¨å—</a></li><li><a href=#ssl>SSL</a></li><li><a href=#åå‘ä»£ç†>åå‘ä»£ç†</a></li></ol></li></ol></li><li><a href=#æ—¥å¸¸ç»´æŠ¤>æ—¥å¸¸ç»´æŠ¤</a><ol><li><a href=#æ›´æ–°>æ›´æ–°</a></li><li><a href=#å¸è½½>å¸è½½</a></li><li><a href=#åˆ é™¤æ—§æ•°æ®>åˆ é™¤æ—§æ•°æ®</a></li><li><a href=#ç£ç›˜ç©ºé—´åˆ†æåŠæ¸…ç†>ç£ç›˜ç©ºé—´åˆ†æåŠæ¸…ç†</a><ol><li><a href=#df-å‘½ä»¤>df å‘½ä»¤</a></li><li><a href=#duå‘½ä»¤>duå‘½ä»¤</a></li><li><a href=#rm-å‘½ä»¤>rm å‘½ä»¤</a></li></ol></li><li><a href=#å¸¸ç”¨å‘½ä»¤>å¸¸ç”¨å‘½ä»¤</a></li></ol></li><li><a href=#å…¶å®ƒå‚è€ƒ>å…¶å®ƒå‚è€ƒ</a></li></ol></nav></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>
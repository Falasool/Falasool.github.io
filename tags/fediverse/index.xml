<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>fediverse on Rubber Duck's Bizarre Adventure</title><link>https://falasool.github.io/tags/fediverse/</link><description>Recent content in fediverse on Rubber Duck's Bizarre Adventure</description><generator>Hugo -- gohugo.io</generator><lastBuildDate>Sat, 03 Jun 2023 01:29:15 +0800</lastBuildDate><atom:link href="https://falasool.github.io/tags/fediverse/index.xml" rel="self" type="application/rss+xml"/><item><title>Pleroma | åœ¨ Debian ä¸Šæ­å»º pleroma å®ä¾‹</title><link>https://falasool.github.io/2023/new-pleroma-isntance-on-debian11/</link><pubDate>Sat, 03 Jun 2023 01:29:15 +0800</pubDate><guid>https://falasool.github.io/2023/new-pleroma-isntance-on-debian11/</guid><description>&lt;!-- raw HTML omitted -->
&lt;h2 id="å‰ç½®æ­¥éª¤">å‰ç½®æ­¥éª¤&lt;/h2>
&lt;h3 id="å®‰è£…ä¾èµ–">å®‰è£…ä¾èµ–&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ›´æ–°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apt-get update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å®‰è£…ä¾èµ–&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apt install unzip libncurses5 postgresql postgresql-contrib nginx snapd libmagic-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apt install imagemagick ffmpeg libimage-exiftool-perl
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="postgresql-æ€§èƒ½è°ƒä¼˜">&lt;del>PostgreSQL æ€§èƒ½è°ƒä¼˜&lt;/del>&lt;/h3>
&lt;p>&lt;del>æ ¹æ® pgTune ä¿®æ”¹é…ç½®æ–‡ä»¶&lt;/del>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vim /etc/postgresql/13/main/postgresql.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘æŠŠ .conf æ”¹å¾—å‡ºé”™äº†ï¼Œæ‰€ä»¥è¿™ä¸€æ­¥æ²¡åš&lt;/p>
&lt;p>é‡å¯ PostgreSQL&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl restart postgresql
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å®‰è£…-pleroma">å®‰è£… Pleroma&lt;/h2>
&lt;ol>
&lt;li>åˆ›å»º Pleroma ç”¨æˆ·&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">adduser --system --shell /bin/false --home /opt/pleroma pleroma
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åˆ›å»º pleroma ç”¨æˆ·ï¼ŒæŒ‡å®šå®¶ç›®å½•ä¸º &lt;code>/opt/pleroma&lt;/code>ï¼Œç”¨äºé…ç½® pleroma çš„ç¯å¢ƒå’Œæ–‡ä»¶ï¼Œå¹¶ç¦æ­¢ç™»å½•&lt;/p>
&lt;ol start="2">
&lt;li>æ£€æµ‹ç³»ç»Ÿæ¶æ„ä¸ libc ç‰ˆæœ¬ï¼Œå¹¶æ ¹æ®ç»“æœè®¾ç½®ç¯å¢ƒå˜é‡ FLAVOUR&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">arch&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>uname -m&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$arch&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;x86_64&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">then&lt;/span> &lt;span class="nv">arch&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;amd64&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">elif&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$arch&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;armv7l&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">then&lt;/span> &lt;span class="nv">arch&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;arm&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">elif&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$arch&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;aarch64&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">then&lt;/span> &lt;span class="nv">arch&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;arm64&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">else&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;Unsupported arch: &lt;/span>&lt;span class="nv">$arch&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>2&lt;span class="p">;&lt;/span>&lt;span class="k">fi&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">if&lt;/span> getconf GNU_LIBC_VERSION&amp;gt;/dev/null&lt;span class="p">;&lt;/span>&lt;span class="k">then&lt;/span> &lt;span class="nv">libc_postfix&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">elif&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>ldd 2&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>1&lt;span class="p">|&lt;/span>head -c 9&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;musl libc&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">then&lt;/span> &lt;span class="nv">libc_postfix&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;-musl&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">elif&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>find /lib/libc.musl*&lt;span class="p">|&lt;/span>wc -l&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">then&lt;/span> &lt;span class="nv">libc_postfix&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;-musl&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">else&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;Unsupported libc&amp;#34;&lt;/span>&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>2&lt;span class="p">;&lt;/span>&lt;span class="k">fi&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$arch$libc_postfix&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è¾“å‡º&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">amd64
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ‰€ä»¥è®¾ç½®ç¯å¢ƒå˜é‡ä¸º&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">FLAVOUR&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;amd64&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>ä¸‹è½½ pleroma æ–‡ä»¶åˆ° /tmp ç›®å½•å¹¶è§£å‹&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">su pleroma -s &lt;span class="nv">$SHELL&lt;/span> -lc &lt;span class="s2">&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">curl &amp;#39;https://git.pleroma.social/api/v4/projects/2/jobs/artifacts/stable/download?job=&lt;/span>&lt;span class="nv">$FLAVOUR&lt;/span>&lt;span class="s2">&amp;#39; -o /tmp/pleroma.zip
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">unzip /tmp/pleroma.zip -d /tmp/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="4">
&lt;li>ç§»åŠ¨æ–‡ä»¶åˆ° /opt/pleroma å¹¶åˆ é™¤ /tmp&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">su pleroma -s &lt;span class="nv">$SHELL&lt;/span> -lc &lt;span class="s2">&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">mv /tmp/release/* /opt/pleroma
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">rmdir /tmp/release
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">rm /tmp/pleroma.zip
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="5">
&lt;li>åˆ›å»ºå„ç§ç›®å½•åŠèµ‹æƒæ“ä½œ uploads ç›®å½•å¹¶èµ‹æƒ&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># uploads ç›®å½• &amp;amp; èµ‹æƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkdir -p /var/lib/pleroma/uploads
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chown -R pleroma /var/lib/pleroma
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># static ç›®å½• &amp;amp; è®¾ç½®æ‰€æœ‰è€…ä¸º pleroma&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkdir -p /var/lib/pleroma/static
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chown -R pleroma /var/lib/pleroma
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># é…ç½®æ–‡ä»¶ç›®å½• &amp;amp; è®¾ç½®æ‰€æœ‰è€…ä¸º pleroma&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkdir -p /etc/pleroma
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chown -R pleroma /etc/pleroma
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="6">
&lt;li>ç”Ÿæˆé…ç½®æ–‡ä»¶&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">su pleroma -s &lt;span class="nv">$SHELL&lt;/span> -lc &lt;span class="s2">&amp;#34;./bin/pleroma_ctl instance gen --output /etc/pleroma/config.exs --output-psql /tmp/setup_db.psql&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å›ç­”è‹¥å¹²é—®é¢˜&lt;/p>
&lt;ol start="7">
&lt;li>åˆ›å»º postgres æ•°æ®åº“&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl"> su postgres -s &lt;span class="nv">$SHELL&lt;/span> -lc &lt;span class="s2">&amp;#34;psql -f /tmp/setup_db.psql&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="8">
&lt;li>æ›´æ–°æ•°æ®åº“ schema&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">su pleroma -s &lt;span class="nv">$SHELL&lt;/span> -lc &lt;span class="s2">&amp;#34;./bin/pleroma_ctl migrate&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="9">
&lt;li>å¯åŠ¨å®ä¾‹&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">su pleroma -s $SHELL -lc &amp;#34;./bin/pleroma daemon&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="10">
&lt;li>ç­‰å¾…ä¸€ä¼šæ£€æµ‹å®ä¾‹è¿è¡Œæƒ…å†µ&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">curl http://localhost:4000/api/v1/instance
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="10">
&lt;li>æš‚åœå®ä¾‹è¿è¡Œ&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">su pleroma -s $SHELL -lc &amp;#34;./bin/pleroma stop&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="é€šé…ç¬¦-ssl-è¯ä¹¦è‡ªåŠ¨ç»­æœŸ">é€šé…ç¬¦ SSL è¯ä¹¦è‡ªåŠ¨ç»­æœŸ&lt;/h2>
&lt;p>å®‰è£… certbot&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">snap install core
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">snap refresh core
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">snap install --classic certbot
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ln -s /snap/bin/certbot /usr/bin/certbot
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">snap &lt;span class="nb">set&lt;/span> certbot trust-plugin-with-root&lt;span class="o">=&lt;/span>ok
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">snap install certbot-dns-cloudflare
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ”¾ç½®å‡­æ®&lt;/p>
&lt;p>Token åœ¨ &lt;a class="link" href="https://dash.cloudflare.com/profile/api-tokens" target="_blank" rel="noopener"
>https://dash.cloudflare.com/profile/api-tokens&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
ç”Ÿæˆ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo mkdir -p /root/.secrets/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo touch /root/.secrets/cloudflare.ini
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ·»åŠ /.secretsç›®å½•ä¸cloudflare.iniæ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo chmod &lt;span class="m">0700&lt;/span> /root/.secrets/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo chmod &lt;span class="m">0400&lt;/span> /root/.secrets/cloudflare.ini
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŒ‡å®šæƒé™&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vim /root/.secrets/cloudflare.ini
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Cloudflare API token used by Certbot&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dns_cloudflare_api_token&lt;/span> &lt;span class="o">=&lt;/span> 0123456789abcdef0123456789abcdef01234567
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç”³è¯·è¯ä¹¦&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">certbot certonly &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --dns-cloudflare &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --dns-cloudflare-credentials ~/.secrets/cloudflare.ini &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -d example.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -d *.example.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-stylus" data-lang="stylus">&lt;span class="line">&lt;span class="cl">&lt;span class="err">certbot&lt;/span> &lt;span class="err">certonly&lt;/span> &lt;span class="err">\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">--&lt;/span>&lt;span class="err">dns&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="err">cloudflare&lt;/span> &lt;span class="err">\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">--&lt;/span>&lt;span class="err">dns&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="err">cloudflare&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="err">credentials&lt;/span> &lt;span class="o">~/&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nc">secrets&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="err">cloudflare&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nc">ini&lt;/span> &lt;span class="err">\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span>&lt;span class="err">d&lt;/span> &lt;span class="err">ponderduck&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nc">cc&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span>&lt;span class="err">d&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nc">ponderduck&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nc">cc&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æµ‹è¯•è‡ªåŠ¨å»¶æœŸ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">certbot renew --dry-run
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="nginx">Nginx&lt;/h2>
&lt;p>å¤åˆ¶ Pleroma çš„ nginx é…ç½®åˆ° nginx ç›®å½•&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cp /opt/pleroma/installation/pleroma.nginx /etc/nginx/sites-available/pleroma.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ln -s /etc/nginx/sites-available/pleroma.conf /etc/nginx/sites-enabled/pleroma.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç¼–è¾‘ Pleroma çš„ nginx é…ç½®æ–‡ä»¶ï¼Œæ”¹æˆè‡ªå·±çš„åŸŸå&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vim /etc/nginx/sites-available/pleroma.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™é‡Œæ”¹æˆ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">location / &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="m">301&lt;/span> https://&amp;lt;domain&amp;gt;&lt;span class="nv">$request_uri&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>é‡å¯ nginx&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">nginx -t
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl start nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># or&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nginx -s reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="è®¾ç½®ç³»ç»ŸæœåŠ¡">è®¾ç½®ç³»ç»ŸæœåŠ¡&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cp /opt/pleroma/installation/pleroma.service /etc/systemd/system/pleroma.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl start pleroma
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> pleroma
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯ä»¥è®¿é—®å•¦&lt;/p>
&lt;h2 id="åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·">åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-perl" data-lang="perl">&lt;span class="line">&lt;span class="cl">&lt;span class="n">cd&lt;/span> &lt;span class="sr">/opt/&lt;/span>&lt;span class="n">pleroma&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">su&lt;/span> &lt;span class="n">pleroma&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="nv">$SHELL&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nb">lc&lt;/span> &lt;span class="s">&amp;#34;./bin/pleroma_ctl user new &amp;lt;joeuser&amp;gt; &amp;lt;joeuser@sld.tld&amp;gt; --admin&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-perl" data-lang="perl">&lt;span class="line">&lt;span class="cl">&lt;span class="n">cd&lt;/span> &lt;span class="sr">/opt/&lt;/span>&lt;span class="n">pleroma&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">su&lt;/span> &lt;span class="n">pleroma&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="nv">$SHELL&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nb">lc&lt;/span> &lt;span class="s">&amp;#34;./bin/pleroma_ctl user new admin admin@ponderduck.cc --admin&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å‚è€ƒ--è‡´è°¢">å‚è€ƒ &amp;amp; è‡´è°¢&lt;/h2>
&lt;p>&lt;a class="link" href="https://suicablog.cobaltkiss.blue/posts/pleroma-installation-on-linux-using-otp-releases/" target="_blank" rel="noopener"
>åœ¨ Debian 10 / Ubuntu 20.04 ä¸Šå®‰è£… Pleroma &lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>&lt;a class="link" href="https://suicablog.cobaltkiss.blue/posts/wildcard-with-cloudflare-using-certbot/" target="_blank" rel="noopener"
>é€šé…ç¬¦åŸŸåè¯ä¹¦ç”³è¯·ä¸è‡ªåŠ¨ç»­è´¹ï¼ˆNginxï¼ŒDebian 10ï¼‰&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>&lt;a class="link" href="https://lily-is.land/infra/pleroma/-/blob/servant/docs/configuration/cheatsheet.md" target="_blank" rel="noopener"
>Configuration Cheat Sheet&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p></description></item><item><title>Pleroma | è´­ä¹°æœåŠ¡å™¨åŠä¹‹åè¦åšä»€ä¹ˆ</title><link>https://falasool.github.io/2023/buy-and-set-ups/</link><pubDate>Thu, 01 Jun 2023 23:29:38 +0800</pubDate><guid>https://falasool.github.io/2023/buy-and-set-ups/</guid><description>&lt;!-- raw HTML omitted -->
&lt;h2 id="è´­ä¹°æœåŠ¡å™¨">è´­ä¹°æœåŠ¡å™¨&lt;/h2>
&lt;p>é€‰ intel - ç¾è¥¿æœºæˆ¿ - Debian11 - 1C1G 25G SSD 1TB&lt;/p>
&lt;p>æ·»åŠ  SSHï¼Œç”Ÿæˆå¯†é’¥&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">ssh-keygen -t rsa -b 4096 -C &amp;#34;example comment&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ‰“å°å‡ºå…¬é’¥å†…å®¹ï¼Œç²˜è´´è¿› VPS æœåŠ¡å•†çš„ç•Œé¢å»&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> cat /Users/userName/.ssh/id_rsa.pub
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç”¨ SSH ç»ˆç«¯è¿œç¨‹ç™»å½•ï¼Œæµ‹è¯• IP ä¸­å›½å¤§é™†æ˜¯å¦å¯ç”¨&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="http://ping.pe/" target="_blank" rel="noopener"
>http://ping.pe/&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/li>
&lt;li>&lt;a class="link" href="https://ping.chinaz.com/" target="_blank" rel="noopener"
>https://ping.chinaz.com/&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/li>
&lt;/ul>
&lt;h2 id="ä¿®æ”¹æœåŠ¡å™¨æ—¶åŒº">ä¿®æ”¹æœåŠ¡å™¨æ—¶åŒº&lt;/h2>
&lt;p>æŸ¥çœ‹å½“å‰æ—¶åŒº&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">admin@xxx:~# date
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Fri 02 Jun 2023 01:25:08 PM UTC
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¿®æ”¹æ—¶åŒºï¼Œç„¶åå†æ¬¡æ£€æŸ¥å½“å‰æ—¶åŒº&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># åˆ é™¤é»˜è®¤æ—¶åŒº
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">admin@xxx:~# rm -rf /etc/localtime
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># ä¿®æ”¹ä¸ºä¸Šæµ·
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">admin@xxx:~# ln -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># æ£€æŸ¥
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">admin@xxx:~# date
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Fri 02 Jun 2023 01:27:14 PM CST
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å®‰è£…å¸¸ç”¨å·¥å…·">å®‰è£…å¸¸ç”¨å·¥å…·&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">apt-get install curl wget screen tree git htop bash-completion fail2ban -y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>
&lt;p>curlï¼šè¯·æ±‚ web æœåŠ¡å™¨&lt;/p>
&lt;/li>
&lt;li>
&lt;p>wgetï¼šä¸‹è½½è½¯ä»¶åŒ…&lt;/p>
&lt;/li>
&lt;li>
&lt;p>screenï¼šç»ˆç«¯ç®¡ç†å·¥å…·ï¼Œéšæ‰‹ &lt;code>screen -S name&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>treeï¼šæ˜¾ç¤ºç›®å½•ç»“æ„&lt;/p>
&lt;/li>
&lt;li>
&lt;p>htopï¼šç›‘æ§è¿›ç¨‹&lt;/p>
&lt;/li>
&lt;li>
&lt;p>bash-completionï¼šå‘½ä»¤è‡ªåŠ¨è¡¥å…¨å·¥å…·ï¼ŒæŒ‰ [Tab][Tab]&lt;/p>
&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># å®šä½ bash-completion é…ç½®æ–‡ä»¶
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">admin@xxx:~# find / -name &amp;#34;bash_completion.d&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/etc/bash_completion.d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># æ·»åŠ  docker çš„è‡ªåŠ¨è¡¥å…¨ï¼Œé‡å¯ bash
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">admin@xxx:~# cd /etc/bash_completion.d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">admin@xxx:~# curl -L -O https://raw.githubusercontent.com/docker/compose/$(docker-compose version --short)/contrib/completion/bash/docker-compose
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>fail2banï¼šé˜²æ­¢æš´åŠ›ç ´è§£æ”»å‡»ï¼Œåœ¨ &lt;code>/etc/fail2ban/jail.conf&lt;/code> ä¿®æ”¹é…ç½®ï¼Œç„¶åæ¿€æ´»&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># æ£€éªŒæœ‰æ²¡æœ‰æ­£ç¡®å¯åŠ¨
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fail2ban-client ping
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># æŸ¥çœ‹ç›®å‰å¯ç”¨çš„è§„åˆ™
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fail2ban-client status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># æŸ¥çœ‹æŸä¸ªè§„åˆ™ä¸‹è¢«å°ç¦çš„æ¬¡æ•°ã€ip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fail2ban-client status sshd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="æ›´æ”¹ç»ˆç«¯é¢œè‰²">æ›´æ”¹ç»ˆç«¯é¢œè‰²&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># è¿›å…¥ /etc/profile æ–‡ä»¶
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vim /etc/profile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># å¢åŠ è¿™ä¸€è¡Œ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PS1=&amp;#39;[\[\e[32m\]\u\[\e[0m\]\[\e[35m\]@\[\e[0m\]\[\e[33m\]\h\[\e[0m\]\[\e[36m\] \W\[\e[0m\]]\$ &amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># æ›´æ–°æ–‡ä»¶
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">source /etc/profile
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="æ·»åŠ -swap">æ·»åŠ  SWAP&lt;/h2>
&lt;p>ç¡®è®¤æ˜¯å¦å·²å­˜åœ¨ SWAP&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">free -m
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æœ‰ Swap é¡¹è€Œä¸” total åˆ—ä¸ä¸ºé›¶ï¼Œè¯´æ˜ Swap å·²å­˜åœ¨ï¼Œå¯ä»¥è‡ªè¡Œä¿®æ”¹åˆ†åŒºå®¹é‡ï¼Œå‚è€ƒï¼šä¸º &lt;a class="link" href="https://www.vvave.net/archives/add-swap-and-repartition-swap-for-linux.html" target="_blank" rel="noopener"
>Linux æ·»åŠ  swap åˆ†åŒºæˆ–ä¿®æ”¹ swap åˆ†åŒºå®¹é‡&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;h2 id="é˜²ç«å¢™">é˜²ç«å¢™&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ufw allow OpenSSH
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw &lt;span class="nb">enable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw allow http
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw allow https
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw allow 80/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw allow 443/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># or&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw default deny incoming
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw default allow outgoing
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw allow ssh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw allow http
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw allow https
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw &lt;span class="nb">enable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw status numbered
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å‚è€ƒ--è‡´è°¢">å‚è€ƒ &amp;amp; è‡´è°¢&lt;/h2>
&lt;p>&lt;a class="link" href="https://einverne.github.io/post/2015/12/things-to-do-after-buying-vps.html#change-default-shell" target="_blank" rel="noopener"
>è´­ä¹° VPS ä¹‹åéœ€è¦åšçš„äº‹æƒ…&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>&lt;a class="link" href="https://einverne.github.io/post/2021/07/vps-benchmark.html" target="_blank" rel="noopener"
>VPS æ€§èƒ½æµ‹è¯•&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p></description></item><item><title>Pleroma | ç»´æŠ¤æ—¥å¿—(äºŒ)</title><link>https://falasool.github.io/2023/pleroma-operation-and-maintenance/</link><pubDate>Mon, 15 May 2023 18:52:31 +0800</pubDate><guid>https://falasool.github.io/2023/pleroma-operation-and-maintenance/</guid><description>&lt;p>å‰æƒ…ï¼špostgreSQL æ•°æ®åº“è¾¾åˆ°äº†æƒŠäººçš„ 15Gï¼ŒæŠŠç¡¬ç›˜æ’‘çˆ†äº†ä¸”æŠ¢ä¿®æ— æœã€‚è¿™æ˜¯ç‚¸ç«™é‡æ¥åçš„è¿ç»´æ—¥å¿—ã€‚&lt;a class="link" href="https://ponder.lol/2023/pleroma-operation-and-maintenance2/" target="_blank" rel="noopener"
>Pleroma | ç»´æŠ¤æ—¥å¿—(ä¸€)&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
å·²è®°å½•çš„å†…å®¹ä¸å†é‡å¤&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;h2 id="æ•°æ®åº“ç›¸å…³">æ•°æ®åº“ç›¸å…³&lt;/h2>
&lt;ol>
&lt;li>ç™»å½•æ•°æ®åº“ï¼ŒæŠ¥é”™ï¼špsql: error: FATAL: Peer authentication failed for user &amp;ldquo;postgres&amp;rdquo;&lt;/li>
&lt;/ol>
&lt;p>æŒ‰ç…§ &lt;a class="link" href="https://stackoverflow.com/questions/18664074/getting-error-peer-authentication-failed-for-user-postgres-when-trying-to-ge" target="_blank" rel="noopener"
>https://stackoverflow.com/questions/18664074/getting-error-peer-authentication-failed-for-user-postgres-when-trying-to-ge&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-diff" data-lang="diff">&lt;span class="line">&lt;span class="cl"># ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆæ”¹æˆ md5 ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯ trust èƒ½å…å¯†ç™»å½•ï¼‰
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vim /etc/postgresql/13/main/pg_hba.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="gi">+ local all postgres trust
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="gi">&lt;/span># é‡å¯æ•°æ®åº“
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">service postgresql restart
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>&lt;a class="link" href="https://blog.debula.ml/" target="_blank" rel="noopener"
>@debula&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
å’Œ &lt;a class="link" href="https://seviche.cc/about" target="_blank" rel="noopener"
>@Seviche&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
å¸®å¿™æå–äº†æˆ‘çš„è¿œç¨‹ç¼“å­˜ orzï¼Œè®°å½•ä¸€ä¸‹ï¼š&lt;/li>
&lt;/ol>
&lt;p>ä»Šå¤©å°è¯•äº†ä¸€ä¸‹ ï¼Œåœ¨ JSON ä¸­å¯ä»¥ä½¿ç”¨ &lt;code>-&amp;gt;&amp;gt;&lt;/code> æ¥æå– jsonb çš„ key å¯¹åº”çš„ valueï¼Œæ¯”å¦‚ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">select data from activities where data-&amp;gt;&amp;gt;&amp;#39;actor&amp;#39; = &amp;#39;https://ponderduck.cc/users/yaya&amp;#39; order by data-&amp;gt;&amp;gt;&amp;#39;published&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯ä»¥æå–ç”¨æˆ·æ‰€æœ‰çš„ activitiesï¼Œå† join ä¸€ä¸‹ objects å°±å¾—åˆ°äº†ç»“æœï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">SELECT a.&amp;#34;actor&amp;#34;, a.&amp;#34;data&amp;#34;-&amp;gt;&amp;gt;&amp;#39;type&amp;#39; AS type, a.&amp;#34;updated_at&amp;#34;, o.&amp;#34;data&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">FROM &amp;#34;activities&amp;#34; AS a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">INNER JOIN &amp;#34;objects&amp;#34; AS o
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ON (o.&amp;#34;data&amp;#34;-&amp;gt;&amp;gt;&amp;#39;id&amp;#39;) = COALESCE(a.&amp;#34;data&amp;#34;-&amp;gt;&amp;#39;object&amp;#39;-&amp;gt;&amp;gt;&amp;#39;id&amp;#39;, a.&amp;#34;data&amp;#34;-&amp;gt;&amp;gt;&amp;#39;object&amp;#39;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WHERE a.&amp;#34;data&amp;#34;-&amp;gt;&amp;gt;&amp;#39;actor&amp;#39; = &amp;#39;https://ponderduck.cc/users/yaya&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">OR a.&amp;#34;data&amp;#34;-&amp;gt;&amp;#39;to&amp;#39; ? &amp;#39;https://ponderduck.cc/users/yaya&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">OR a.&amp;#34;data&amp;#34;-&amp;gt;&amp;#39;cc&amp;#39; ? &amp;#39;https://ponderduck.cc/users/yaya&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ORDER BY a.&amp;#34;updated_at&amp;#34; LIMIT 5;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æœ€åå† copy åˆ°æœ¬åœ°ç›®å½•å°±å¥½äº†ï½&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">copy(SELECT ...) to &amp;#39;/var/lib/postgresql/yaya.csv&amp;#39; (FORMAT &amp;#39;csv&amp;#39;, DELIMITER &amp;#39;,&amp;#39;, HEADER true, NULL &amp;#39;UNKOWN&amp;#39;, ENCODING &amp;#39;UTF8&amp;#39;);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘å¯¼å‡ºçš„åŒ…æ‹¬æ”¶è—å’Œåˆ«äººçš„äº’åŠ¨ï¼ˆå›å¤/æ”¶è—/è½¬å‘ï¼‰ï¼Œå¦‚æœåªè¦åˆ›å»ºçš„è¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pleroma=# select count(data) from activities where data-&amp;gt;&amp;gt;&amp;#39;actor&amp;#39; = &amp;#39;https://ponderduck.cc/users/yaya&amp;#39; and data-&amp;gt;&amp;gt;&amp;#39;type&amp;#39; = &amp;#39;Create&amp;#39;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> count
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">\-------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1624
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">(1 row)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¹Ÿå¯ä»¥çœ‹è¿™ç¯‡è¶…æ£’çš„åšå®¢ï¼š&lt;a class="link" href="https://blog.debula.ml/index.php/archives/5/#1.%E7%A4%BE%E4%BA%A4%E7%BD%91%E7%BB%9C%EF%BC%9APleroma" target="_blank" rel="noopener"
>ç¤¾äº¤ç½‘ç»œï¼šPleroma&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;ol start="3">
&lt;li>å®šæœŸæ¸…ç†æ•°æ®åº“çš„ objects&lt;/li>
&lt;/ol>
&lt;h2 id="ç£ç›˜">ç£ç›˜&lt;/h2>
&lt;h3 id="è‡ªåŠ¨æ¸…ç†-tmp-ç›®å½•">è‡ªåŠ¨æ¸…ç† tmp ç›®å½•&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># æ‰“å¼€ç³»ç»Ÿçº§åˆ«çš„ crontab
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">crontab -e
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># åœ¨æ–‡ä»¶æœ«å°¾ç²˜è´´ä¿å­˜ä»¥ä¸‹å‘½ä»¤ï¼ˆæ¯å¤© 00:00 åˆ é™¤ æœ€è¿‘ä¸‰å¤©æœªä½¿ç”¨å¹¶ä¸å±äº root ç”¨æˆ·çš„æ–‡ä»¶ï¼‰
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0 0 * * * sudo find /tmp -type f ! -user root -atime +3 -delete
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[xxx@xxx ~]# psql -U postgres
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">psql (13.11 (Debian 13.11-0+deb11u1))
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Type &amp;#34;help&amp;#34; for help.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">postgres=# SELECT pg_size_pretty( pg_database_size(&amp;#39;pleroma&amp;#39;) );
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> pg_size_pretty
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">----------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 576 MB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">(1 row)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="admin-fe">Admin-FE&lt;/h2>
&lt;p>settings/Loggerï¼šæŠŠæ—¥å¿—çº§åˆ«æ”¹ä¸º &lt;code>:warn&lt;/code>&lt;/p>
&lt;h2 id="å‚è€ƒ--è‡´è°¢">å‚è€ƒ &amp;amp; è‡´è°¢&lt;/h2>
&lt;p>&lt;a class="link" href="https://www.myfreax.com/tmp-directory-in-linux/" target="_blank" rel="noopener"
>Linux ä¸´æ—¶ç›®å½• /tmp ä¸ /var/tmp&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>&lt;a class="link" href="https://navicat.com/en/company/aboutus/blog/673-design-select-queries-using-navicat-s-query-builder" target="_blank" rel="noopener"
>https://navicat.com/en/company/aboutus/blog/673-design-select-queries-using-navicat-s-query-builder&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p></description></item><item><title>Pleroma | ç»´æŠ¤æ—¥å¿—(ä¸€)</title><link>https://falasool.github.io/2023/pleroma-operation-and-maintenance2/</link><pubDate>Mon, 15 May 2023 12:52:31 +0800</pubDate><guid>https://falasool.github.io/2023/pleroma-operation-and-maintenance2/</guid><description>&lt;p>æ­å»ºæ­¥éª¤å®Œå…¨å‚è€ƒ &lt;a class="link" href="https://suicablog.cobaltkiss.blue/posts/pleroma-installation-on-linux-using-otp-releases/" target="_blank" rel="noopener"
>åœ¨ Debian 10 / Ubuntu 20.04 ä¸Šå®‰è£… Pleroma&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
ï¼Œæ„Ÿè°¢ Suicaï¼&lt;/p>
&lt;h2 id="å…³é—­å¼€å¯æ³¨å†Œ">å…³é—­/å¼€å¯æ³¨å†Œ&lt;/h2>
&lt;p>Settings &amp;gt; Instance &amp;gt; Registrations open&lt;/p>
&lt;p>ï¼ˆç«™ç‚¹åç§°ã€å­—æ•°ä¸Šé™ã€æŠ•ç¥¨é€‰é¡¹ä¸Šé™ã€å°ç¦å…¶å®ƒå®ä¾‹ç­‰ç­‰éƒ½åœ¨ &lt;code>instance&lt;/code>ï¼‰&lt;/p>
&lt;h2 id="æ›´æ¢å®ä¾‹å›¾æ ‡">æ›´æ¢å®ä¾‹å›¾æ ‡&lt;/h2>
&lt;p>åˆ†ä¸ºä¸‰æ­¥ï¼š&lt;/p>
&lt;ul>
&lt;li>å‡†å¤‡å¥½ LOGO æ–‡ä»¶&lt;/li>
&lt;li>æ‰¾åˆ°æ”¾ favicon çš„ä½ç½®&lt;/li>
&lt;li>ä¸Šä¼ &lt;/li>
&lt;/ul>
&lt;p>å…·ä½“æ¥è¯´ï¼š&lt;/p>
&lt;p>æ‰¾åˆ°æœ¬åœ°è¦ä¸Šä¼ çš„å›¾ç‰‡çš„ç»å¯¹è·¯å¾„ï¼Œä¾‹å¦‚ï¼š&lt;code>/Users/user/Pictures/favicon.png&lt;/code>&lt;/p>
&lt;p>å®šä½æœåŠ¡å™¨ä¸­ favicon ä½ç½®&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">find / -type f -iname favicon.png
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>å‚æ•°è¯´æ˜ï¼š&lt;/p>
&lt;p>&lt;code>find&lt;/code> å‘½ä»¤ï¼šæ ¹æ®ç”¨æˆ·æŒ‡å®šçš„è¡¨è¾¾å¼åœ¨ç›®å½•å±‚æ¬¡ç»“æ„ä¸­æœç´¢æ–‡ä»¶å’Œç›®å½•&lt;/p>
&lt;p>&lt;code>/&lt;/code>ï¼šåœ¨æ ¹ç›®å½•èŒƒå›´å†…æœç´¢&lt;/p>
&lt;p>&lt;code>-type f&lt;/code>ï¼šæŒ‡å®šæ–‡ä»¶ç±»å‹ å¸¸è§„æ–‡ä»¶&lt;/p>
&lt;p>&lt;code>-iname&lt;/code>ï¼šç›®æ ‡æ–‡ä»¶åï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰&lt;/p>
&lt;/blockquote>
&lt;p>å¾—åˆ° favcion çš„è·¯å¾„&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">/opt/pleroma/lib/pleroma-2.4.5-2-gd8e32646/priv/static/favicon.png
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸Šä¼ å›¾æ ‡ï¼šå¦å¼€ä¸€ä¸ªç»ˆç«¯çª—å£ï¼ˆå› ä¸ºå½“å‰ç»ˆç«¯å·²ç»ç™»å½•äº†æœåŠ¡å™¨ï¼Œåœ¨æœåŠ¡å™¨é‡ŒæŸ¥æ‰¾è¿˜æœªä¸Šä¼ çš„æ–‡ä»¶æ˜¯æ‰¾ä¸åˆ°çš„ï¼‰ï¼Œæ‰§è¡Œ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">rsync /Users/user/Pictures/favicon.png admin@149.248.0.119:/opt/pleroma/lib/pleroma-2.4.5-2-gd8e32646/priv/static/favicon.png
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>å‚æ•°è¯´æ˜ï¼š&lt;/p>
&lt;p>scp &amp;lt;æœ¬åœ°æ–‡ä»¶è·¯å¾„&amp;gt;&amp;lt; vpsç”¨æˆ·å@æœåŠ¡å™¨IP&amp;gt;:&amp;lt;ç›®æ ‡è·¯å¾„&amp;gt;&lt;/p>
&lt;/blockquote>
&lt;p>ä»¥åŠï¼Œç½‘é¡µ logo åœ¨ Settings &amp;gt; Frontend ï¼Œè®°å¾—å–æ¶ˆ Settings &amp;gt; Frontend &amp;gt; Logo mask&lt;/p>
&lt;p>åˆ·æ–°ç½‘é¡µï¼Œå›¾æ ‡æ›´æ”¹å®Œæ¯• ğŸ‰&lt;/p>
&lt;h2 id="æ€ä¹ˆæ¢ä¸€ä¸ªå‰ç«¯">æ€ä¹ˆæ¢ä¸€ä¸ªå‰ç«¯&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># ä¸‹è½½åˆ° /tmp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cd /tmp &amp;amp;&amp;amp; curl -L https://gitlab.com/soapbox-pub/soapbox-fe/-/jobs/artifacts/v3.0.0-beta.1/download?job=build-production -o soapbox-fe.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># è§£å‹åˆ° /var/lib/pleroma
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">busybox unzip soapbox-fe.zip -o -d /var/lib/pleroma
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åˆ·æ–°ç½‘é¡µ&lt;/p>
&lt;h2 id="è‡ªå®šä¹‰è¡¨æƒ…">è‡ªå®šä¹‰è¡¨æƒ…&lt;/h2>
&lt;p>è¡¨æƒ…æ¥æºï¼š&lt;/p>
&lt;p>&lt;a class="link" href="https://emojos.in/" target="_blank" rel="noopener"
>https://emojos.in/&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>&lt;a class="link" href="https://slackmojis.com/" target="_blank" rel="noopener"
>https://slackmojis.com/&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>&lt;a class="link" href="https://fedi.absturztau.be/emoji-packs/" target="_blank" rel="noopener"
>https://fedi.absturztau.be/emoji-packs/&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>&lt;a class="link" href="https://stickersurge.com/sticker-packs" target="_blank" rel="noopener"
>https://stickersurge.com/sticker-packs&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>æˆ–è€… &lt;a class="link" href="https://pullopen.github.io/%E7%AB%99%E7%82%B9%E7%BB%B4%E6%8A%A4/2020/11/26/mastodon-manage.html" target="_blank" rel="noopener"
>å¦‚ä½•è£…é¥°ä½ çš„ç«™ç‚¹ï¼šè‡ªå®šä¹‰CSSã€ä¸­ç»§ç«™å’Œè‡ªå®šä¹‰è¡¨æƒ…&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
é‡Œæåˆ°çš„ã€Œå·è¡¨æƒ…ç¥å™¨ã€&lt;/p>
&lt;p>æŠŠå·æ¥çš„è¡¨æƒ…ï¼ˆ&amp;hellip;ï¼‰é€šè¿‡ SSH å®¢æˆ·ç«¯çš„ SFTP åŠŸèƒ½ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„ &lt;code>/var/lib/pleroma/static/emoji&lt;/code> ç›®å½•ä¸‹ï¼ˆæˆ–è€…ä½ çš„è‡ªå®šä¹‰è·¯å¾„ï¼‰&lt;/p>
&lt;p>åœ¨ Admin FE çš„ Settings &amp;gt; Emoji &amp;gt; Settings &amp;gt; Shortcode globs é‡Œæ·»åŠ è¡¨æƒ…åŒ…ç›®å½•çš„è·¯å¾„ï¼Œæ¯”å¦‚ï¼š&lt;code>/emoji/**/*.png&lt;/code>ã€&lt;code>/emoji/**/*.gif&lt;/code> ï¼Œæ„å‘³ç€ emoji åŠå…¶å­ç›®å½•ä¸‹æ‰€æœ‰ png/gif æ ¼å¼çš„æ–‡ä»¶éƒ½ä¼šè¢«è§†ä½œè‡ªå®šä¹‰è¡¨æƒ…åŒ…&lt;/p>
&lt;p>ç‚¹å‡» Reload emojiï¼ŒOK&lt;/p>
&lt;p>&lt;a class="link" href="https://stickersurge.com/pack/8bit" target="_blank" rel="noopener"
>https://stickersurge.com/pack/8bit&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>æˆ‘è§‰å¾—è¿™ç»„è¡¨æƒ…åŒ…å¥½å¥½ç¬‘ğŸ¤­&lt;/p>
&lt;h2 id="æ”¾å¤§-emoji">æ”¾å¤§ Emoji&lt;/h2>
&lt;p>&lt;a class="link" href="https://kyo.iroiro.party/posts/pleroma-largemoji/" target="_blank" rel="noopener"
>Pleroma-fe çš„ emoji æ”¾å¤§é…ç½®ï¼ˆï¼Ÿï¼‰&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;h2 id="å®ä¾‹å±•ç¤ºé¡µé¢">å®ä¾‹å±•ç¤ºé¡µé¢&lt;/h2>
&lt;p>åœ¨ Settings &amp;gt; Frontend &amp;gt; Redirect root no login é‡Œæ”¹æˆ &lt;code>/about&lt;/code>&lt;/p>
&lt;p>åœ¨ Admin FE &amp;gt; Settings &amp;gt; Others æ”¹ç«™ç‚¹è§„åˆ™&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Hello!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Ponderduck is a private instance and is not normally open for registration, so if you would like to join, please contact the admin with your fediverse account.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Thanks to those who have helped me in the build process! Sending lots of love and respect!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">See the Pleroma documentation for more information.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç¦æ­¢æœªéªŒè¯ç”¨æˆ·æµè§ˆæ—¶é—´çº¿ï¼šSettings &amp;gt; Instance &amp;gt; Public/Timelines/Profiles/Activites æ ¹æ®éœ€è¦æ›´æ”¹&lt;/p>
&lt;h2 id="è‡ªå®šä¹‰ä¸»é¢˜">è‡ªå®šä¹‰ä¸»é¢˜&lt;/h2>
&lt;p>è·å–ä¸»é¢˜ or è‡ªåˆ¶ï¼š&lt;/p>
&lt;blockquote>
&lt;p>&lt;a class="link" href="https://fediverse.eu.org/discussion/27/%E4%BA%94%E5%88%86%E9%92%9F%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E6%BC%82%E4%BA%AE%E7%9A%84pleroma%E4%B8%BB%E9%A2%98" target="_blank" rel="noopener"
>äº”åˆ†é’Ÿè®¾è®¡ä¸€ä¸ªæ¼‚äº®çš„pleromaä¸»é¢˜&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>&lt;a class="link" href="https://mikan.bangdream.moe/2022/11/21/recommend-settings-for-pleroma/" target="_blank" rel="noopener"
>å…³äº Docker ä¸‹ Pleroma å®ä¾‹éƒ¨ç½²çš„ä¸€äº›æ¨èè®¾ç½®&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>æˆ–è€… Google ã€ŒPleroma FE theme jsonã€&lt;/p>
&lt;/blockquote>
&lt;p>ä¸€äº›æ¼‚äº®ä¸»é¢˜å±•ç¤ºï¼š&lt;/p>
&lt;p>&lt;a class="link" href="https://mindpalace.michaelis.website/tech/pleroma-theme.html" target="_blank" rel="noopener"
>https://mindpalace.michaelis.website/tech/pleroma-theme.html&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>&lt;a class="link" href="https://plthemes.vulpes.one/" target="_blank" rel="noopener"
>https://plthemes.vulpes.one/&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>&lt;a class="link" href="https://suicablog.cobaltkiss.blue/posts/themes-gallery/" target="_blank" rel="noopener"
>https://suicablog.cobaltkiss.blue/posts/themes-gallery/&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>æ·»åŠ ä¸»é¢˜çš„æ­¥éª¤ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>æ‰¾åˆ° themes æ–‡ä»¶å¤¹ &lt;code>find / -type d -iname themes&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æŠŠä¸‹è½½çš„ &lt;code>.json&lt;/code> æ–‡ä»¶æ·»åŠ åˆ°ç›®æ ‡ç›®å½•ï¼Œæ¯”å¦‚æˆ‘æ·»åŠ åˆ°äº† &lt;code>/var/lib/pleroma/static/static/themes&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç„¶ååœ¨ &lt;code>/var/lib/pleroma/static/static/styles.json&lt;/code> æŠŠåˆšåˆšçš„è‡ªå®šä¹‰ä¸»é¢˜æ·»åŠ è¿›å»ï¼ŒæŒ‰å¦‚ä¸‹æ ¼å¼&lt;/p>
&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-json" data-lang="json">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;takeabreak&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;/static/themes/takeabreak.json&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;break&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;/static/themes/break.json&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åˆ·æ–°ç½‘é¡µï¼Œåœ¨è®¾ç½®é‡Œæ‰¾åˆ°è‡ªå®šä¹‰ä¸»é¢˜ï¼Œå¯ä»¥ç”¨äº†&lt;/p>
&lt;p>æœ¬ç«™é»˜è®¤ä¸»é¢˜åœ¨ Admin FE/Pleroma FE é‡Œæ”¹ï¼Œè·¯å¾„ï¼šSettings &amp;gt; Frontend &amp;gt; Themes&lt;/p>
&lt;h2 id="è¿æ¥ä¸­ç»§">è¿æ¥ä¸­ç»§&lt;/h2>
&lt;blockquote>
&lt;p>ä¸­ç»§çš„ç®€ä»‹ã€é‡è¦æ€§å’Œä¸­æ–‡ä¸­ç»§æ¨èï¼šhttps://mstdn.one/@list/106729842177738917&lt;/p>
&lt;p>åŠ ä¸ä¸ŠæŸäº›ä¸­ç»§ï¼Œä½†æ˜¯åˆæƒ³tlä¸Šå‡ºç°æ›´å¤šå˜Ÿæ–‡æ€ä¹ˆåŠï¼Ÿ&lt;/p>
&lt;ul>
&lt;li>Kanaå‘Šè¯‰æˆ‘ä¸€ä¸ªåŠæ³•ï¼šå¯¹äº Pleroma å®ä¾‹è€Œè¨€ï¼ŒæŠŠ https://Pleromaå®ä¾‹åŸŸå/relay å½“ä½œä¸­ç»§è¿æ¥æ¥è¾“å…¥æ˜¯å¯ä»¥å…³æ³¨è¿™ä¸ªå®ä¾‹çš„ã€‚&lt;/li>
&lt;li>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—® ï¼ˆhttps://the-federation.info/pleroma ï¼‰å’Œï¼ˆhttps://fedidb.org/network ï¼‰è¿™ä¸¤ä¸ªfediverseé»„é¡µï¼Œæ‰‹åŠ¨æ·»åŠ è‡ªå·±å¿ƒä»ªçš„pleromaå®ä¾‹ã€‚å¯ä»¥ä¸€å£æ°”å…³æ³¨æ‰€æœ‰çš„ä¸­æ–‡pleromaï¼ˆå› ä¸ºå¤ªå°‘ï¼‰ï¼Œè¿˜å¯ä»¥å…³æ³¨å‡ ä¸ªå¤´éƒ¨å¤–æ–‡å®ä¾‹ï¼ˆbae.stçš„äººå‘é»„å›¾ä¸é€‰NFSWï¼ï¼‰&lt;/li>
&lt;/ul>
&lt;p>â€”â€”æ¥è‡ª &lt;a class="link" href="https://dasgelobteland.github.io/posts/22pleroma/" target="_blank" rel="noopener"
>æˆ‘çš„pleromaæ­å»ºç¬”è®°&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;/blockquote>
&lt;p>å‡ ä¸ªä¸­æ–‡ä¸­ç»§ï¼šhttps://mstdn.one/@list/106729842177738917&lt;/p>
&lt;h2 id="å¤‡ä»½">å¤‡ä»½&lt;/h2>
&lt;p>Pleroma éœ€è¦å¤‡ä»½çš„åœ°æ–¹æœ‰ä¸‰ä¸ªï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>/etc/pleroma&lt;/code>ï¼šå­˜å‚¨å¯åŠ¨æ—¶çš„é…ç½®æ–‡ä»¶ã€‚å¦‚æœä½ å¼€å¯äº†æ•°æ®åº“å­˜å‚¨é…ç½®ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨å¤‡ä»½ï¼›&lt;/li>
&lt;li>&lt;code>/var/lib/pleroma&lt;/code>ï¼šå­˜å‚¨ç”¨æˆ·åˆ›å»ºçš„é™æ€æ–‡ä»¶ï¼ˆè‡ªå®šä¹‰è¡¨æƒ…ã€å¤´åƒã€ä¸Šä¼ çš„æ–‡ä»¶ã€å‰ç«¯ã€â€¦â€¦ï¼‰ï¼Œå¦‚æœä¸æ˜¯ç»å¸¸ä¸Šä¼ æ–‡ä»¶ï¼Œå¯ä»¥æŒ‰æœˆå¤‡ä»½ï¼›&lt;/li>
&lt;li>PostgreSQL ä¸­çš„ pleroma æ•°æ®åº“ï¼Œå¯ä»¥é€šè¿‡ &lt;code>pg_dump&lt;/code> å¤‡ä»½ï¼š&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo -Hu postgres pg_dump -d pleroma --format=custom -f /var/lib/postgresql/pleroma.pgdump
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ç»­æœŸsslè¯ä¹¦">ç»­æœŸSSLè¯ä¹¦&lt;/h2>
&lt;p>æ ¹æ® &lt;a class="link" href="[https://eff-certbot.readthedocs.io/en/stable/using.html#renewing-certificates]%28https://blog.csdn.net/wanghao_sh/article/details/124977429%29" >å®˜æ–¹æ–‡æ¡£&lt;/a>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">apt-get update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apt install snapd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">snap install core
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">snap install hello-world
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">hello-world
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">snap install --classic certbot
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">snap set certbot trust-plugin-with-root=ok
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">snap install certbot-dns-cloudflare
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ï¼ˆï¼Ÿæœ‰ç‚¹å›°æƒ‘ï¼Œä¸Šé¢æŠ˜è…¾äº†ä¸€å¤§å †ï¼Œæœ€åç®€ç®€å•å•æ•²ä¸ª &lt;code>certbot&lt;/code> ç„¶åè·Ÿç€é€‰å°±å¥½äº†ï¼‰&lt;/p>
&lt;h2 id="å¸¸ç”¨å‘½ä»¤">å¸¸ç”¨å‘½ä»¤&lt;/h2>
&lt;p>æŸ¥çœ‹æœåŠ¡çŠ¶æ€&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">systemctl status &lt;span class="o">[&lt;/span>options&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æŸ¥çœ‹å†…å­˜&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">top
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æŸ¥çœ‹è´Ÿè½½&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">htop
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a class="link" href="https://www.onitroad.com/jc/linux/how-to-install-htop-on-debian-linux-using-apt-get.html" target="_blank" rel="noopener"
>å¦‚ä½•åœ¨Debian Linuxä¸Šå®‰è£…htop&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;h2 id="502-bad-gateway">502 Bad Gateway&lt;/h2>
&lt;p>æŸ¥çœ‹ Nginx é”™è¯¯æ—¥å¿—&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">vim /var/log/nginx/error.log
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[error] 825#825 :*8459 connect() failed (111: Connection refused)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">while connecting to upstream, client: x.x.x.x, server: ponderduck.cc,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">request: &amp;#34;POST /inbox HTTP/2.0&amp;#34;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">upstream: &amp;#34;http:127.0.0.1:4000/inbox&amp;#34;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">host: &amp;#34;ponderduck.cc&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>åˆ†æï¼šclientè¯·æ±‚èµ„æºæ—¶ï¼Œè½¬å‘åˆ°127.0.0.1:4000å»äº†&lt;/p>
&lt;/blockquote>
&lt;p>æ£€æŸ¥4000ç«¯å£ï¼Œè¿”å›ä¸ºç©º&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">telnet &amp;lt;ip&amp;gt; &lt;span class="m">4000&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>netstatæ²¡æœ‰å‘ç°å ç”¨ç«¯å£4000çš„ç¨‹åº&lt;/p>
&lt;p>é™„ä¸Š Debula åŸè¯ï¼š&lt;/p>
&lt;blockquote>
&lt;p>OTPå®‰è£…çš„Pleromaé»˜è®¤ç›‘å¬çš„æ˜¯æœ¬æœºçš„127.0.0.1:4000
ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨VPSä¸Šä½ å¯ä»¥ç›´æ¥é€šè¿‡ &lt;a class="link" href="http://127.0.0.1:4000/" target="_blank" rel="noopener"
>http://127.0.0.1:4000&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
è®¿é—® Pleromaï¼Œæ¯”å¦‚
curl -v http://127.0.0.1:4000/api/v1/instance&lt;/p>
&lt;p>NginXè´Ÿè´£æŠŠå¤–éƒ¨çš„è¿æ¥è¯·æ±‚è½¬å‘åˆ° 127.0.0.1:4000ï¼Œå¾—åˆ°å“åº”åè½¬å‘å›å» &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>å¦‚æœä½ ç”¨ netstat æ²¡å‘ç° 4000 ç«¯å£çš„ç¨‹åºï¼Œè¯´æ˜ Pleroma æŒ‚äº†ï¼Œè¯¥å»æ£€æŸ¥ Pleroma çš„é”™è¯¯æ—¥å¿— &lt;img src="https://bucket.alive.bar/cache/custom_emojis/images/000/047/971/original/c7b0bea715cd48c1.png"
loading="lazy"
alt=":ablobsweats:"
>&lt;/p>
&lt;p>ï¼ˆä¸è¿‡ç¡®å®å¾ˆå¥‡æ€ªï¼ŒOTPç‰ˆæœ¬åº”è¯¥ä¼šè‡ªåŠ¨é‡å¯çš„â€¦â€¦ï¼‰&lt;/p>
&lt;/blockquote>
&lt;p>pleromaä½ç½® /opt/pleroma&lt;/p>
&lt;p>æŸ¥çœ‹pleromaæ—¥å¿—&lt;code>journalctl -u pleroma&lt;/code>,ä¸ºç©º&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">-- Logs begin at Wed 2023-03-08 16:18:56 HKT, end at Wed 2023-03-08 19:38:34 HKT. --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-- No entries --
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>äºæ˜¯å» &lt;code>/var/log/syslog&lt;/code> çœ‹æ—¥å¿—ï¼Œéƒ½æ˜¯infoï¼Œå¥½åƒä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜&lt;/p>
&lt;p>é‡å¯ä¹‹åè«åå…¶å¦™å¥½äº†&lt;/p>
&lt;p>è¿‡äº†4å¤©ï¼Œåˆ502äº†â€¦â€¦&lt;/p>
&lt;p>Update: 20230528å†æ¬¡ 502&lt;/p>
&lt;p>æ£€æŸ¥è¿›ç¨‹æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ps aux &lt;span class="p">|&lt;/span> grep pleroma
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æŸ¥çœ‹ pleroma æ—¥å¿—&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">journalctl -u pleroma
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pleroma: cat: write error: No space left on device
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pleroma: ERROR: Cannot start release because it could not write /opt/pleroma/tmp/pleroma-2.4.5-2-gd8e32646-2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ²¡æœ‰è¶³å¤Ÿç©ºé—´å†™å…¥è¿è¡Œæ—¶é…ç½®æ–‡ä»¶&lt;/p>
&lt;p>æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">free -m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> total used free shared buff/cache available
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Mem: 987 144 117 30 724 634
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Swap: 2399 3 2396
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æŸ¥çœ‹ç£ç›˜ä½¿ç”¨æƒ…å†µï¼ˆæ»¡äº†è€¶&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">df -h
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Filesystem Size Used Avail Use% Mounted on
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/dev/vda1 24G 24G 0 100% /
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æŸ¥çœ‹å„ä¸ªæ–‡ä»¶å ç”¨å¤§å°&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">du -sh *
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2.4G swapfile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2.7G usr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">19G var
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ¸…ç©ºæ—¥å¿—ï¼Œç¨å¾®è…¾å‡ºä¸€ç‚¹ç©ºé—´äº†&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat /dev/null &amp;gt; filename
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>/usr/lib/postgresql/11/bin/pg_ctl&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">/etc/postgresql/11/main#
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ conf.d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ environment
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ pg_ctl.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ pg_hba.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ pg_ident.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ postgresql.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â””â”€â”€ start.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ•°æ®åº“å¸¸ç”¨å‘½ä»¤&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç™»å½• PG æ•°æ®åº“&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">psql -U postgres
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">\l&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è¿›å…¥æŸæ•°æ®åº“&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">\c&lt;/span> pg-name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŸ¥çœ‹æŸæ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨å&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">select&lt;/span> tablename from pg_tables&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># é€€å‡ºæ•°æ®åº“&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ctrl + z
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æŸ¥çœ‹æ•°æ®åº“å¤§å°ï¼Œæ˜¯å°æœåŠ¡å™¨ä¸èƒ½æ‰¿å—ä¹‹é‡&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">postgres=# SELECT pg_size_pretty( pg_database_size(&amp;#39;pleroma&amp;#39;) );
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> pg_size_pretty
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">----------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 14 GB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">(1 row)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å‡çº§æœåŠ¡å™¨ï¼Œç„¶åæŸ¥çœ‹ç£ç›˜å ç”¨æƒ…å†µ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">df -h
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Filesystem Size Used Avail Use% Mounted on
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/dev/vda1 52G 23G 27G 46% /
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æŸ¥çœ‹ postgresql æ—¥å¿—&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">vim /var/log/postgresql/postgresql.log
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åˆ›å»ºæ•°æ®åº“æ–‡ä»¶çš„å¤‡ä»½ç›®å½•å¹¶èµ‹æƒ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mkdir -p /pleromabackup
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod 777 /pleromabackup
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å…è®¸ pleroma ç”¨æˆ·å…å¯†ç™»å½•æ•°æ®åº“&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">vim /etc/postgresql/11/main/pg_hba.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">host replication repl 127.0.0.1/32 md5
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¤‡ä»½æ•°æ®åº“&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ‡æ¢ç”¨æˆ·ä¸º postgres&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">su - postgres
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç™»å½•æ•°æ®åº“&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">psql -U postgres
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¤‡ä»½&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">postgres&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="c1"># \! pg_dump pleroma -f /pleromabackup/pleroma.pgdump&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åˆ é™¤ 15 å¤©å‰çš„å¤–ç«™ç¼“å­˜ï¼ˆè¿™ä¸ª n å¤©æ˜¯åœ¨ Admin FE - settings - instance - Remote post retention days é‡Œä¿®æ”¹çš„ï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">su pleroma -s &lt;span class="nv">$SHELL&lt;/span> -lc &lt;span class="s2">&amp;#34;./bin/pleroma_ctl database prune_objects&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">11:32:27.912 &lt;span class="o">[&lt;/span>info&lt;span class="o">]&lt;/span> Pruning objects older than &lt;span class="m">15&lt;/span> days
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æœæŠ¥é”™ï¼š&lt;code>â€“rpc-eval : RPC failed with reason :nodedown&lt;/code>ï¼Œå¯èƒ½æ˜¯å› ä¸ºæ²¡å¯åŠ¨ Pleromaã€‚æ„Ÿè°¢ &lt;a class="link" href="https://seviche.cc/" target="_blank" rel="noopener"
>Seviche&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
!!&lt;/p>
&lt;p>æ•´ç†æ•°æ®åº“&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">su pleroma -s &lt;span class="nv">$SHELL&lt;/span> -lc &lt;span class="s2">&amp;#34;./bin/pleroma_ctl database vacuum full&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>0530æ‰§è¡Œè®°å½•&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># é‡æ–°ç”Ÿæˆæ•°æ®åº“é…ç½®æ–‡ä»¶
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">su pleroma -s $SHELL -lc &amp;#34;./bin/pleroma_ctl instance gen --output /tmp/config.exs --output-psql /tmp/setup_db.psql&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># æ¸…ç©ºæ•°æ®åº“
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo -Hu postgres psql -c &amp;#39;DROP DATABASE pleroma;&amp;#39;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">DROP DATABASE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo -Hu postgres psql -c &amp;#39;DROP USER pleroma;&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">DROP ROLE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># æ¥ä¸‹æ¥è¯¥é‡å»ºæ•°æ®åº“äº†
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo -Hu postgres psql -f /tmp/setup_db.psql
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># é‡å»ºåçš„æ•°æ®åº“size
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">postgres=# SELECT pg_size_pretty( pg_database_size(&amp;#39;pleroma&amp;#39;) );
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> pg_size_pretty
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">----------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 8045 kB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">(1 row)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># æ¢å¤æ•°æ®16:17-
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo -u postgres psql pleroma &amp;lt; /pleromabackup/pleroma.pgdump
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å‚è€ƒ--è‡´è°¢">å‚è€ƒ &amp;amp; è‡´è°¢&lt;/h2>
&lt;p>&lt;a class="link" href="https://im.happytoo.cyou/posts/2302%E7%BB%99%E6%88%91%E7%9A%84pleroma%E6%B7%BB%E5%8A%A0%E8%A1%A8%E6%83%85%E5%8C%85/" target="_blank" rel="noopener"
>pleromaä¸­æ·»åŠ è‡ªå®šä¹‰è¡¨æƒ…åŒ…&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>&lt;a class="link" href="https://dasgelobteland.github.io/posts/23pleroma/" target="_blank" rel="noopener"
>https://dasgelobteland.github.io/posts/23pleroma/&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>&lt;a class="link" href="https://blog.debula.ml/index.php/archives/5/#1.%E7%A4%BE%E4%BA%A4%E7%BD%91%E7%BB%9C%EF%BC%9APleroma" target="_blank" rel="noopener"
>ç¤¾äº¤ç½‘ç»œï¼šPleroma&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>&lt;a class="link" href="https://bigshans.github.io/post/troubleshoot-pleroma/" target="_blank" rel="noopener"
>https://bigshans.github.io/post/troubleshoot-pleroma/&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>&lt;a class="link" href="https://wiki.iroiro.party/doku.php?id=start&amp;amp;do=index" target="_blank" rel="noopener"
>https://wiki.iroiro.party/doku.php?id=start&amp;do=index&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>Psql å æ»¡ç£ç›˜æ€ä¹ˆåŠï¼š&lt;/p>
&lt;p>&lt;a class="link" href="https://dba.stackexchange.com/questions/17057/i-need-to-run-vacuum-full-with-no-available-disk-space" target="_blank" rel="noopener"
>https://dba.stackexchange.com/questions/17057/i-need-to-run-vacuum-full-with-no-available-disk-space&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p></description></item><item><title>Pleroma | å¼€å¯é‚®ä»¶æœåŠ¡ï¼ˆZOHOï¼‰</title><link>https://falasool.github.io/2022/zoho-mail-services/</link><pubDate>Fri, 21 Oct 2022 23:29:38 +0800</pubDate><guid>https://falasool.github.io/2022/zoho-mail-services/</guid><description>&lt;!-- raw HTML omitted -->
&lt;p>åœ¨ zoho.com æ³¨å†Œè´¦å·ï¼Œé€‰æ‹© Free Planï¼ŒAdd an existing domainï¼Œæ¥ç€å»éªŒè¯åŸŸå&lt;/p>
&lt;p>åœ¨åŸŸåæ‰˜ç®¡å•†ï¼ˆæ¯”å¦‚ Cloudflareï¼‰æ·»åŠ ä¸€æ¡ TXT è®°å½•ç„¶åéªŒè¯&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/Falasool/blog-pic-bed@main//blog202306020051407.png"
loading="lazy"
alt="image-20230602005133357"
>&lt;/p>
&lt;p>æ¥ç€å¡«å†™ä»»æ„åŸŸåå‰ç¼€ï¼Œæ¯”å¦‚ adminï¼Œå®Œæˆåˆ›å»ºã€‚è·³è¿‡è®¾ç½® Groupsï¼Œæ¥åˆ° DNS Mappingï¼ŒåŒæ ·å¡«å†™&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/Falasool/blog-pic-bed@main//blog202306020104815.png"
loading="lazy"
alt="image-20230602010444789"
>&lt;/p>
&lt;p>æ³¨æ„ DKIM&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/Falasool/blog-pic-bed@main//blogzmail_domain.webp"
loading="lazy"
alt="image"
>&lt;/p>
&lt;p>éªŒè¯åå®Œæˆï¼Œåˆ° mail.zoho.com æµ‹è¯•æ”¶å‘é‚®ä»¶åŠŸèƒ½&lt;/p></description></item></channel></rss>
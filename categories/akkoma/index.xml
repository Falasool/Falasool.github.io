<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Akkoma on Rubber Duck's Bizarre Adventure</title><link>https://falasool.github.io/categories/akkoma/</link><description>Recent content in Akkoma on Rubber Duck's Bizarre Adventure</description><generator>Hugo -- gohugo.io</generator><lastBuildDate>Sat, 15 Jul 2023 22:59:59 +0800</lastBuildDate><atom:link href="https://falasool.github.io/categories/akkoma/index.xml" rel="self" type="application/rss+xml"/><item><title>Migrate to Akkoma</title><link>https://falasool.github.io/2023/migrate-to-akkoma/</link><pubDate>Sat, 15 Jul 2023 22:59:59 +0800</pubDate><guid>https://falasool.github.io/2023/migrate-to-akkoma/</guid><description>&lt;img src="https://picsum.photos/800/600.webp?random=040d4a09" alt="Featured image of post Migrate to Akkoma" />&lt;p>Update system&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">apt update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apt full-upgrade
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å®‰è£…ä¾èµ–&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">apt install git build-essential postgresql postgresql-contrib cmake libmagic-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apt install elixir erlang-dev erlang-nox
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apt install imagemagick ffmpeg libimage-exiftool-perl
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ðŸ•™ï¼šelixir è¦æ±‚1.14ç‰ˆæœ¬ï¼ŒæŸ¥çœ‹ç‰ˆæœ¬ï¼Œä¸å¯¹çš„è¯å‡çº§&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">elixir --version
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch v0.8.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;. &lt;/span>&lt;span class="nv">$HOME&lt;/span>&lt;span class="s2">/.asdf/asdf.sh&amp;#34;&lt;/span> &amp;gt;&amp;gt; ~/.bashrc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;. &lt;/span>&lt;span class="nv">$HOME&lt;/span>&lt;span class="s2">/.asdf/completions/asdf.bash&amp;#34;&lt;/span> &amp;gt;&amp;gt; ~/.bashrc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">source&lt;/span> ~/.bashrc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">asdf plugin-add elixir
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">asdf global elixir 1.14.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">elixir --version
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åˆ›å»ºä¸€ä¸ªç³»ç»Ÿç”¨æˆ·&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">useradd -r -s /bin/false -m -d /var/lib/akkoma -U akkoma
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>-r&lt;/code>ï¼šåˆ›å»ºä¸€ä¸ªç³»ç»Ÿç”¨æˆ·ï¼Œé€šå¸¸ç”¨äºŽè¿è¡Œç³»ç»ŸæœåŠ¡è€Œä¸æ˜¯ç™»å½•&lt;/li>
&lt;li>&lt;code>-s /bin/false&lt;/code>ï¼šå°†ç”¨æˆ·çš„ç™»å½• Shell è®¾ç½®ä¸º &lt;code>/bin/false&lt;/code>ï¼Œè¿™æ„å‘³ç€è¯¥ç”¨æˆ·æ— æ³•ç™»å½•ç³»ç»Ÿ&lt;/li>
&lt;li>&lt;code>-m&lt;/code>ï¼šåœ¨ç”¨æˆ·çš„ä¸»ç›®å½•ä¸­åˆ›å»ºæ–‡ä»¶å¤¹ï¼ˆå¦‚æžœä¸å­˜åœ¨ï¼‰&lt;/li>
&lt;li>&lt;code>-d /var/lib/akkoma&lt;/code>ï¼šæŒ‡å®šç”¨æˆ·çš„ä¸»ç›®å½•ä¸º &lt;code>/var/lib/akkoma&lt;/code>&lt;/li>
&lt;li>&lt;code>-U&lt;/code>ï¼šåŒæ—¶åˆ›å»ºä¸€ä¸ªä¸Žç”¨æˆ·åç›¸åŒçš„ç”¨æˆ·ç»„&lt;/li>
&lt;/ul>
&lt;p>ðŸ“’Note:&lt;/p>
&lt;p>ä»¥ Akkoma ç³»ç»Ÿç”¨æˆ·èº«ä»½æ‰§è¡Œå•ä¸ªå‘½ä»¤: &lt;code>sudo -Hu akkoma command&lt;/code> æˆ– &lt;code>sudo -Hu akkoma $SHELL&lt;/code> åˆ‡æ¢åˆ°è¯¥ç”¨æˆ·çš„ Shell&lt;/p>
&lt;p>å¦‚æžœæ²¡æœ‰å®‰è£… &lt;code>sudo&lt;/code>ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code>su&lt;/code> å‘½ä»¤ä½œä¸º root ç”¨æˆ·ï¼ˆUID 0ï¼‰æ‰§è¡Œå•ä¸ªå‘½ä»¤ï¼Œä¾‹å¦‚ &lt;code>su -l akkoma -s $SHELL -c 'command'&lt;/code>ï¼Œæˆ–ä½¿ç”¨ &lt;code>su -l akkoma -s $SHELL&lt;/code> å¯åŠ¨ä¸€ä¸ª Shell&lt;/p>
&lt;p>å®‰è£… Akkoma æœ¬ä½“&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p /opt/akkoma
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chown -R akkoma:akkoma /opt/akkoma
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo -Hu akkoma git clone https://akkoma.dev/AkkomaGang/akkoma.git -b stable /opt/akkoma
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç»§ç»­å®‰è£…ï¼Œè¯¢é—®æ˜¯å¦è¦å®‰è£…Hexçš„æ—¶å€™é€‰yes&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo -Hu akkoma mix deps.get
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åˆ›å»ºé…ç½®ï¼Œè¯¢é—®æ˜¯å¦å®‰è£…rebar3é€‰yes&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo -Hu akkoma &lt;span class="nv">MIX_ENV&lt;/span>&lt;span class="o">=&lt;/span>prod mix pleroma.instance gen
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç¼–è¯‘éœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œç­‰å¾…&lt;/p></description></item></channel></rss>
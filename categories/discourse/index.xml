<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Discourse on Falasool</title><link>https://falasool.github.io/categories/discourse/</link><description>Recent content in Discourse on Falasool</description><generator>Hugo -- gohugo.io</generator><lastBuildDate>Sat, 22 Jul 2023 21:28:27 +0800</lastBuildDate><atom:link href="https://falasool.github.io/categories/discourse/index.xml" rel="self" type="application/rss+xml"/><item><title>åœ¨ Ubuntu22.04 ä¸Šæ­å»º Discourse è®ºå›</title><link>https://falasool.github.io/2023/build-discourse-site-on-ubuntu22/</link><pubDate>Sat, 22 Jul 2023 21:28:27 +0800</pubDate><guid>https://falasool.github.io/2023/build-discourse-site-on-ubuntu22/</guid><description>&lt;p>ä¹°æœåŠ¡å™¨ï¼Œç³»ç»Ÿä¸º Ubuntu 22.04 - x86_64&lt;/p>
&lt;p>ä¹°åŸŸåï¼Œæ‰˜ç®¡åˆ° CloudFlareï¼ˆå¼€DNS onlyï¼‰ï¼ŒæŒ‡å‘æœåŠ¡å™¨IP&lt;/p>
&lt;p>æ’æ’­ï¼šFlarumè®ºå›ä¹Ÿå¥½çœ‹ï¼Œè¿˜è½»é‡&lt;/p>
&lt;h2 id="chore">Chore&lt;/h2>
&lt;p>SSHç»ˆç«¯é¢œè‰²&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è¿›å…¥ /etc/profile æ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vim /etc/profile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¢åŠ è¿™ä¸€è¡Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">PS1&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;[\[\e[32m\]\u\[\e[0m\]\[\e[35m\]@\[\e[0m\]\[\e[33m\]\h\[\e[0m\]\[\e[36m\] \W\[\e[0m\]]\$ &amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ›´æ–°æ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">source&lt;/span> /etc/profile
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å®‰è£…å¸¸ç”¨å·¥å…·&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">apt-get install curl wget screen tree git htop bash-completion fail2ban ufw -y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¼€æ”¾ç«¯å£&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ufw allow OpenSSH
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw &lt;span class="nb">enable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw allow http
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw allow https
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw allow 80/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw allow 443/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ufw status
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ£€æŸ¥ 80 ç«¯å£æœ‰æ— è¢«å ç”¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">netstat -tuln &lt;span class="p">|&lt;/span> grep 80# è¿”å›ä¸ºç©ºè¯´æ˜æ²¡æœ‰
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">service nginx stop &lt;span class="c1"># nginxå äº†ï¼Œåœæ­¢nginx&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>SMTP é…ç½®&lt;/p>
&lt;p>åˆšå¼€å§‹ç”¨çš„ Mailjetï¼Œä»€ä¹ˆéƒ½é…ç½®å¥½äº†ï¼ŒæœåŠ¡å·²ç»è·‘èµ·æ¥äº†ï¼Œå‘ä¸äº†é‚®ä»¶å¯¼è‡´è¿ç®¡ç†å‘˜ä¹Ÿæ³¨å†Œä¸äº† ğŸ˜… åŸæ¥æ˜¯è¦å‘å·¥å•äººå·¥å®¡æ ¸ï¼Œè¿˜è¢«æ‹’äº†ã€‚è½¬Mailgun&lt;/p>
&lt;p>[æµ‹è¯•SMTPé…ç½®]&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">./launcher enter app
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">x86_64 arch detected.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rake emails:test&lt;span class="o">[&lt;/span>your-email@gmail.com&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="æœ¬ä½“">æœ¬ä½“&lt;/h2>
&lt;p>Docker&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">curl -fsSL https://get.docker.com -o get-docker.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sh get-docker.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Discourse&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">git clone https://github.com/discourse/discourse_docker.git /var/discourse
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /var/discourse
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod &lt;span class="m">700&lt;/span> containers
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¯åŠ¨å®¹å™¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">./discourse-setup
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>#æŠ¥é”™ï¼šè¾“å…¥ &lt;code>Hostname for your Discourse? [discourse.example.com]:&lt;/code> åï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Checking your domain name . . .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WARNING: Port &lt;span class="m">443&lt;/span> of computer does not appear to be accessible using hostname: xxx.com.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WARNING: Connection to http://xxx.com &lt;span class="o">(&lt;/span>port 80&lt;span class="o">)&lt;/span> also fails.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">This suggests that xxx.com resolves to some IP address that does not reach this
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">machine where you are installing discourse.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The first thing to &lt;span class="k">do&lt;/span> is confirm that xxx.com resolves to the IP address of this server.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">You usually &lt;span class="k">do&lt;/span> this at the same place you purchased the domain.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">If you are sure that the IP address resolves correctly, it could be a firewall issue.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">A web search &lt;span class="k">for&lt;/span> &lt;span class="s2">&amp;#34;open ports YOUR CLOUD SERVICE&amp;#34;&lt;/span> might help.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">This tool is designed only &lt;span class="k">for&lt;/span> the most standard installations. If you cannot resolve
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">the issue above, you will need to edit containers/app.yml yourself and &lt;span class="k">then&lt;/span> &lt;span class="nb">type&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">./launcher rebuild app
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è§£å†³ï¼šcloudflareé‡Œå¼€å¯ DNS only&lt;/p>
&lt;p>æˆåŠŸå¯åŠ¨å®¹å™¨åè®¿é—®åŸŸåï¼Œæ³¨å†Œç®¡ç†å‘˜è´¦æˆ· ğŸ‰&lt;/p>
&lt;h2 id="å‚è€ƒ--è‡´è°¢">å‚è€ƒ &amp;amp; è‡´è°¢&lt;/h2>
&lt;p>&lt;a class="link" href="https://www.orgleaf.com/3098.html" target="_blank" rel="noopener"
>è®©Discourseå’Œå…¶å®ƒç½‘ç«™è·‘åœ¨åŒä¸€å°ä¸»æœºä¸Š&lt;/a>
&lt;span style="white-space: nowrap;">&lt;svg width=".7em" height=".7em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/p>
&lt;p>å®‰è£…ä¾èµ–ï¼šphp_serializeã€miroã€mysql2&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">apt-get install build-essential ruby-dev libmysqlclient-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apt-get install rubygems
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gem install php_serialize
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gem install miro
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gem install mysql2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item></channel></rss>